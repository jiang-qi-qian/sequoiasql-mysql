# Testcase: 
# seqDB-29600# seqDB-29601# seqDB-29602# seqDB-29603# seqDB-29604# seqDB-29605# seqDB-29606# seqDB-29607# seqDB-29608# seqDB-29609
# seqDB-29610# seqDB-29611# seqDB-29612# seqDB-29613# seqDB-29614# seqDB-29615# seqDB-29616 # seqDB-29617# seqDB-29618# seqDB-29619
# seqDB-29620# seqDB-29621# seqDB-29622# seqDB-29623# seqDB-29624# seqDB-29625# seqDB-29626# seqDB-29627# seqDB-29628# seqDB-29629
# seqDB-29630# seqDB-29631# seqDB-29629# seqDB-29630# seqDB-29631# seqDB-29632# seqDB-29634# seqDB-29635

--source include/have_sequoiadb.inc
--source include/have_partition.inc

--disable_warnings
drop database if exists count_limit_sort_pushdown_sequoiadb_2;
--enable_warnings
create database count_limit_sort_pushdown_sequoiadb_2;
drop database count_limit_sort_pushdown_sequoiadb_2;
create database count_limit_sort_pushdown_sequoiadb_2;
use count_limit_sort_pushdown_sequoiadb_2;

create table t1(
  col1 int,
  col2 varchar(10),
  col3 datetime,
  col4 varchar(10),
  key idx_col1(col1),
  key idx_col2(col2),
  key idx_col12(col1,col2),
  key idx_col3(col3)
);

insert into t1 values(0,'abc','20221115114010','abc');
insert into t1 values(null,'abc','20221115114010','abc');
insert into t1 values(5,'abcdef','20221115114015','abcdef');
insert into t1 values(3,null,'20221115114015','abcdef');
insert into t1 values(7,'def','20221115114020','def');
insert into t1 values(2,'def',null,'def');
insert into t1 values(4,'abcde','20221115114020','efg');
insert into t1 values(0,'abcde','20221115114020',null);
insert into t1 values(6,'def','20221115114210','def');
insert into t1 values(1,'defg ','20221115114510','defg');
insert into t1 values(3,'xyz','20221115114510','xyz ');
insert into t1 values(2,'xyzz ','20221115114510','xyzz ');
insert into t1 values(null,null,null,null);
insert into t1 values(null,null,null,null);

create table t2 like t1;
insert into t2 select * from t1;

create table t3(
col1 int primary key,
col2 varchar(10),
col3 varchar(10)
);

insert into t3 values(3,'user01 ','abc');
insert into t3 values(1,'user02','def ');
insert into t3 values(2,'user03 ','ghi ');
insert into t3 values(6,null,'def ');
insert into t3 values(4,'user02',null);

create table t4 select * from t3;
create table t5 select * from t1;

create table t1_partition(
  col1 int,
  col2 varchar(10),
  col3 datetime,
  col4 varchar(10),
  col5 int,
  key idx_col1(col1),
  key idx_col2(col2),
  key idx_col12(col1,col2),
  key idx_col3(col3)
)
partition by range columns (col5)
subpartition by key (col1)
subpartitions 2 (
    partition p0 values less than (4),
    partition p1 values less than (7),
    partition p2 values less than (11)
);


insert into t1_partition values(0,'abc','20221115114010','abc',3);
insert into t1_partition values(null,'abc','20221115114010','abc',2);
insert into t1_partition values(5,'abcdef','20221115114015','abcdef',5);
insert into t1_partition values(3,null,'20221115114015','abcdef',3);
insert into t1_partition values(7,'def','20221115114020','def',4);
insert into t1_partition values(2,'def',null,'def',1);
insert into t1_partition values(4,'abcde','20221115114020','efg',5);
insert into t1_partition values(1,'abcde','20221115114020',null,3);
insert into t1_partition values(6,'def','20221115114210','def',1);
insert into t1_partition values(1,'defg ','20221115114510','defg',5);
insert into t1_partition values(3,'xyz','20221115114510','xyz ',4);
insert into t1_partition values(2,'xyz ','20221115114510','xyz ',1);
insert into t1_partition values(8,'xyz ','20221115114510','xyz ',3);
insert into t1_partition values(11,'abcde','20221115114020','efg',2);
insert into t1_partition values(9,'def','20221115114020','def',2);
insert into t1_partition values(10,'abcdef','20221115114015','abcdef',4);
insert into t1_partition values(null,null,null,null,null);
insert into t1_partition values(null,null,null,null,null);

create table t2_partition like t1_partition;
insert into t2_partition select * from t1_partition;
create table t3_partition select * from t1_partition;

create view v1 as select * from t1 where col1 > 2 limit 1,10;
create view v2 as select * from t1 where col1 > 2 order by col2 limit 5;
create view v3 as select * from t1 where col1 > 2 group by col3 limit 4;
create view v4 as select *,count(*) from t1 where col1 > 2 group by col4 order by col4 limit 6;
create view v5 as select * from t1 where col1 > 2 group by col4 order by col4 limit 6;
create view v6 as select *,count(*) from t1 where col1 > 2 order by col1 limit 6;

create view v7 as  (select count(*) from t1, t2 where t1.col1>=2 and t2.col1 <=6  ) UNION (select count(*) from t1 where col4<"zzz") limit 8;
create view v8 as  (select t1.* from t1, t2 where t1.col1>=2 and t2.col1 <=6  group by t1.col1 order by t1.col1 limit 10 ) UNION (select * from t1 where col4<"zzz"  group by col2 order by col3 limit 3 ) limit 8;

create table insert_table1(
  col1 int
);
create table insert_table2(
  col1 int,
  col2 varchar(10),
  col3 datetime,
  col4 varchar(10),
  col5 int,
  key idx_col1(col1),
  key idx_col2(col2),
  key idx_col12(col1,col2),
  key idx_col3(col3)
);
create table insert_table3(
  col1 int,
  col2 int
);
create table insert_table4(
  col1 int,
  col2 varchar(10),
  col3 datetime,
  col4 varchar(10),
  col5 varchar(10),
  key idx_col1(col1),
  key idx_col2(col2),
  key idx_col12(col1,col2),
  key idx_col3(col3)
);
create table insert_table5(
  col1 int,
  col2 varchar(10)
);
create table insert_table6(
  col1 int,
  col2 varchar(10),
  col3 datetime,
  col4 varchar(10),
  col5 int,
  col6 varchar(10),
  col7 datetime,
  col8 varchar(10),
  col9 int,
  col10 varchar(10),
  col11 datetime,
  col12 varchar(10),
  key idx_col1(col1),
  key idx_col2(col2),
  key idx_col12(col1,col2),
  key idx_col3(col3)
);

create table insert_table7(
  col4 varchar(10)
);

analyze table  t1,t2,t3,t4,t5,insert_table1,insert_table2,insert_table3,insert_table4,insert_table5,insert_table6,insert_table7,t1_partition,t2_partition,t3_partition;
set session sequoiadb_debug_log=on;
set session sql_mode='';

set session sequoiadb_optimizer_options='direct_count,direct_sort,direct_limit';
set session sequoiadb_cls_pushdown_expand=on;
set session optimizer_switch='optimizer_sort_pushdown=on';
set session optimizer_index_sort_prune=on;


# seqDB-29600
--replace_column 10 #  11 #
explain insert into insert_table1 select count(1) from t1 where col1>=1;
let $query = insert into insert_table1 select count(1) from t1 where col1>=1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into t5 select * from t1 where col1>=1 limit 2,3;
let $query = insert into t5 select * from t1 where col1>=1 limit 2,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from t1 where col1>1 group by col1 desc;
let $query = insert into t5 select * from t1 where col1>1 group by col1 desc;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from t1 where col3>="20221115114210" order by col4 limit 2,3;
let $query = insert into t5 select * from t1 where col3>="20221115114210" order by col4 limit 2,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from t1 where col3>="20221115114210" group by col3 limit 2;
let $query = insert into t5 select * from t1 where col3>="20221115114210" group by col3 limit 2;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from t1 where col4>"bcd" group by col3 order by col3;
let $query = insert into t5 select * from t1 where col4>"bcd" group by col3 order by col3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from t1 where col2>="def" group by col1 order by col4 limit 2,3;
let $query = insert into t5 select * from t1 where col2>="def" group by col2 order by col4 limit 2,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

# partition table
--replace_column 10 #  11 #
explain  insert into t3_partition(col2,col4) select col2,col4 from t1_partition where col2>="def" group by col2 order by col4 limit 2,3;
--sorted_result
let $query = insert into t3_partition(col2,col4) select col2,col4 from t1_partition where col2>="def" group by col2 order by col4 limit 2,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t3_partition;
truncate table t3_partition;

# seqDB-29601
--replace_column 10 #  11 #
explain insert into t5 select * from t1 where col2>"def" order by col4 desc;
let $query = insert into t5 select * from t1 where col2>"def" order by col4 desc;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(1) from t1 where col1>1 group by col1 desc;
let $query = insert into insert_table1 select count(1) from t1 where col1>1 group by col1 desc;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(1) from t1 where col3>="20221115114210" group by col3 limit 1,1;
let $query = insert into insert_table1 select count(1) from t1 where col3>="20221115114210" group by col3 limit 1,1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(1) from t1 where col4>"bcd" group by col3 order by col3;
let $query = insert into insert_table1 select count(1) from t1 where col4>"bcd" group by col3 order by col3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(col1) from t1 where col2>="def" group by col1 order by col1 limit 1;
let $query = insert into insert_table1 select count(col1) from t1 where col2>="def" group by col1 order by col1 limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;


# seqDB-29602
--replace_column 10 #  11 #
explain insert into insert_table1 select count(1) from t1 where col2>="def" limit 1;
let $query = insert into insert_table1 select count(1) from t1 where col2>="def" limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(1) from t1 where col2>="bcd" order by col4 desc;
let $query = insert into insert_table1 select count(1) from t1 where col2>="bcd" order by col4 desc;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(1) from t1 where col3>="20221115114210" order by col4 limit 1;
let $query = insert into insert_table1 select count(1) from t1 where col3>="20221115114210" order by col4 limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;


# seqDB-29603
--replace_column 10 #  11 #
explain insert into insert_table1(select count(1) from t1 where col1>1) union ALL (select count(1) from t2 where col4<"zzz") limit 1,1;
let $query = insert into insert_table1(select count(1) from t1 where col1>1) union ALL (select count(1) from t2 where col4<"zzz") limit 1,1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1>=1 limit 2,4) union ALL (select *  from t2 where col2>"def" limit 2,3) limit 1,3;
let $query = insert into t5(select * from t1 where col1>=1 limit 2,4) union ALL (select *  from t2 where col2>"def" limit 2,3) limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1>=1 group by col1 desc) union ALL (select * from t2 where col2>"def" group by col2 desc) limit 1,3;
let $query = insert into t5(select * from t1 where col1>=1 group by col1 desc) union ALL (select * from t2 where col2>"def" group by col2 desc) limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table7(select col4 from t1 where col1>1 order by col4 desc) union ALL (select col4 from t2 where col3>="20221115114210" order by col4 limit 1) order by col4 limit 1,3;
let $query = insert into insert_table7(select col4 from t1 where col1>1 order by col4 desc) union ALL (select col4 from t2 where col3>="20221115114210" order by col4 limit 1) order by col4 limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table7;
truncate table insert_table7;

--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1>1 group by col1 limit 2,4 ) union ALL (select * from t2 where col3>="20221115114210" group by col4 limit 2,3) order by col1  limit 1,3;
let $query = insert into t5(select * from t1 where col1>1 group by col1 limit 2,4 ) union ALL (select * from t2 where col3>="20221115114210" group by col4 limit 2,3) order by col1  limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col4>"bcd" group by col3 order by col3) union ALL (select * from t2 where col3>="20221115114210" group by col3 order by col3) order by col1  limit 1,3;
let $query = insert into t5(select * from t1 where col4>"bcd" group by col3 order by col3) union ALL (select * from t2 where col3>="20221115114210" group by col3 order by col3) order by col1  limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col4>"bcd" group by col3 order by col3  limit 0,3) union ALL (select * from t2 where col3>="20221115114210" group by col3 order by col3  limit 0,2) order by col1  limit 1,3;
let $query = insert into t5(select * from t1 where col4>"bcd" group by col3 order by col3  limit 0,3) union ALL (select * from t2 where col3>="20221115114210" group by col3 order by col3  limit 0,2) order by col1  limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1>=1 limit 2,3) union ALL (select * from t2 where col2>"def" order by col4 desc) limit 1,3;
let $query = insert into t5(select * from t1 where col1>=1 limit 2,3) union ALL (select * from t2 where col2>"def" order by col4 desc) limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table7(select col2 from t1 where col1>1 group by col2 desc) union ALL (select col2 from t2 where col3>="20221115114210" order by col2 limit 1) order by col2 limit 1;
let $query = insert into insert_table7(select col2 from t1 where col1>1 group by col2 desc) union ALL (select col2 from t2 where col3>="20221115114210" order by col2 limit 1) order by col2 limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table1(select col1 from t1 where col1>1 group by col1 desc  limit 1) union ALL (select col1 from t2 where col3>="20221115114210" order by col1 limit 1) order by col1 limit 1;
let $query = insert into insert_table1(select col1 from t1 where col1>1 group by col1 desc  limit 1) union ALL (select col1 from t2 where col3>="20221115114210" order by col1 limit 1) order by col1 limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col4>="def" order by col4 limit 2,3) union ALL(select * from t2 where col1>=1 group by col2 order by col2 limit 2,1) order by col3 limit 2,3;
let $query = insert into t5(select * from t1 where col4>="def" order by col4 limit 2,3) union (select * from t2 where col1>=1 group by col2 order by col2 limit 2,1) order by col3 limit 2,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table7 (select col2 from t1 where col1>=1 limit 1)  UNION ALL (select col2 from t1 where col2>="def" order by col4 desc limit 1) UNION ALL (select col2 from t2 where col1>=1 group by col2 order by col2 desc limit 1) order by col2 desc limit 1;
--sorted_result
let $query = insert into insert_table7(select col2 from t1 where col1>=1 limit 1)  UNION ALL (select col2 from t1 where col2>="def" order by col4 desc limit 1) UNION ALL (select col2 from t2 where col1>=1 group by col2 order by col2 desc limit 1) order by col2 desc limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table7;
truncate table insert_table7;

--replace_column 10 #  11 #
explain insert into t5 (select * from t1 where col1>=1 limit 1) UNION ALL (select * from t2 where col2>"defg" order by col2 desc) UNION ALL (select * from t1 where col2>"defg" order by col2 desc limit 1) UNION ALL (select * from t2 where col1>=1 group by col2 order by col2 desc limit 2,1) order by col2 desc limit 1;
--sorted_result
let $query = insert into t5 (select * from t1 where col1>=1 limit 1) UNION ALL (select * from t2 where col2>"defg" order by col2 desc) UNION ALL (select * from t1 where col2>"defg" order by col2 desc limit 1) UNION ALL (select * from t2 where col1>=1 group by col2 order by col2 desc limit 2,1) order by col2 desc limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;


# partition table 
--replace_column 10 #  11 #
explain insert into insert_table7(select col4 from t1_partition where col1>=1 limit 1) UNION ALL (select col4 from t2_partition where col4>"defg" order by col4 desc) UNION ALL (select col4 from t1_partition where col4>"defg" order by col4 desc limit 1) UNION ALL (select col4 from t2_partition where col1>=1 group by col4 order by col4 desc limit 1) order by col4 desc limit 1;
--sorted_result
let $query = insert into insert_table7(select col4 from t1_partition where col1>=1 limit 1) UNION ALL (select col4 from t2_partition where col4>"defg" order by col4 desc) UNION ALL (select col4 from t1_partition where col4>"defg" order by col4 desc limit 1) UNION ALL (select col4 from t2_partition where col1>=1 group by col4 order by col4 desc limit 1) order by col4 desc limit 1;
 --source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table7;
truncate table insert_table7;

# seqDB-29604
--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1>=1 order by col1 desc) union ALL (select * from t2 where col2>"def" order by col4 desc) limit 1,3;
let $query = insert into t5(select * from t1 where col1>=1 order by col1 desc) union ALL (select * from t2 where col2>"def" order by col4 desc) limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table1(select count(*) from t1 where col1>=1 group by col1 desc) union ALL (select count(*) from t2 where col2>"def" group by col2 desc) limit 1,3;
let $query = insert into insert_table1(select count(*) from t1 where col1>=1 group by col1 desc) union ALL (select count(*) from t2 where col2>"def" group by col2 desc) limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1(select count(*) from t1 where col1>1 group by col1 limit 2,4 ) union ALL (select count(*) from t2 where col3>="20221115114210" group by col4 limit 2,3)   limit 1,3;
let $query = insert into insert_table1(select count(*) from t1 where col1>1 group by col1 limit 2,4 ) union ALL (select count(*) from t2 where col3>="20221115114210" group by col4 limit 2,3)  limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1(select count(*) from t1 where col4>"bcd" group by col3 order by col3) union ALL (select count(*) from t2 where col3>="20221115114210" group by col3 order by col3)  limit 1,3;
let $query = insert into insert_table1(select count(*) from t1 where col4>"bcd" group by col3 order by col3) union ALL (select count(*) from t2 where col3>="20221115114210" group by col3 order by col3)  limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1(select count(*) from t1 where col4>"bcd" group by col3 order by col3  limit 0,3) union ALL (select count(*) from t2 where col3>="20221115114210" group by col3 order by col3  limit 0,2)  limit 1,3;
let $query = insert into insert_table1(select count(*) from t1 where col4>"bcd" group by col3 order by col3  limit 0,3) union ALL (select count(*) from t2 where col3>="20221115114210" group by col3 order by col3  limit 0,2)  limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

# seqDB-29605
--replace_column 10 #  11 #
explain  insert into insert_table1(select count(*) from t1 where col1>=1 limit 0,4) union ALL (select count(*)  from t2 where col2>"def" limit 0,3) limit 1,3;
--sorted_result
let $query = insert into insert_table1(select count(*) from t1 where col1>=1 limit 0,4) union ALL (select count(*)  from t2 where col2>"def" limit 0,3) limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1(select count(1) from t1 where col1>=1 order by col1 desc) union ALL (select count(1) from t2 where col2>"def" order by col4 desc) limit 1,3;
--sorted_result
let $query = insert into insert_table1(select count(1) from t1 where col1>=1 order by col1 desc) union ALL (select count(1) from t2 where col2>"def" order by col4 desc) limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1(select count(col4) from t1 where col1>1 order by col4 desc) union ALL (select count(col4) from t2 where col3>="20221115114210" order by col4 limit 1)  limit 1,3;
--sorted_result
let $query = insert into insert_table1(select count(col4) from t1 where col1>1 order by col4 desc) union ALL (select count(col4) from t2 where col3>="20221115114210" order by col4 limit 1)  limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

# seqDB-29606
--replace_column 10 #  11 #
explain insert into insert_table1(select count(1) from t1 where col1>1) UNION (select count(1) from t2 where col4<"zzz") limit 1,1;
let $query = insert into insert_table1(select count(1) from t1 where col1>1) UNION (select count(1) from t2 where col4<"zzz") limit 1,1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1>=1 limit 2,4) UNION (select *  from t2 where col2>"def" limit 2,3) limit 1,3;
let $query = insert into t5(select * from t1 where col1>=1 limit 2,4) UNION (select *  from t2 where col2>"def" limit 2,3) limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1>=1 group by col1 desc) UNION (select * from t2 where col2>"def" group by col2 desc) limit 1,3;
let $query = insert into t5(select * from t1 where col1>=1 group by col1 desc) UNION (select * from t2 where col2>"def" group by col2 desc) limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table1(select col1 from t1 where col1>1 order by col1 desc) UNION (select col1 from t2 where col3>="20221115114210" order by col4 limit 1) order by col1 limit 1;
let $query = insert into insert_table1(select col1 from t1 where col1>1 order by col1 desc) UNION (select col1 from t2 where col3>="20221115114210" order by col4 limit 1) order by col1 limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1>1 group by col1 limit 2,4 ) UNION (select * from t2 where col3>="20221115114210" group by col4 limit 2,3) order by col1  limit 1,3;
let $query = insert into t5(select * from t1 where col1>1 group by col1 limit 2,4 ) UNION (select * from t2 where col3>="20221115114210" group by col4 limit 2,3) order by col1  limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col4>"bcd" group by col3 order by col3) UNION (select * from t2 where col3>="20221115114210" group by col3 order by col3) order by col1  limit 1,3;
let $query = insert into t5(select * from t1 where col4>"bcd" group by col3 order by col3) UNION (select * from t2 where col3>="20221115114210" group by col3 order by col3) order by col1  limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col4>"bcd" group by col3 order by col3  limit 0,3) UNION (select * from t2 where col3>="20221115114210" group by col3 order by col3  limit 0,2) order by col1  limit 1,3;
let $query = insert into t5(select * from t1 where col4>"bcd" group by col3 order by col3  limit 0,3) UNION (select * from t2 where col3>="20221115114210" group by col3 order by col3  limit 0,2) order by col1  limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1>=1 limit 2,3) UNION (select * from t2 where col2>"def" order by col4 desc) limit 1,3;
let $query = insert into t5(select * from t1 where col1>=1 limit 2,3) UNION (select * from t2 where col2>"def" order by col4 desc) limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table7(select col4 from t1 where col1>1 group by col4 desc) UNION (select col4 from t2 where col3>="20221115114210" order by col4 limit 1) order by col4 limit 1;
let $query = insert into insert_table7(select col4 from t1 where col1>1 group by col4 desc) UNION (select col4 from t2 where col3>="20221115114210" order by col4 limit 1) order by col4 limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table7;
truncate table insert_table7;

--replace_column 10 #  11 #
explain insert into insert_table1(select col1 from t1 where col1>1 group by col1 desc  limit 1) UNION (select col1 from t2 where col3>="20221115114210" order by col1 limit 1) order by col1 limit 1;
let $query = insert into insert_table1(select col1 from t1 where col1>1 group by col1 desc  limit 1) UNION (select col1 from t2 where col3>="20221115114210" order by col1 limit 1) order by col1 limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col4>="def" order by col4 limit 2,3) UNION (select * from t2 where col1>=1 group by col2 order by col2 limit 2,1) order by col3 limit 2,3;
let $query = insert into t5(select * from t1 where col4>="def" order by col4 limit 2,3) UNION (select * from t2 where col1>=1 group by col2 order by col2 limit 2,1) order by col3 limit 2,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 (select * from t1 where col1>=1 limit 2,3)  UNION (select * from t1 where col2>="def" order by col4  limit 2,3) UNION (select * from t2 where col1>=1 group by col2 order by col2  limit 2,1) order by col3  limit 2;
--sorted_result
let $query = insert into t5(select * from t1 where col1>=1 limit 2,3)  UNION (select * from t1 where col2>="def" order by col4  limit 2,3) UNION (select * from t2 where col1>=1 group by col2 order by col2  limit 2,1) order by col3  limit 2;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 (select * from t1 where col1>=1 limit 2,3) UNION (select * from t2 where col2>"def" order by col4 ) UNION (select * from t1 where col2>="def" order by col4  limit 2,3) UNION (select * from t2 where col1>=1 group by col2 order by col2  limit 2,1) order by col3  limit 2;
--sorted_result
let $query = insert into t5(select * from t1 where col1>=1 limit 2,3) UNION (select * from t2 where col2>"def" order by col4 ) UNION (select * from t1 where col2>="def" order by col4  limit 2,3) UNION (select * from t2 where col1>=1 group by col2 order by col2  limit 2,1) order by col3  limit 2;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

# partition table
--replace_column 10 #  11 #
explain  insert into insert_table7(select col4 from t1_partition where col1>=1 limit 1) UNION (select col4 from t2_partition where col4>"def" order by col4 ) UNION (select col4 from t1_partition where col4>="def" order by col4  limit 1) UNION (select col4 from t2_partition where col1>=1 group by col4 order by col4  limit 1) order by col4  limit 1;
--sorted_result
let $query = insert into insert_table7(select col4 from t1_partition where col1>=1 limit 1) UNION (select col4 from t2_partition where col4>"def" order by col4 ) UNION (select col4 from t1_partition where col4>="def" order by col4  limit 1) UNION (select col4 from t2_partition where col1>=1 group by col4 order by col4  limit 1) order by col4  limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table7;
truncate table insert_table7;

# seqDB-29607
--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1>=1 order by col1 desc) UNION (select * from t2 where col2>"def" order by col4 desc) limit 1,3;
let $query = insert into t5(select * from t1 where col1>=1 order by col1 desc) UNION (select * from t2 where col2>"def" order by col4 desc) limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table1(select count(*) from t1 where col1>=1 group by col1 desc) UNION (select count(*) from t2 where col2>"def" group by col2 desc) limit 1,3;
let $query = insert into insert_table1(select count(*) from t1 where col1>=1 group by col1 desc) UNION (select count(*) from t2 where col2>"def" group by col2 desc) limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1(select count(*) from t1 where col1>1 group by col1 limit 2,4 ) UNION (select count(*) from t2 where col3>="20221115114210" group by col4 limit 2,3)   limit 1,3;
let $query = insert into insert_table1(select count(*) from t1 where col1>1 group by col1 limit 2,4 ) UNION (select count(*) from t2 where col3>="20221115114210" group by col4 limit 2,3)  limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1(select count(*) from t1 where col4>"bcd" group by col3 order by col3) UNION (select count(*) from t2 where col3>="20221115114210" group by col3 order by col3)  limit 1,3;
let $query = insert into insert_table1(select count(*) from t1 where col4>"bcd" group by col3 order by col3) UNION (select count(*) from t2 where col3>="20221115114210" group by col3 order by col3)  limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1(select count(*) from t1 where col4>"bcd" group by col3 order by col3  limit 0,3) UNION (select count(*) from t2 where col3>="20221115114210" group by col3 order by col3  limit 0,2)  limit 1,3;
let $query = insert into insert_table1(select count(*) from t1 where col4>"bcd" group by col3 order by col3  limit 0,3) UNION (select count(*) from t2 where col3>="20221115114210" group by col3 order by col3  limit 0,2)  limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

# seqDB-29608
--replace_column 10 #  11 #
explain  insert into insert_table1(select count(*) from t1 where col1>=1 limit 0,4) UNION (select count(*)  from t2 where col2>"def" limit 0,3) limit 1,3;
--sorted_result
let $query = insert into insert_table1(select count(*) from t1 where col1>=1 limit 0,4) UNION (select count(*)  from t2 where col2>"def" limit 0,3) limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain  insert into insert_table1(select count(1) from t1 where col1>=1 order by col1 desc) UNION (select count(1) from t2 where col2>"def" order by col4 desc) limit 1,3;
--sorted_result
let $query = insert into insert_table1(select count(1) from t1 where col1>=1 order by col1 desc) UNION (select count(1) from t2 where col2>"def" order by col4 desc) limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain  insert into insert_table1(select count(1) from t1 where col1>1 order by col1 desc) UNION (select count(1) from t2 where col3>="20221115114210" order by col4 limit 2,3)  limit 1,3;
--sorted_result
let $query = insert into insert_table1(select count(1) from t1 where col1>1 order by col1 desc) UNION (select count(1) from t2 where col3>="20221115114210" order by col4 limit 2,3)  limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

# seqDB-29609
--replace_column 10 #  11 #
explain insert into insert_table1(select count(1) from t1, t2 where t1.col1>=4 and t2.col1 <=6 ) UNION (select count(1) from t1 where col4<"zzz") limit 0,3;
let $query = insert into insert_table1(select count(1) from t1, t2 where t1.col1>=4 and t2.col1 <=6 ) UNION (select count(1) from t1 where col4<"zzz") limit 0,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1(select count(1) from t1, t2 where t1.col1>=4 and t2.col1 <=6 ) UNION (select count(1) from t1,t2  where t1.col4 >='def' and t2.col4<"zzz") UNION (select count(1) from t1 where col4<"zzz") limit 0,3;
let $query = insert into insert_table1(select count(1) from t1, t2 where t1.col1>=4 and t2.col1 <=6 ) UNION (select count(1) from t1,t2  where t1.col4 >='def' and t2.col4<"zzz") UNION (select count(1) from t1 where col4<"zzz") limit 0,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into t5(select t1.* from t1, t2 where t1.col1>=2 and t2.col1 <=6 group by t1.col3 order by t1.col3  limit 1,4) UNION (select * from t1 where col3>="20221115114210" group by col3 order by col3  limit 0,2) limit 0,3;
let $query = insert into t5(select t1.* from t1, t2 where t1.col1>=2 and t2.col1 <=6 group by t1.col3 order by t1.col3  limit 1,4) UNION (select * from t1 where col3>="20221115114210" group by col3 order by col3  limit 0,2) limit 0,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5(select t1.* from t1, t2 where t1.col1>=2 and t2.col1 <=6 group by t1.col3 order by t1.col3  limit 1,4) UNION (select t2.*  from t1,t2  where t1.col4 >='def' and t2.col4<"zzz" group by col3 order by col3  limit 0,2) UNION (select * from t1 where col3>="20221115114210" group by col3 order by col3  limit 0,2) limit 0,3;
let $query = insert into t5(select t1.* from t1, t2 where t1.col1>=2 and t2.col1 <=6 group by t1.col3 order by t1.col3  limit 1,4) UNION (select t2.*  from t1,t2  where t1.col4 >='def' and t2.col4<"zzz" group by col3 order by col3  limit 0,2) UNION (select * from t1 where col3>="20221115114210" group by col3 order by col3  limit 0,2) limit 0,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

# seqDB-29610
--replace_column 10 #  11 #
explain insert into insert_table3 select count(*),(select count(col1) from t1 where col1>=1) from t2 where col3>"20221115114210";
let $query = insert into insert_table3 select count(*),(select count(col1) from t1 where col1>=1) from t2 where col3>"20221115114210";
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;

--replace_column 10 #  11 #
explain insert into insert_table2 select *,(select col1 from t1 where col1>=1 limit 2,1) from t2 where col3>"20221115114210"  limit 1,3;
let $query = insert into insert_table2 select *,(select col1 from t1 where col1>=1 limit 2,1) from t2 where col3>"20221115114210"  limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;
 

 
--replace_column 10 #  11 #
explain insert into insert_table4 select *,(select col2 from t1 where col3>="20221215114210" group by col4) from t2 where t2.col1 <6 group by col1;
let $query = insert into insert_table4 select *,(select col2 from t1 where col3>="20221215114210" group by col4) from t2 where t2.col1 <6 group by col1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table4;
truncate table insert_table4;
 
--replace_column 10 #  11 #
explain insert into insert_table2 select *,(select col1 from t1 where col2>="bcd" order by col3 limit 2,1) from t2 where col3>"20221115114210" order by col4 limit 1,3;
let $query = insert into insert_table2 select *,(select col1 from t1 where col2>="bcd" order by col3 limit 2,1) from t2 where col3>"20221115114210" order by col4 limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;
 
--replace_column 10 #  11 #
explain insert into insert_table4 select *,(select col2 from t1 where col3<"20221215114210" group by col4 limit 2,1) from t2 where t2.col1 <6 group by col1 limit 3;
let $query = insert into insert_table4 select *,(select col2 from t1 where col3<"20221215114210" group by col4 limit 2,1) from t2 where t2.col1 <6 group by col1 limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table4;
truncate table insert_table4;
 
--replace_column 10 #  11 #
explain insert into insert_table4 select *,(select col2 from t1 where col3>="20221215114210" group by col4 order by col1) from t2 where t2.col1 <6 group by col1 order by col3;
let $query = insert into insert_table4 select *,(select col2 from t1 where col3>="20221215114210" group by col4 order by col1) from t2 where t2.col1 <6 group by col1 order by col3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table4;
truncate table insert_table4;
 
--replace_column 10 #  11 #
explain insert into insert_table4 select *,(select col4 from t1 where col3<"20221215114210" group by col4 order by col4 limit 1) from t2 where t2.col1 <6 group by col1 order by col3 limit 3;
let $query = insert into insert_table4 select *,(select col4 from t1 where col3<"20221215114210" group by col4 order by col4 limit 1) from t2 where t2.col1 <6 group by col1 order by col3 limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table4;
truncate table insert_table4;

--replace_column 10 #  11 #
explain insert into insert_table3 select col1,(select col1 from t1 where col2>="bcd" order by col1 limit 0,1) from t2 where t2.col4 >"def" group by col1 limit 3;
let $query = insert into insert_table3 select col1,(select col1 from t1 where col2>="bcd" order by col1 limit 0,1) from t2 where t2.col4 >"def" group by col1 limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table4;
truncate table insert_table4;
 
--replace_column 10 #  11 #
explain insert into insert_table4 select *,(select col1 from t1 where col3>="20221215114210" order by col1) from t2 where t2.col1 < 6 group by col1 order by col3 limit 3;
let $query = insert into insert_table4 select *,(select col1 from t1 where col3>="20221215114210" order by col1) from t2 where t2.col1 < 6 group by col1 order by col3 limit 3;
 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table4;
truncate table insert_table4;
 
--replace_column 10 #  11 #
explain insert into insert_table4 select *,(select col1 from t1 where col3>="20221215114210" order by col1) from t2 where t2.col1 < 6 order by col3,col1 limit 3;
let $query = insert into insert_table4 select *,(select col1 from t1 where col3>="20221215114210" order by col1) from t2 where t2.col1 < 6 order by col3,col1 limit 3;
 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table4;
truncate table insert_table4;
 
--replace_column 10 #  11 #
explain insert into insert_table5 select count(*),(select col4 from t1 where col3<"20221215114210" group by col4 order by col4 limit 1) from t2 where t2.col1 < 6;
let $query = insert into insert_table5 select count(*),(select col4 from t1 where col3<"20221215114210" group by col4 order by col4 limit 1) from t2 where t2.col1 < 6;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table5;
truncate table insert_table5;
 
--replace_column 10 #  11 #
explain insert into insert_table4 select *,(select col4 from t1 where col3<"20221215114210" group by col4 order by col4 limit 1) from t2 where t2.col1 < 6 limit 3;
let $query = insert into insert_table4 select *,(select col4 from t1 where col3<"20221215114210" group by col4 order by col4 limit 1) from t2 where t2.col1 < 6 limit 3;
 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table4;
truncate table insert_table4;
 
--replace_column 10 #  11 #
explain insert into insert_table4 select *,(select col4 from t1 where col3<"20221215114210" group by col4 order by col4 limit 1) from t2 where t2.col1 < 6 order by col3;
let $query = insert into insert_table4 select *,(select col4 from t1 where col3<"20221215114210" group by col4 order by col4 limit 1) from t2 where t2.col1 < 6 order by col3;
 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table4;
truncate table insert_table4;

# partition table
--replace_column 10 #  11 #
explain  insert into insert_table5 select col1,(select col4 from t1_partition where col3<"20221215114210" group by col4 order by col4 limit 1) from t2_partition where t2_partition.col1 < 6 order by col4;
--sorted_result
let $query = insert into insert_table5 select col1,(select col4 from t1_partition where col3<"20221215114210" group by col4 order by col4 limit 1) from t2_partition where t2_partition.col1 < 6 order by col4;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table5;
truncate table insert_table5;
 

# seqDB-29611
--replace_column 10 #  11 #
explain insert into insert_table2 select *,(select col1 from t1 where col2="bcd" order by col3) from t2 where col3>"20221115114210" order by col4;
let $query = insert into insert_table2 select *,(select col1 from t1 where col2="bcd" order by col3) from t2 where col3>"20221115114210" order by col4;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;

--replace_column 10 #  11 #
explain insert into insert_table3 select count(*),(select count(col2) from t1 where col3>="20221215114210" group by col4) from t2 where t2.col1 <6 group by col1;
let $query = insert into insert_table3 select count(*),(select count(col2) from t1 where col3>="20221215114210" group by col4) from t2 where t2.col1 <6 group by col1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;
 
--replace_column 10 #  11 #
explain insert into insert_table3 select count(*),(select count(col2) from t1 where col3<"20221215114210" group by col4 limit 2,1) from t2 where t2.col1 <6 group by col1 limit 3;
let $query = insert into insert_table3 select count(*),(select count(col2) from t1 where col3<"20221215114210" group by col4 limit 2,1) from t2 where t2.col1 <6 group by col1 limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;
 
--replace_column 10 #  11 #
explain insert into insert_table3 select count(*),(select count(col2) from t1 where col3>="20221215114210" group by col4 order by col1) from t2 where t2.col1 <6 group by col1 order by col3;
let $query = insert into insert_table3 select count(*),(select count(col2) from t1 where col3>="20221215114210" group by col4 order by col1) from t2 where t2.col1 <6 group by col1 order by col3;
 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;
 
--replace_column 10 #  11 #
explain insert into insert_table3 select count(col1),(select count(col1) from t1 where col3<"20221215114210" group by col1 order by col1 limit 1) from t2 where t2.col1 <6 group by col1 order by col1 limit 1;
let $query = insert into insert_table3 select count(col1),(select count(col1) from t1 where col3<"20221215114210" group by col1 order by col1 limit 1) from t2 where t2.col1 <6 group by col1 order by col1 limit 1;
 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;

# seqDB-29612
--replace_column 10 #  11 #
explain  insert into insert_table3 select count(*),(select count(col1) from t1 where col1>=1 limit 1,3) from t2 where col3>"20221115114210" limit 3;
--sorted_result
let $query = insert into insert_table3 select count(*),(select count(col1) from t1 where col1>=1 limit 1,3) from t2 where col3>"20221115114210" limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;

--replace_column 10 #  11 #
explain  insert into insert_table3 select count(1),(select col1 from t1 where col2="bcd" order by col3) from t2 where col3>"20221115114210" order by col4;
--sorted_result
let $query = insert into insert_table3 select count(1),(select col1 from t1 where col2="bcd" order by col3) from t2 where col3>"20221115114210" order by col4;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;

--replace_column 10 #  11 #
explain  insert into insert_table3 select count(1),(select col1 from t1 where col2>="bcd" order by col3 limit 2,1) from t2 where col3>"20221115114210" order by col4 limit 1,3;
--sorted_result
let $query = insert into insert_table3 select count(1),(select col1 from t1 where col2>="bcd" order by col3 limit 2,1) from t2 where col3>"20221115114210" order by col4 limit 1,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;
 

# seqDB-29613
--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from t2 where t2.col1 < (select count(col4) from t1 where col3>="20221115114210" ) ;
let $query = insert into insert_table1 select count(*) from t2 where t2.col1 < (select count(col4) from t1 where col3>="20221115114210" ) ;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col1 < (select col1 from t1 where col1>=5 limit 0,1)  limit 3;
let $query = insert into t5 select * from t2 where t2.col1 < (select col1 from t1 where col1>=5 limit 0,1)  limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 

 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>="20221115114010" group by col4 having col4 < "zzz") group by col3 desc; 
let $query = insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>="20221115114010" group by col4 having col4 < "zzz") group by col3 desc; 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col1 < (select col1 from t1 where col1>=5 order by col4 limit 0,1)  order by col3 desc limit 3;
let $query = insert into t5 select * from t2 where t2.col1 < (select col1 from t1 where col1>=5 order by col4 limit 0,1)  order by col3 desc limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col1 < (select col1 from t1 where col1>=5 group by col4 limit 0,1) group by col3 desc limit 3;
let $query = insert into t5 select * from t2 where t2.col1 < (select col1 from t1 where col1>=5 group by col4 limit 0,1) group by col3 desc limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col2 < (select col4 from t1 where col3>="20221115114210" group by col4 desc limit 1) group by col3 desc limit 3;
let $query = insert into t5 select * from t2 where t2.col2 < (select col4 from t1 where col3>="20221115114210" group by col4 desc limit 1) group by col3 desc limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 having col4 < "zzz"   order by col1 desc) group by col3 order by col2 desc;
let $query = insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 having col4 < "zzz"   order by col1 desc) group by col3 order by col2 desc;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col1 < (select col1 from t1 where col1>=5 group by col4 order by col1 limit 0,1) group by col3 order by col2 desc limit 3;
let $query = insert into t5 select * from t2 where t2.col1 < (select col1 from t1 where col1>=5 group by col4 order by col1 limit 0,1) group by col3 order by col2 desc limit 3;
 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col2 desc having col2 < "zzz") group by col3 desc limit 3;
let $query = insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col2 desc having col2 < "zzz") group by col3 desc limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col2 < (select col4 from t1 where col1>="7" group by col4 desc) group by col3 desc limit 3;
let $query = insert into t5 select * from t2 where t2.col2 < (select col4 from t1 where col1>="7" group by col4 desc) group by col3 desc limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 having col4 < "zzz"   order by col1 desc) group by col3 order by col2 desc limit 3;
let $query = insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 having col4 < "zzz"   order by col1 desc) group by col3 order by col2 desc limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col4 in(select col2 from t1 where col2>"def" order by col1 desc) group by col1 limit 3;
let $query = insert into t5 select * from t2 where t2.col4 in(select col2 from t1 where col2>"def" order by col1 desc) group by col1 limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table1 select col1 from t2 where t2.col1 <(select count(1) from t1 where col1>=1 limit 0,1) group by col1 order by col1 limit 1;
let $query = insert into insert_table1 select col1 from t2 where t2.col1 <(select count(1) from t1 where col1>=1 limit 0,1) group by col1 order by col1 limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;
   
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col1 <(select count(col1) from t1 where col1>=1 limit 0,1)  group by col1 limit 3;
let $query = insert into t5 select * from t2 where t2.col1 <(select count(col1) from t1 where col1>=1 limit 0,1)  group by col1 limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col1 <(select col1 from t1 where col1>=1 limit 0,1)  group by col1 limit 3;
let $query = insert into t5 select * from t2 where t2.col1 <(select col1 from t1 where col1>=1 limit 0,1)  group by col1 limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col1 <(select col1 from t1 where col1=1 order by col3 desc)  group by col1 limit 3;
let $query = insert into t5 select * from t2 where t2.col1 <(select col1 from t1 where col1=1 order by col3 desc)  group by col1 limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 having col4 < "zzz"  order by col1 desc); 
let $query = insert into insert_table1 select count(*) from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 having col4 < "zzz"  order by col1 desc); 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 having col4 < "zzz"   order by col1 desc)  limit 3;
let $query = insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 having col4 < "zzz"   order by col1 desc)  limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 having col4 < "zzz"   order by col1 desc) order by col3 desc limit 3;
let $query = insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 having col4 < "zzz"   order by col1 desc) order by col3 desc limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 having col4 < "zzz"  order by col1 desc) order by col3 desc;
let $query = insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 having col4 < "zzz"  order by col1 desc) order by col3 desc;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" order by col1 desc)  order by col3 desc limit 3;
let $query = insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" order by col1 desc)  order by col3 desc limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col1 < (select col1 from t1 where col1>=5 order by col2 limit 0,1) order by col3 desc;
let $query = insert into t5 select * from t2 where t2.col1 < (select col1 from t1 where col1>=5 order by col2 limit 0,1) order by col3 desc;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

# partition table
--replace_column 10 #  11 #
explain  insert into insert_table7 select col4 from t2_partition where t2_partition.col1 < (select col1 from t1_partition where col1>=5 order by col4,col1 limit 0,1) order by col4 desc;
--sorted_result
let $query = insert into insert_table7 select col4 from t2_partition where t2_partition.col1 < (select col1 from t1_partition where col1>=5 order by col4,col1 limit 0,1) order by col4 desc;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
 --sorted_result
select * from insert_table7;
truncate table insert_table7;

# seqDB-29614
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" order by col4 desc) order by col3 desc;
let $query = insert into t5 select * from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" order by col4 desc) order by col3 desc;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from t2 where t2.col1 in(select count(col4) from t1 where col3>"20221115114210" group by col4 desc) group by col3 desc; 
let $query = insert into insert_table1 select count(*) from t2 where t2.col1 in(select count(col4) from t1 where col3>"20221115114210" group by col4 desc) group by col3 desc; 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from t2 where  t2.col1 < (select count(col1) from t1 where col1>=5 group by col4 limit 0,1)group by col3 desc limit 3; 
let $query = insert into insert_table1 select count(*) from t2 where  t2.col1 < (select count(col1) from t1 where col1>=5 group by col4 limit 0,1)group by col3 desc limit 3; 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from t2 where t2.col1 in(select count(col4) from t1 where col3>"20221115114210" group by col4  order by col1 desc)  group by col3 order by col2 desc;
let $query = insert into insert_table1 select count(*) from t2 where t2.col1 in(select count(col4) from t1 where col3>"20221115114210" group by col4  order by col1 desc)  group by col3 order by col2 desc;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from t2 where t2.col1 < (select count(col1) from t1 where col1>=5 group by col4 order by col1 limit 0,1) group by col3 order by col2 desc limit 3;
let $query = insert into insert_table1 select count(*) from t2 where t2.col1 < (select count(col1) from t1 where col1>=5 group by col4 order by col1 limit 0,1) group by col3 order by col2 desc limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
# seqDB-29615
--replace_column 10 #  11 #
explain  insert into insert_table1 select count(1) from t2 where t2.col1 < (select col1 from t1 where col1>=5 limit 0,1)  limit 3;
--sorted_result
let $query = insert into insert_table1 select count(1) from t2 where t2.col1 < (select col1 from t1 where col1>=5 limit 0,1)  limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain  insert into insert_table1 select count(1) from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" order by col4 desc) order by col3 desc;
--sorted_result
let $query = insert into insert_table1 select count(1) from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" order by col4 desc) order by col3 desc;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain  insert into insert_table1 select count(1) from t2 where t2.col1 < (select col1 from t1 where col1>=5 order by col4 limit 0,1)  order by col3 desc limit 3;
--sorted_result
let $query = insert into insert_table1 select count(1) from t2 where t2.col1 < (select col1 from t1 where col1>=5 order by col4 limit 0,1)  order by col3 desc limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
# seqDB-29616 
--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from t2 where col1>4 group by col1 having col1> (select count(1) from t1 where col4>"def") ;
let $query = insert into insert_table1 select count(*) from t2 where col1>4 group by col1 having col1> (select count(1) from t1 where col4>"def") ;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where col1>4 group by col1 having col1> (select col1 from t1 where col4>"def" limit 1) limit 2;
let $query = insert into t5 select * from t2 where col1>4 group by col1 having col1> (select col1 from t1 where col4>"def" limit 1) limit 2;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where col1>4 group by col1 having col2 in (select col4 from t1 where col2>"def" group by col2 desc having col2 < "zzz");
let $query = insert into t5 select * from t2 where col1>4 group by col1 having col2 in (select col4 from t1 where col2>"def" group by col2 desc having col2 < "zzz");
 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into insert_table7 select col2 from t2 where col1>1 group by col1 having col2< (select col4 from t1 where col2<"abcdef" order by col4 desc limit 1) order by col2 desc limit 1;
let $query = insert into insert_table7 select col2 from t2 where col1>1 group by col1 having col2< (select col4 from t1 where col2<"abcdef" order by col4 desc limit 1) order by col2 desc limit 1;
 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into insert_table7 select col4 from t2 where col1>1 group by col4 having col4< (select col4 from t1 where col2="abcdef" group by col4 desc limit 1) limit 1;
let $query = insert into insert_table7 select col4 from t2 where col1>1 group by col4 having col4< (select col4 from t1 where col2="abcdef" group by col4 desc limit 1) limit 1;
 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where col1>1 group by col1 having col2< (select col4 from t1 where col2="abcdef" group by col3 order by col4 desc) order by col3; 
let $query = insert into t5 select * from t2 where col1>1 group by col1 having col2< (select col4 from t1 where col2="abcdef" group by col3 order by col4 desc) order by col3; 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where col1>4 group by col1 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 ) order by col2 desc limit 2;
let $query = insert into t5 select * from t2 where col1>4 group by col1 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 ) order by col2 desc limit 2;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from t2 where col1>1 group by col2 having col2< (select col4 from t1 where col2="abcdef" order by col4 desc );
let $query = insert into insert_table1 select count(*) from t2 where col1>1 group by col2 having col2< (select col4 from t1 where col2="abcdef" order by col4 desc );
 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from t2 where col1>4 group by col2 having col2< (select col4 from t1 where col2<"abcdef" order by col4 desc limit 1 );
let $query = insert into insert_table1 select count(*) from t2 where col1>4 group by col2 having col2< (select col4 from t1 where col2<"abcdef" order by col4 desc limit 1 );
 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from t2 where col1>4 group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 );
let $query = insert into insert_table1 select count(*) from t2 where col1>4 group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 );
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where col1>4 group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 ) limit 2;
let $query = insert into t5 select * from t2 where col1>4 group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 ) limit 2;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

# partition table
--replace_column 10 #  11 #
explain  insert into insert_table7 select col4 from t2_partition where col1>4 group by col4 having col4< (select col4 from t1_partition where col2<"abcdef" group by col4 order by col4 desc limit 1 ) limit 1;
--sorted_result
let $query = insert into insert_table7 select col4 from t2_partition where col1>4 group by col4 having col4< (select col4 from t1_partition where col2<"abcdef" group by col4 order by col4 desc limit 1 ) limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table7;
truncate table insert_table7;

# seqDB-29617
--replace_column 10 #  11 #
explain insert into t5 select * from t2 where col1>1 group by col1 having col2< (select col4 from t1 where col2="abcdef" order by col1 desc);
let $query = insert into t5 select * from t2 where col1>1 group by col1 having col2< (select col4 from t1 where col2="abcdef" order by col1 desc);
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from t2 where col1>1 group by col1 having col1 > (select count(col4) from t1 where col2="abcdef" group by col3 desc);
let $query = insert into insert_table1 select count(*) from t2 where col1>1 group by col1 having col1 > (select count(col4) from t1 where col2="abcdef" group by col3 desc);
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from t2 where col1>1 group by col1 having col1 > (select count(col4)  from t1 where col2="abcdef" group by col3 order by col4 desc) order by col3 desc; 
--sorted_result
let $query = insert into insert_table1 select count(*) from t2 where col1>1 group by col1 having col1 > (select count(col4)  from t1 where col2="abcdef" group by col3 order by col4 desc) order by col3 desc; 
 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from t2 where col1>1 group by col1 having col1 > (select count(col4)  from t1 where col2="abcdef" group by col3 order by col4 desc) order by col3 desc; 
--sorted_result
let $query = insert into insert_table1 select count(*) from t2 where col1>1 group by col1 having col1 > (select count(col4)  from t1 where col2="abcdef" group by col3 order by col4 desc) order by col3 desc; 
 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from t2 where col1>4 group by col1 having col1 > (select count(col4)  from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 ) order by col2 desc limit 2;
let $query = insert into insert_table1 select count(*) from t2 where col1>4 group by col1 having col1 > (select count(col4)  from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 ) order by col2 desc limit 2;
 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

# seqDB-29618
--replace_column 10 #  11 #
explain insert into insert_table1 select count(1) from t2 where col1>4 group by col1 having col1> (select col1 from t1 where col4>"def" limit 1) limit 2;
--sorted_result
let $query = insert into insert_table1 select count(1) from t2 where col1>4 group by col1 having col1> (select col1 from t1 where col4>"def" limit 1) limit 2;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain  insert into insert_table1 select count(1) from t2 where col1>1 group by col2 having col2< (select col4 from t1 where col2="abcdef" order by col1 desc);
--sorted_result
let $query = insert into insert_table1 select count(1) from t2 where col1>1 group by col2 having col2< (select col4 from t1 where col2="abcdef" order by col1 desc);
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain  insert into insert_table1 select count(1) from t2 where col1>1 group by col2 having col2< (select col4 from t1 where col2<"abcdef" order by col4 desc limit 1) order by col2 desc limit 1;
--sorted_result
let $query = insert into insert_table1 select count(1) from t2 where col1>1 group by col2 having col2< (select col4 from t1 where col2<"abcdef" order by col4 desc limit 1) order by col2 desc limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;


# seqDB-29619
--replace_column 10 #  11 #
explain insert into insert_table3 select count(*),(select count(col1) from t1 where col1>=1)  from t2 where t2.col1 in(select count(col4) from t1 where col3>"20221115114210" ) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
let $query = insert into insert_table3 select count(*),(select count(col1) from t1 where col1>=1)  from t2 where t2.col1 in(select count(col4) from t1 where col3>"20221115114210" ) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;

--replace_column 10 #  11 #
explain insert into insert_table2 select *,(select col1 from t1 where col1>=1 limit 2,1)  from t2 where t2.col1 < (select col1 from t1 where col1>=5 limit 0,1) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
let $query = insert into insert_table2 select *,(select col1 from t1 where col1>=1 limit 2,1)  from t2 where t2.col1 < (select col1 from t1 where col1>=5 limit 0,1) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;
 
--replace_column 10 #  11 #
explain insert into insert_table2 select *,(select col1 from t1 where col1>=7 group by col1)  from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 desc having col4 < "zzz" ) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
let $query = insert into insert_table2 select *,(select col1 from t1 where col1>=7 group by col1)  from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 desc having col4 < "zzz" ) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;

--replace_column 10 #  11 #
explain insert into insert_table2 select *,(select col1 from t1 where col1>=1 order by col3 desc,col1 limit 2,1)  from t2 where t2.col1 < (select col1 from t1 where col1>=5 order by col4 limit 0,1) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
let $query = insert into insert_table2 select *,(select col1 from t1 where col1>=1 order by col3 desc,col1 limit 2,1)  from t2 where t2.col1 < (select col1 from t1 where col1>=5 order by col4 limit 0,1) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;
 
--replace_column 10 #  11 #
explain insert into insert_table2 select *,(select col1 from t1 where col1>=1 group by col1 limit 2,1)  from t2 where t2.col1 < (select col1 from t1 where col1>=5 group by col4 limit 0,1) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
let $query = insert into insert_table2 select *,(select col1 from t1 where col1>=1 group by col1 limit 2,1)  from t2 where t2.col1 < (select col1 from t1 where col1>=5 group by col4 limit 0,1) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;
 
--replace_column 10 #  11 #
explain insert into insert_table2 select *,(select col1 from t1 where col1>=7 group by col1 order by col3 desc)  from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 having col4 < "zzz"   order by col1 desc) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
let $query = insert into insert_table2 select *,(select col1 from t1 where col1>=7 group by col1 order by col3 desc)  from t2 where t2.col2 in(select col4 from t1 where col3>"20221115114210" group by col4 having col4 < "zzz"   order by col1 desc) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;
 
--replace_column 10 #  11 #
explain insert into insert_table2 select *,(select col1 from t1 where col1>=1 group by col1 order by col1 desc limit 1)  from t2 where t2.col1 < (select col1 from t1 where col1>=5 group by col4 order by col1 limit 0,1) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
let $query = insert into insert_table2 select *,(select col1 from t1 where col1>=1 group by col1 order by col1 desc limit 1)  from t2 where t2.col1 < (select col1 from t1 where col1>=5 group by col4 order by col1 limit 0,1) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;

--replace_column 10 #  11 #
explain insert into insert_table2 select *,(select col1 from t1 where col1>=1 limit 2,1) from t2 where t2.col2 in(select col4 from t1 where col3<"20221115114210" order by col4 desc)  group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   order by col3 desc;
let $query = insert into insert_table2 select *,(select col1 from t1 where col1>=1 limit 2,1) from t2 where t2.col2 in(select col4 from t1 where col3<"20221115114210" order by col4 desc)  group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   order by col3 desc;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;
 
--replace_column 10 #  11 #
explain insert into insert_table2 select *,(select col1 from t1 where col1>=1 limit 2,1) from t2 where t2.col2 in(select col4 from t1 where col3<"20221115114210" order by col4 desc)  group by col2 having col2< (select col4 from t1 where col2<"abcdef" order by col4 desc limit 1 )   order by col3 desc;
let $query = insert into insert_table2 select *,(select col1 from t1 where col1>=1 limit 2,1) from t2 where t2.col2 in(select col4 from t1 where col3<"20221115114210" order by col4 desc)  group by col2 having col2< (select col4 from t1 where col2<"abcdef" order by col4 desc limit 1 )   order by col3 desc;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;
 
--replace_column 10 #  11 #
explain insert into insert_table2 select *,(select col1 from t1 where col1>=1 limit 2,1) from t2 where t2.col2 in(select col4 from t1 where col3<"20221115114210" order by col4 desc)  group by col2 having col2< (select col4 from t1 where col2="abcdef" order by col4 desc )   order by col3 desc;
let $query = insert into insert_table2 select *,(select col1 from t1 where col1>=1 limit 2,1) from t2 where t2.col2 in(select col4 from t1 where col3<"20221115114210" order by col4 desc)  group by col2 having col2< (select col4 from t1 where col2="abcdef" order by col4 desc )   order by col3 desc;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;
 
--replace_column 10 #  11 #
explain insert into insert_table2 select *,(select col1 from t1 where col2>="bcd" order by col1 limit 0,1) from t2 where t2.col4 in(select col2 from t1 where col2>"def" group by col1 desc having col1 < 10) group by col4 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
let $query = insert into insert_table2 select *,(select col1 from t1 where col2>="bcd" order by col1 limit 0,1) from t2 where t2.col4 in(select col2 from t1 where col2>"def" group by col1 desc having col1 < 10) group by col4 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;

--replace_column 10 #  11 #
explain insert into insert_table4 select *,(select col4 from t1 where col3<"20221215114210" group by col4 order by col4 limit 1) from t2 where t2.col1 <(select count(1) from t1 where col1>=1 limit 0,1) group by col1 having col1< (select col1 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1) order by col3 limit 3;
let $query = insert into insert_table4 select *,(select col4 from t1 where col3<"20221215114210" group by col4 order by col4 limit 1) from t2 where t2.col1 <(select count(1) from t1 where col1>=1 limit 0,1) group by col1 having col1< (select col1 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1) order by col3 limit 3; 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table4;
truncate table insert_table4;
 
 # partition table
--replace_column 10 #  11 #
explain  insert into insert_table5 select col1,(select col4 from t1_partition where col3<"20221215114210" group by col4 order by col4 limit 1) from t2_partition where t2_partition.col1 <(select count(1) from t1_partition where col1>=1 limit 0,1) group by col1 having col1< (select max(col1) from t1_partition where col2<"abcdef" group by col4 order by col4 desc limit 1) order by col1 limit 1;
--sorted_result
let $query = insert into insert_table5 select col1,(select col4 from t1_partition where col3<"20221215114210" group by col4 order by col4 limit 1) from t2_partition where t2_partition.col1 <(select count(1) from t1_partition where col1>=1 limit 0,1) group by col1 having col1< (select max(col1) from t1_partition where col2<"abcdef" group by col4 order by col4 desc limit 1) order by col1 limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table5;
truncate table insert_table5;

# seqDB-29620
--replace_column 10 #  11 #
explain  insert into insert_table2 select *,(select col1 from t1 where col1>=7 order by col1 desc)  from t2 where t2.col2 in(select col2 from t1 where col3>"20221115114210" order by col2 desc) group by col2 having col2> (select col2 from t1 where col2>"abcdef" group by col2 order by col2 desc limit 1 )   limit 1;
--sorted_result
let $query = insert into insert_table2 select *,(select col1 from t1 where col1>=7 order by col1 desc)  from t2 where t2.col2 in(select col2 from t1 where col3>"20221115114210" order by col2 desc) group by col2 having col2> (select col2 from t1 where col2>"abcdef" group by col2 order by col2 desc limit 1 )   limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;

--replace_column 10 #  11 #
explain insert into insert_table3 select count(*),(select count(col1)  from t1 where col1>=7 group by col1)  from t2 where t2.col1 in(select count(col4) from t1 where col3>"20221115114210" group by col4 desc) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
let $query = insert into insert_table3 select count(*),(select count(col1)  from t1 where col1>=7 group by col1)  from t2 where t2.col1 in(select count(col4) from t1 where col3>"20221115114210" group by col4 desc) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;
 
--replace_column 10 #  11 #
explain insert into insert_table3 select count(*),(select count(col1)  from t1 where col1>=1 group by col1 limit 2,1)  from t2 where  t2.col1 < (select count(col1) from t1 where col1>=5 group by col4 limit 0,1) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
let $query = insert into insert_table3 select count(*),(select count(col1)  from t1 where col1>=1 group by col1 limit 2,1)  from t2 where  t2.col1 < (select count(col1) from t1 where col1>=5 group by col4 limit 0,1) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;
 
--replace_column 10 #  11 #
explain insert into insert_table3 select count(*),(select count(col1)  from t1 where col1>=7 group by col1 order by col3 desc)  from t2 where t2.col1 in(select count(col4) from t1 where col3>"20221115114210" group by col4  order by col1 desc) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
let $query = insert into insert_table3 select count(*),(select count(col1)  from t1 where col1>=7 group by col1 order by col3 desc)  from t2 where t2.col1 in(select count(col4) from t1 where col3>"20221115114210" group by col4  order by col1 desc) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;
 
--replace_column 10 #  11 #
explain insert into insert_table3 select count(*),(select count(col1)  from t1 where col1>=1 group by col1 order by col3 desc limit 2,1)  from t2 where t2.col1 < (select count(col1) from t1 where col1>=5 group by col4 order by col1 limit 0,1) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
let $query = insert into insert_table3 select count(*),(select count(col1)  from t1 where col1>=1 group by col1 order by col3 desc limit 2,1)  from t2 where t2.col1 < (select count(col1) from t1 where col1>=5 group by col4 order by col1 limit 0,1) group by col2 having col2< (select col4 from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;

# seqDB-29621
--replace_column 10 #  11 #
explain  insert into insert_table3 select count(1) as col1,(select count(col1)  from t1 where col1>=1 limit 6) as col2  from t2 where t2.col1 < (select count(col1)  from t1 where col1>=5 limit 0,1) group by col1 having col1< (select count(col4)  from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 );
let $query = insert into insert_table3 select count(1) as col1,(select count(col1)  from t1 where col1>=1 limit 6) as col2  from t2 where t2.col1 < (select count(col1)  from t1 where col1>=5 limit 0,1) group by col1 having col1< (select count(col4)  from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 );
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;

--replace_column 10 #  11 #
explain insert into insert_table3 select count(1),(select count(col1) from t1 where col1>=1 order by col1 desc)  from t2 where t2.col1 in (select count(col1) from t1 where col3>"20221115114210" order by col1 desc) group by t2.col1 having t2.col1> (select count(col1) from t1 where col2>"abcdef" group by col1 order by col1 desc limit 1 )   limit 3;
let $query = insert into insert_table3 select count(1),(select count(col1) from t1 where col1>=1 order by col1 desc)  from t2 where t2.col1 in (select count(col1) from t1 where col3>"20221115114210" order by col1 desc) group by t2.col1 having t2.col1> (select count(col1) from t1 where col2>"abcdef" group by col1 order by col1 desc limit 1 )   limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;

--replace_column 10 #  11 #
explain  insert into insert_table3 select count(1),(select count(col1) from t1 where col1>=1 order by col3 desc limit 2,1)  from t2 where t2.col1 < (select count(col1) from t1 where col1>=5 order by col4 limit 0,1) group by col1 having col1< (select count(col4) from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
let $query = insert into insert_table3 select count(1),(select count(col1) from t1 where col1>=1 order by col3 desc limit 2,1)  from t2 where t2.col1 < (select count(col1) from t1 where col1>=5 order by col4 limit 0,1) group by t2.col1 having t2.col1< (select count(col4) from t1 where col2<"abcdef" group by col3 order by col4 desc limit 1 )   limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;

# seqDB-29622
--replace_column 10 #  11 #
explain insert into insert_table3 select count(*),(select count(1) from t1, t2 where t1.col1>=4 and t2.col1 <=6 ) from t2 where t2.col1 < (select count(col4) from t1 where col3>="20221115114210" ) ;
let $query = insert into insert_table3 select count(*),(select count(1) from t1, t2 where t1.col1>=4 and t2.col1 <=6 ) from t2 where t2.col1 < (select count(col4) from t1 where col3>="20221115114210" ) ;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table3;
truncate table insert_table3;

--replace_column 10 #  11 #
explain insert into insert_table4 select *, (select t1.col4 from t1, t2 where t1.col1>=2 and t2.col1 <=6 group by t1.col3 order by t1.col3  limit 1) from t2 where t2.col1 < (select col1 from t1 where col1>=5 group by col4 order by col1 limit 0,1) group by col3 order by col2 desc limit 3;
let $query = insert into insert_table4 select *, (select t1.col4 from t1, t2 where t1.col1>=2 and t2.col1 <=6 group by t1.col3 order by t1.col3  limit 1) from t2 where t2.col1 < (select col1 from t1 where col1>=5 group by col4 order by col1 limit 0,1) group by col3 order by col2 desc limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table4;
truncate table insert_table4;


# seqDB-29623
--replace_column 10 #  11 #
explain insert into insert_table1 select * from (select count(*) from t1 where col3>="20221115114310") dt;
let $query = insert into insert_table1 select * from (select count(*) from t1 where col3>="20221115114310") dt;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from t1 where col3>="20221115114310" limit 2,1) dt where col2>"bcd" limit 3;
let $query = insert into t5 select * from (select * from t1 where col3>="20221115114310" limit 2,1) dt where col2>"bcd" limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from t1 where col3>="20221115114310" group by col1) dt where col2>"bcd" group by col2;
let $query = insert into t5 select * from (select * from t1 where col3>="20221115114310" group by col1) dt where col2>"bcd" group by col2;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from t1 where col3>="20221115114310" order by col1 limit 2,1) dt where col2>"bcd" order by col3 limit 3;
let $query = insert into t5 select * from (select * from t1 where col3>="20221115114310" order by col1 limit 2,1) dt where col2>"bcd" order by col3 limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from t1 where col3>="20221115114310" group by col1 limit 2,1) dt where col2>"bcd" group by col2 limit 3;
let $query = insert into t5 select * from (select * from t1 where col3>="20221115114310" group by col1 limit 2,1) dt where col2>"bcd" group by col2 limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from t1 where col3>="20221115114310" group by col1 order by col1) dt where col2>"defg" group by col2 order by col3;
--sorted_result
let $query = insert into t5 select * from (select * from t1 where col3>="20221115114310" group by col1 order by col1) dt where col2>"defg" group by col2 order by col3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from t1 where col3>="20221115114310" group by col1 order by col1 limit 2,1) dt where col2>"bcd" group by col2 order by col3 limit 3;
let $query = insert into t5 select * from (select * from t1 where col3>="20221115114310" group by col1 order by col1 limit 2,1) dt where col2>"bcd" group by col2 order by col3 limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from t1 where col2>"def" order by col4 desc limit 5) dt where col1>=1 limit 2,3;
let $query = insert into t5 select * from (select * from t1 where col2>"def" order by col4 desc limit 5) dt where col1>=1 limit 2,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from t1 where col1>1 group by col4 desc limit 4) dt where col4>"aef" order by col4 desc limit 2,2;
let $query = insert into t5 select * from (select * from t1 where col1>1 group by col4 desc limit 4) dt where col4>"aef" order by col4 desc limit 2,2;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(1) from (select * from t1 where col3>="20221115114310" group by col1 order by col1 limit 2,1) dt where col2>"bcd" group by col2 order by col3;
let $query = insert into insert_table1 select count(1) from (select * from t1 where col3>="20221115114310" group by col1 order by col1 limit 2,1) dt where col2>"bcd" group by col2 order by col3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

# partition table
--replace_column 10 #  11 #
explain  insert into insert_table1 select count(1) from (select col2 from t1_partition where col3>="20221115114310" group by col1 order by col1 limit 1) dt where col2>"bcd" group by col2 order by col2;
--sorted_result
let $query = insert into insert_table1 select count(1) from (select col2 from t1_partition where col3>="20221115114310" group by col1 order by col1 limit 1) dt where col2>"bcd" group by col2 order by col2;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

# seqDB-29624
--replace_column 10 #  11 #
explain insert into t5 select * from (select * from t1 where col3>="20221115114310" order by col1) dt where col2>"bcd" order by col3;
let $query = insert into t5 select * from (select * from t1 where col3>="20221115114310" order by col1) dt where col2>"bcd" order by col3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from (select count(*) from t1 where col3>="20221115114010" group by col1) dt limit 1;
let $query = insert into insert_table1 select count(*) from (select count(*) from t1 where col3>="20221115114010" group by col1) dt limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from (select count(*) from t1 where col3>="20221115114010" group by col1 limit 8) dt limit 1;
let $query = insert into insert_table1 select count(*) from (select count(*) from t1 where col3>="20221115114010" group by col1 limit 8) dt limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from (select count(*) from t1 where col3>="20221115114010" group by col1 order by col1) dt limit 1;
let $query = insert into insert_table1 select count(*) from (select count(*) from t1 where col3>="20221115114010" group by col1 order by col1) dt limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from (select count(*) from t1 where col3>="20221115114010" group by col1 order by col1 limit 8) dt limit 1;
let $query = insert into insert_table1 select count(*) from (select count(*) from t1 where col3>="20221115114010" group by col1 order by col1 limit 8) dt limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

# seqDB-29625
--replace_column 10 #  11 #
explain  insert into insert_table1 select count(*) from (select count(*) from t1 where col3>="20221115114010" limit 8) dt limit 1;
let $query = insert into insert_table1 select count(*) from (select count(*) from t1 where col3>="20221115114010" limit 8) dt limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain  insert into insert_table1 select count(1) from (select count(1) from t1 where col3>="20221115114310" order by col1) dt;
--sorted_result
let $query = insert into insert_table1 select count(1) from (select count(1) from t1 where col3>="20221115114310" order by col1) dt;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain  insert into insert_table1 select count(1) from (select count(1) from t1 where col3>="20221115114310" order by col1 limit 2,1) dt;
--sorted_result
let $query = insert into insert_table1 select count(1) from (select count(1) from t1 where col3>="20221115114310" order by col1 limit 2,1) dt;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

# seqDB-29626
--replace_column 10 #  11 #
explain insert into insert_table1 select count(1) from v4 where col3<"20221115114310";
let $query = insert into insert_table1 select count(1) from v4 where col3<"20221115114310";
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into t5 select * from v5 where col1>=1  limit 2,4;
let $query = insert into t5 select * from v5 where col1>=1 limit 2,4;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;


 
--replace_column 10 #  11 #
explain insert into insert_table2 select * from v6 where col2<="dd" group by col3;
let $query = insert into insert_table2 select * from v6 where col2<="dd" group by col3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;

--replace_column 10 #  11 #
explain insert into t5 select * from v5 where col1>=1 order by col1 limit 2,4;
let $query = insert into t5 select * from v5 where col1>=1 order by col1 limit 2,4;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table2 select * from v6 where col2<="dd" group by col3 limit 1;
let $query = insert into insert_table2 select * from v6 where col2<="dd" group by col3 limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;

--replace_column 10 #  11 #
explain insert into insert_table2 select * from v6 where col2<="dd" group by col3 order by col3;
let $query = insert into insert_table2 select * from v6 where col2<="dd" group by col3 order by col3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;

--replace_column 10 #  11 #
explain insert into insert_table2 select * from v6 where col2<="dd" group by col3 order by col3 limit 1;
let $query = insert into insert_table2 select * from v6 where col2<="dd" group by col3 order by col3 limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table2;
truncate table insert_table2;

# seqDB-29627
--replace_column 10 #  11 #
explain insert into t5 select * from v5 where col1>=1 order by col1;
let $query = insert into t5 select * from v5 where col1>=1 order by col1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(1) from v6 where col2<="dd" group by col3;
let $query = insert into insert_table1 select count(1) from v6 where col2<="dd" group by col3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(1) from v6 where col2<="dd" group by col3 limit 1;
let $query = insert into insert_table1 select count(1) from v6 where col2<="dd" group by col3 limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(1) from v6 where col2<="dd" group by col3 order by col3;
let $query = insert into insert_table1 select count(1) from v6 where col2<="dd" group by col3 order by col3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(1) from v6 where col2<="dd" group by col3 order by col3 limit 1;
let $query = insert into insert_table1 select count(1) from v6 where col2<="dd" group by col3 order by col3 limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

# seqDB-29628
--replace_column 10 #  11 #
explain  insert into insert_table1 select count(1) from v5 where col1>=1  limit 2,4;
--sorted_result
let $query = insert into insert_table1 select count(1) from v5 where col1>=1 limit 2,4;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain  insert into insert_table1 select count(1) from v5 where col1>=1 order by col1;
--sorted_result
let $query = insert into insert_table1 select count(1) from v5 where col1>=1 order by col1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain  insert into insert_table1 select count(1) from v5 where col1>=1 order by col1 limit 2,4;
--sorted_result
let $query = insert into insert_table1 select count(1) from v5 where col1>=1 order by col1 limit 2,4;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;


# seqDB-29629
--replace_column 10 #  11 #
explain insert into insert_table1 select * from (select count(*) from v1 where col3>="20221115114310") dt;
let $query = insert into insert_table1 select * from (select count(*) from v1 where col3>="20221115114310") dt;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from v1 where col3>="20221115114310" limit 2,1) dt where col2>"bcd" limit 3;
let $query = insert into t5 select * from (select * from v1 where col3>="20221115114310" limit 2,1) dt where col2>"bcd" limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from v1 where col3>"20221115114310" group by col1) dt where col2>"defg" group by col2;
--sorted_result
let $query = insert into t5 select * from (select * from v1 where col3>"20221115114310" group by col1) dt where col2>"defg" group by col2;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from v1 where col3>="20221115114310" order by col1 limit 2,1) dt where col2>"defg" order by col3 limit 3;
let $query = insert into t5 select * from (select * from v1 where col3>="20221115114310" order by col1 limit 2,1) dt where col2>"defg" order by col3 limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from v1 where col3>="20221115114310" group by col1 limit 2,1) dt where col2>"defg" group by col2 limit 3;
let $query = insert into t5 select * from (select * from v1 where col3>="20221115114310" group by col1 limit 2,1) dt where col2>"defg" group by col2 limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from v1 where col3>="20221115114310" group by col1 order by col1) dt where col2>"defg" group by col2 order by col3;
--sorted_result
let $query = insert into t5 select * from (select * from v1 where col3>="20221115114310" group by col1 order by col1) dt where col2>"defg" group by col2 order by col3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from v1 where col3>="20221115114310" group by col1 order by col1 limit 2,1) dt where col2>"defg" group by col2 order by col3 limit 3;
--sorted_result
let $query = insert into t5 select * from (select * from v1 where col3>="20221115114310" group by col1 order by col1 limit 2,1) dt where col2>"defg" group by col2 order by col3 limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from v1 where col2>"def" order by col4 desc limit 5) dt where col1>=1 limit 2,3;
let $query = insert into t5 select * from (select * from v1 where col2>"def" order by col4 desc limit 5) dt where col1>=1 limit 2,3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from v1 where col1>1 group by col4 desc limit 4) dt where col4>"aef" order by col4 desc limit 2,2;
let $query = insert into t5 select * from (select * from v1 where col1>1 group by col4 desc limit 4) dt where col4>"aef" order by col4 desc limit 2,2;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(1) from (select * from v1 where col3>="20221115114310" group by col1 order by col1 limit 2,1) dt where col2>"bcd" group by col2 order by col3;
let $query = insert into insert_table1 select count(1) from (select * from v1 where col3>="20221115114310" group by col1 order by col1 limit 2,1) dt where col2>"bcd" group by col2 order by col3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

# seqDB-29630
--replace_column 10 #  11 #
explain insert into t5 select * from (select * from v1 where col3>"20221115114310" order by col1) dt where col2>"defg" order by col3 desc;
--sorted_result
let $query = insert into t5 select * from (select * from v1 where col3>"20221115114310" order by col1) dt where col2>"defg" order by col3 desc;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from (select count(*) from v1 where col3>="20221115114010" group by col3) dt limit 1;
let $query = insert into insert_table1 select count(*) from (select count(*) from v1 where col3>="20221115114010" group by col3) dt limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from (select count(*) from v1 where col3>="20221115114010" group by col1 limit 8) dt limit 1;
let $query = insert into insert_table1 select count(*) from (select count(*) from v1 where col3>="20221115114010" group by col1 limit 8) dt limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from (select count(*) from v1 where col3>="20221115114010" order by col1 limit 8) dt limit 1;
let $query = insert into insert_table1 select count(*) from (select count(*) from v1 where col3>="20221115114010" order by col1 limit 8) dt limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from (select count(*) from v1 where col3>="20221115114010" group by col1 order by col1 limit 8) dt limit 1;
let $query = insert into insert_table1 select count(*) from (select count(*) from v1 where col3>="20221115114010" group by col1 order by col1 limit 8) dt limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

# seqDB-29631
--replace_column 10 #  11 #
explain  insert into insert_table1 select count(*) from (select * from v1 where col3>="20221115114310" limit 2,1) dt where col2>"bcd" limit 3;
--sorted_result
let $query = insert into insert_table1 select count(*) from (select * from v1 where col3>="20221115114310" limit 2,1) dt where col2>"bcd" limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain  insert into insert_table1 select count(*) from (select * from v1 where col3>="20221115114310" order by col1) dt where col2>"defg" order by col3;
--sorted_result
let $query = insert into insert_table1 select count(*) from (select * from v1 where col3>="20221115114310" order by col1) dt where col2>"defg" order by col3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain  insert into insert_table1 select count(*) from (select * from v1 where col3>="20221115114310" order by col1 limit 2,1) dt where col2>"defg" order by col3 limit 3;
--sorted_result
let $query = insert into insert_table1 select count(*) from (select * from v1 where col3>="20221115114310" order by col1 limit 2,1) dt where col2>"defg" order by col3 limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

# seqDB-29632
--replace_column 10 #  11 #
explain insert into insert_table1 select * from (select count(*) from v7) dt;
let $query = insert into insert_table1 select * from (select count(*) from v7) dt;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table1 select count(*) from t1,t2, (select count(*) from v7) dt;
let $query = insert into insert_table1 select count(*) from t1,t2, (select count(*) from v7) dt;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table3 select count(*),(select count(1) from t1, t2 where t1.col1>=4 and t2.col1 <=6 ) from t2 where t2.col1 < (select count(*) from v7 ) ;
let $query = insert into insert_table3 select count(*),(select count(1) from t1, t2 where t1.col1>=4 and t2.col1 <=6 ) from t2 where t2.col1 < (select count(*) from v7 ) ;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
select * from insert_table3;
truncate table insert_table3;

--replace_column 10 #  11 #
explain insert into t5 select * from (select * from v8 where col2>"defg" group by col1 order by col1 limit 7) dt where col3>="20221115112010" group by col2 order by col3 limit 6;
let $query = insert into t5 select * from (select * from v8 where col2>"defg" group by col1 order by col1 limit 7) dt where col3>="20221115112010" group by col2 order by col3 limit 6;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from t5;
truncate table t5;


--replace_column 10 #  11 #
explain insert into insert_table1 select t1.col1 from t1,t2, (select * from v8 where col2>="def" group by col1 order by col1 limit 7) dt where t1.col3>="20221115112010" group by t1.col1 order by t1.col1 limit 1;
let $query = insert into insert_table1 select t1.col1 from t1,t2, (select * from v8 where col2>="def" group by col1 order by col1 limit 7) dt where t1.col3>="20221115112010" group by t1.col1 order by t1.col1 limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table1;
truncate table insert_table1;

--replace_column 10 #  11 #
explain insert into insert_table4 select *, (select t1.col4 from t1, t2 where t1.col1>=2 and t2.col1 <=6 group by t1.col3 order by t1.col3  limit 1) from t2 where t2.col1 < (select col1 from v8 where col1>=5 group by col4 order by col1 limit 0,1) group by col3 order by col2 desc limit 3;
let $query = insert into insert_table4 select *, (select t1.col4 from t1, t2 where t1.col1>=2 and t2.col1 <=6 group by t1.col3 order by t1.col3  limit 1) from t2 where t2.col1 < (select col1 from v8 where col1>=5 group by col4 order by col1 limit 0,1) group by col3 order by col2 desc limit 3;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc
--sorted_result
select * from insert_table4;
truncate table insert_table4;


# partition table
--replace_column 10 #  11 #
explain  insert into insert_table5 select t2_partition.col1, (select t1_partition.col2 from t1_partition, t2_partition where t1_partition.col1>=2 and t2_partition.col1 <=6 group by t1_partition.col2 order by t1_partition.col2  limit 1) from t2_partition where t2_partition.col1 < (select col1 from v8 where col1>=5 group by col2 order by col2 limit 0,1) group by t2_partition.col2 order by t2_partition.col2 desc limit 1;

--sorted_result
let $query = insert into insert_table5 select t2_partition.col1, (select t1_partition.col2 from t1_partition, t2_partition where t1_partition.col1>=2 and t2_partition.col1 <=6 group by t1_partition.col2 order by t1_partition.col2  limit 1) from t2_partition where t2_partition.col1 < (select col1 from v8 where col1>=5 group by col2 order by col2 limit 0,1) group by t2_partition.col2 order by t2_partition.col2 desc limit 1;
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc

--sorted_result
select * from insert_table5;
truncate table insert_table5;

# seqDB-29634
--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union
(select * from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 0,1) order by col1 desc) dt where col1>0  group by col2 order by col2 limit 1);

let $query = insert into t5(select * from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union
(select * from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 0,1) order by col1 desc) dt where col1>0  group by col2 order by col2 limit 1);
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc

--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union
(select * from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" order by col4 limit 0,1) order by col1 desc) dt where col1>0  group by col2 order by col1 limit 1);

let $query = insert into t5(select * from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union
(select * from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" order by col4 limit 0,1) order by col1 desc) dt where col1>0  group by col2 order by col1 limit 1);
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc

--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union
(select * from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" group by col4 limit 0,1) order by col1 desc) dt where col1>0  group by col2 order by col2 limit 1);

let $query = insert into t5(select * from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union
 (select * from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" group by col4 limit 0,1) order by col1 desc) dt where col1>0  group by col2 order by col2 limit 1);
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc

--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union
(select * from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 0,1) order by col1 desc) dt where col1>0  group by col2 order by col1);

let $query = insert into t5(select * from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union
(select * from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 0,1) order by col1 desc) dt where col1>0  group by col2 order by col1);
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc

--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union 
(select * from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 0,1) order by col1 desc) dt where col1>0  group by col2);

let $query = insert into t5(select * from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union 
(select * from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 0,1) order by col1 desc) dt where col1>0  group by col2);
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc

--sorted_result
select * from t5;
truncate table t5;
 
--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1<(select count(1) from (select * from  t2 where col1<5 union ALL (select * from t1 where col2<(select col4 from t1 where col4>"aa" group by col3 order by col3 limit 3,1)) )ct))
union
(select * from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 2,1) order by col1 desc) dt where col1>0  group by col2 order by col2 limit 1);

let $query = insert into t5(select * from t1 where col1<(select count(1) from (select * from  t2 where col1<5 union ALL (select * from t1 where col2<(select col4 from t1 where col4>"aa" group by col3 order by col3 limit 3,1)) )ct))
union
(select * from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 2,1) order by col1 desc) dt where col1>0  group by col2 order by col2 limit 1);
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc

--sorted_result
select * from t5;
truncate table t5;

--replace_column 10 #  11 #
explain insert into t5(select * from t1 where col1<(select count(1) from ((select * from  t1 where col1<5 limit 9)
union ALL 
(select * from t2 where col2>
(select col4 from t1 where col4<(select col2 from (select * from t2 where col2>(select col4 from t1 where col2>"aa" limit 2,1) order by col1 desc limit 10) bt where col2>"aaa" group by col2 order by col2 limit 1) group by col2 order by col2 limit 1) limit 8
) )ct) limit 4)
union
(select * from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 2,1) order by col1 desc) dt where col1>0  group by col2 order by col2 limit 1);

let $query = insert into t5(select * from t1 where col1<(select count(1) from ((select * from  t1 where col1<5 limit 9)
union ALL 
(select * from t2 where col2>
(select col4 from t1 where col4<(select col2 from (select * from t2 where col2>(select col4 from t1 where col2>"aa" limit 2,1) order by col1 desc limit 10) bt where col2>"aaa" group by col2 order by col2 limit 1) group by col2 order by col2 limit 1) limit 8
) )ct) limit 4)
union
(select * from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 2,1) order by col1 desc) dt where col1>0  group by col2 order by col2 limit 1);
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc

--sorted_result
select * from t5;
truncate table t5;


# seqDB-29635
--replace_column 10 #  11 #
explain insert into insert_table1(select count(*) from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union
(select count(*)  from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" group by col4 limit 0,1) order by col1 desc) dt where col1>0  group by col2 order by col1 limit 1);

let $query = insert into insert_table1(select count(*) from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union
(select count(*)  from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" group by col4 limit 0,1) order by col1 desc) dt where col1>0  group by col2 order by col1 limit 1); 
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc

--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
--replace_column 10 #  11 #
explain insert into insert_table1(select count(*)  from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union
(select count(*)  from (select * from t1 where col2>(select col4 from t2 where col3<"20221115114210" group by col4 limit 1) order by col1 desc) dt where col1>0  group by col2 limit 1);

let $query = insert into insert_table1(select count(*)  from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union
(select count(*)  from (select * from t1 where col2>(select col4 from t2 where col3<"20221115114210" group by col4 limit 1) order by col1 desc) dt where col1>0  group by col2 limit 1);
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc

--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
--replace_column 10 #  11 #
explain insert into insert_table1(select count(*)  from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union
(select count(*)  from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 0,1) order by col1 desc) dt where col1>0  group by col2 order by col1);

let $query = insert into insert_table1(select count(*)  from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union
(select count(*)  from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 0,1) order by col1 desc) dt where col1>0  group by col2 order by col1);
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc

--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
--replace_column 10 #  11 #
explain insert into insert_table1(select count(*)  from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union 
(select count(*)  from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 0,1) order by col1 desc) dt where col1>0  group by col2);

let $query = insert into insert_table1(select count(*)  from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union 
(select count(*)  from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 0,1) order by col1 desc) dt where col1>0  group by col2);
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc

--sorted_result
select * from insert_table1;
truncate table insert_table1;
 
--replace_column 10 #  11 #
explain insert into insert_table1(select count(*)  from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union 
(select count(*)  from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 0,1) order by col1 desc limit 9) dt where col1>0  group by col2);

let $query = insert into insert_table1(select count(*)  from t1 where col1<(select count(1) from t2 where col1<5) limit 1) 
union 
(select count(*)  from (select * from t1 where col2>(select col4 from t2 where col3>"20221115114210" limit 0,1) order by col1 desc limit 9) dt where col1>0  group by col2);
--source include/query_without_sorted_and_get_mysqld_note_log_sequoiadb.inc

--sorted_result
select * from insert_table1;
truncate table insert_table1;
 

--disable_warnings
drop database if exists count_limit_sort_pushdown_sequoiadb_2;
--enable_warnings
set session sql_mode=default;
--source include/uninstall_sequoiadb.inc

