CREATE DATABASE test_auto_increment;
use test_auto_increment;
DROP TABLE IF EXISTS t1,t2;
CREATE TABLE t1(a BIGINT NOT NULL AUTO_INCREMENT, b CHAR(16), PRIMARY KEY(a));
CREATE TABLE t2(a INT NOT NULL AUTO_INCREMENT, b CHAR(16), PRIMARY KEY(a)) AUTO_INCREMENT = 100;
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` bigint(20) NOT NULL AUTO_INCREMENT,
  `b` char(16) DEFAULT NULL,
  PRIMARY KEY (`a`)
) ENGINE=SequoiaDB DEFAULT CHARSET=latin1
SHOW CREATE TABLE t2;
Table	Create Table
t2	CREATE TABLE `t2` (
  `a` int(11) NOT NULL AUTO_INCREMENT,
  `b` char(16) DEFAULT NULL,
  PRIMARY KEY (`a`)
) ENGINE=SequoiaDB AUTO_INCREMENT=100 DEFAULT CHARSET=latin1
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't2';
AUTO_INCREMENT
100
DROP TABLE t1,t2;
CREATE TABLE t1(a TINYINT NOT NULL AUTO_INCREMENT, UNIQUE KEY(a));
INSERT INTO t1 VALUES ();
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
2
INSERT INTO t1 VALUES (0),(10),(-1),(3.5),(7.1);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
12
SELECT * FROM t1;
a
-1
1
2
4
7
10
INSERT INTO t1 VALUES (NULL);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
12
SELECT * FROM t1;
a
-1
1
2
4
7
10
11
SET sql_mode = 'NO_AUTO_VALUE_ON_ZERO';
INSERT INTO t1 VALUES (0);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
13
SELECT * FROM t1;
a
-1
0
1
2
4
7
10
11
INSERT INTO t1 VALUES (100),(101),(102);
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` tinyint(4) NOT NULL AUTO_INCREMENT,
  UNIQUE KEY `a` (`a`)
) ENGINE=SequoiaDB AUTO_INCREMENT=104 DEFAULT CHARSET=latin1
INSERT INTO t1 VALUES (NULL);
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` tinyint(4) NOT NULL AUTO_INCREMENT,
  UNIQUE KEY `a` (`a`)
) ENGINE=SequoiaDB AUTO_INCREMENT=104 DEFAULT CHARSET=latin1
SELECT * FROM t1;
a
-1
0
1
2
4
7
10
11
100
101
102
103
DROP TABLE t1;
SET sql_mode = default;
CREATE TABLE t1(id SMALLINT NOT NULL AUTO_INCREMENT, a SMALLINT, PRIMARY KEY(id), UNIQUE KEY(a));
INSERT INTO t1(a) VALUES (1),(2),(3),(4),(5);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
11
INSERT INTO t1 values (3,-1);
ERROR 23000: Duplicate entry '{ "id": 3 }' for key 'PRIMARY'
INSERT INTO t1(a) values (6);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
11
SELECT * FROM t1 ORDER BY id;
id	a
1	1
2	2
3	3
4	4
5	5
6	6
INSERT INTO t1(a) values (10),(5),(11),(12);
ERROR 23000: Duplicate entry '{ "a": 5 }' for key 'a'
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
11
SELECT * FROM t1 ORDER BY id;
id	a
1	1
2	2
3	3
4	4
5	5
6	6
INSERT INTO t1(a) values (7);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
21
SELECT * FROM t1 ORDER BY id;
id	a
1	1
2	2
3	3
4	4
5	5
6	6
11	7
DROP TABLE t1;
CREATE TABLE t1(a MEDIUMINT NOT NULL AUTO_INCREMENT, UNIQUE KEY(a));
INSERT INTO t1 VALUES (),(),();
UPDATE t1 SET a = 4 WHERE a = 3;
INSERT INTO t1 VALUES (20);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
101
SELECT * FROM t1;
a
1
2
4
20
UPDATE t1 SET a = 10 WHERE a = 20;
INSERT INTO t1 VALUES ();
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
101
SELECT * FROM t1;
a
1
2
4
10
21
DROP TABLE t1;
CREATE TABLE t1(id INT NOT NULL AUTO_INCREMENT, a INT, PRIMARY KEY(id), UNIQUE KEY(a));
INSERT INTO t1(a) VALUES (1),(2),(3);
INSERT INTO t1 VALUES (11,11);
UPDATE t1 SET id = 3 WHERE id = 11;
ERROR 23000: Duplicate entry '{ "id": 3 }' for key 'PRIMARY'
INSERT INTO t1(a) VALUES (12);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1 ORDER BY id;
id	a
1	1
2	2
3	3
11	11
12	12
UPDATE t1 SET a = 3 WHERE a = 11;
ERROR 23000: Duplicate entry '{ "a": 3 }' for key 'a'
INSERT INTO t1(a) VALUES (13);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1 ORDER BY id;
id	a
1	1
2	2
3	3
11	11
12	12
13	13
DROP TABLE t1;
CREATE TABLE t1(a INT NOT NULL AUTO_INCREMENT, b CHAR(8), PRIMARY KEY(a));
INSERT INTO t1(b) VALUES ('a'),('b'),('c');
REPLACE INTO t1 VALUES (6, 'x'),(8, 'y');
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a	b
1	a
2	b
3	c
6	x
8	y
REPLACE INTO t1 VALUES (1, 'a111'),(3, 'c333');
INSERT INTO t1 VALUES ();
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a	b
1	a111
2	b
3	c333
6	x
8	y
9	NULL
DROP TABLE t1;
CREATE TABLE t1(a INT NOT NULL AUTO_INCREMENT, UNIQUE KEY(a));
INSERT INTO t1 VALUES (),(),();
INSERT INTO t1 VALUES (10);
UPDATE IGNORE t1 SET a = 3 WHERE a = 10;
SHOW WARNINGS;
Level	Code	Message
INSERT INTO t1 VALUES ();
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a
1
2
3
10
11
UPDATE IGNORE t1 SET a = 4 WHERE a = 10;
INSERT INTO t1 VALUES (10);
INSERT INTO t1 VALUES ();
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a
1
2
3
4
10
11
12
DROP TABLE t1;
CREATE TABLE t1(a BIGINT NOT NULL AUTO_INCREMENT, b CHAR(8), UNIQUE KEY(a));
INSERT INTO t1(b) VALUES ('aaa'),('bbb'),('ccc');
INSERT INTO t1 VALUES (6,'xxx'), (7,'yyy') ON DUPLICATE KEY UPDATE a = 3;
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a	b
1	aaa
2	bbb
3	ccc
6	xxx
7	yyy
INSERT INTO t1 VALUES (2,'newbbb') ON DUPLICATE KEY UPDATE a = 3;
ERROR 23000: Duplicate entry '{ "a": 3 }' for key 'a'
INSERT INTO t1 VALUES ();
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a	b
1	aaa
2	bbb
3	ccc
6	xxx
7	yyy
8	NULL
DROP TABLE t1;
CREATE TABLE t1(a BIGINT NOT NULL AUTO_INCREMENT,  PRIMARY KEY(a));
INSERT INTO t1 VALUES (),();
INSERT INTO t1 VALUES (11);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a
1
2
11
INSERT INTO t1 VALUES (101),(90),(121),(99),(100);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a
1
2
11
90
99
100
101
121
INSERT INTO t1 VALUES (10);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a
1
2
10
11
90
99
100
101
121
INSERT INTO t1 VALUES (5),(6);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a
1
2
5
6
10
11
90
99
100
101
121
DROP TABLE t1;
CREATE TABLE t1(a TINYINT NOT NULL AUTO_INCREMENT,  PRIMARY KEY(a));
CREATE TABLE t2(a TINYINT NOT NULL AUTO_INCREMENT,  KEY(a));
INSERT INTO t1 VALUES (),();
INSERT INTO t2 VALUES (),();
INSERT INTO t1 VALUES (127);
INSERT INTO t2 VALUES (127);
INSERT INTO t1 VALUES ();
ERROR HY000: Failed to read auto-increment value from storage engine
INSERT INTO t2 VALUES ();
ERROR HY000: Failed to read auto-increment value from storage engine
DROP TABLE t1,t2;
CREATE TABLE t1(a TINYINT NOT NULL AUTO_INCREMENT,  KEY(a));
CREATE TABLE t2(a SMALLINT NOT NULL AUTO_INCREMENT,  KEY(a));
CREATE TABLE t3(a MEDIUMINT NOT NULL AUTO_INCREMENT,  KEY(a));
CREATE TABLE t4(a INT NOT NULL AUTO_INCREMENT,  KEY(a));
CREATE TABLE t5(a BIGINT NOT NULL AUTO_INCREMENT,  KEY(a));
INSERT INTO t1 VALUES (),(),();
INSERT INTO t1 VALUES (1),(2);
INSERT INTO t2 VALUES (),(),();
INSERT INTO t2 VALUES (1),(2);
INSERT INTO t3 VALUES (),(),();
INSERT INTO t3 VALUES (1),(2);
INSERT INTO t4 VALUES (),(),();
INSERT INTO t4 VALUES (1),(2);
INSERT INTO t5 VALUES (),(),();
INSERT INTO t5 VALUES (1),(2);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't2';
AUTO_INCREMENT
11
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't3';
AUTO_INCREMENT
101
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't4';
AUTO_INCREMENT
1001
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't5';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a
1
1
2
2
3
SELECT * FROM t2;
a
1
1
2
2
3
SELECT * FROM t3;
a
1
1
2
2
3
SELECT * FROM t4;
a
1
1
2
2
3
SELECT * FROM t5;
a
1
1
2
2
3
UPDATE t1 SET a = 1 WHERE a = 2;
UPDATE t2 SET a = 1 WHERE a = 2;
UPDATE t3 SET a = 1 WHERE a = 2;
UPDATE t4 SET a = 1 WHERE a = 2;
UPDATE t5 SET a = 1 WHERE a = 2;
INSERT INTO t1 VALUES ();
INSERT INTO t2 VALUES ();
INSERT INTO t3 VALUES ();
INSERT INTO t4 VALUES ();
INSERT INTO t5 VALUES ();
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't2';
AUTO_INCREMENT
11
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't3';
AUTO_INCREMENT
101
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't4';
AUTO_INCREMENT
1001
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't5';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a
1
1
1
1
3
4
SELECT * FROM t2;
a
1
1
1
1
3
4
SELECT * FROM t3;
a
1
1
1
1
3
4
SELECT * FROM t4;
a
1
1
1
1
3
4
SELECT * FROM t5;
a
1
1
1
1
3
4
REPLACE INTO t1 VALUES (1),(2),(6),(9);
REPLACE INTO t2 VALUES (1),(2),(6),(9);
REPLACE INTO t3 VALUES (1),(2),(6),(9);
REPLACE INTO t4 VALUES (1),(2),(6),(9);
REPLACE INTO t5 VALUES (1),(2),(6),(9);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't2';
AUTO_INCREMENT
11
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't3';
AUTO_INCREMENT
101
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't4';
AUTO_INCREMENT
1001
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't5';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a
1
1
1
1
1
2
3
4
6
9
SELECT * FROM t2;
a
1
1
1
1
1
2
3
4
6
9
SELECT * FROM t3;
a
1
1
1
1
1
2
3
4
6
9
SELECT * FROM t4;
a
1
1
1
1
1
2
3
4
6
9
SELECT * FROM t5;
a
1
1
1
1
1
2
3
4
6
9
INSERT INTO t1 VALUES (6), (7) ON DUPLICATE KEY UPDATE a = 1;
INSERT INTO t1 VALUES (6), (7) ON DUPLICATE KEY UPDATE a = 1;
INSERT INTO t1 VALUES (6), (7) ON DUPLICATE KEY UPDATE a = 1;
INSERT INTO t1 VALUES (6), (7) ON DUPLICATE KEY UPDATE a = 1;
INSERT INTO t1 VALUES (6), (7) ON DUPLICATE KEY UPDATE a = 1;
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't2';
AUTO_INCREMENT
11
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't3';
AUTO_INCREMENT
101
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't4';
AUTO_INCREMENT
1001
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't5';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a
1
1
1
1
1
2
3
4
6
6
6
6
6
6
7
7
7
7
7
9
SELECT * FROM t2;
a
1
1
1
1
1
2
3
4
6
9
SELECT * FROM t3;
a
1
1
1
1
1
2
3
4
6
9
SELECT * FROM t4;
a
1
1
1
1
1
2
3
4
6
9
SELECT * FROM t5;
a
1
1
1
1
1
2
3
4
6
9
DELETE FROM t1 WHERE a = 1;
DELETE FROM t2 WHERE a = 6;
DELETE FROM t3 WHERE a = 7;
DELETE FROM t4 WHERE a = 9;
DELETE FROM t5 WHERE a = 11;
SELECT * FROM t1;
a
2
3
4
6
6
6
6
6
6
7
7
7
7
7
9
SELECT * FROM t2;
a
1
1
1
1
1
2
3
4
9
SELECT * FROM t3;
a
1
1
1
1
1
2
3
4
6
9
SELECT * FROM t4;
a
1
1
1
1
1
2
3
4
6
SELECT * FROM t5;
a
1
1
1
1
1
2
3
4
6
9
DROP TABLE t1,t2,t3,t4,t5;
CREATE TABLE t1(a FLOAT NOT NULL AUTO_INCREMENT, PRIMARY KEY(a));
INSERT INTO t1 VALUES ();
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a
1
INSERT INTO t1 VALUES (1.1);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a
1
1.1
INSERT INTO t1 VALUES (3),(5),(7);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a
1
1.1
3
5
7
INSERT INTO t1 VALUES (10),(2.2);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
1001
SELECT * FROM t1;
a
1
1.1
2.2
3
5
7
10
DROP TABLE t1;
CREATE TABLE t1(a INT NOT NULL AUTO_INCREMENT, b CHAR(16), PRIMARY KEY(a));
CREATE TABLE t2(a INT NOT NULL AUTO_INCREMENT, PRIMARY KEY(a));
SELECT LAST_INSERT_ID();
LAST_INSERT_ID()
1
INSERT INTO t1 VALUES ();
SELECT LAST_INSERT_ID();
LAST_INSERT_ID()
1
INSERT INTO t1 VALUES (),(),();
SELECT LAST_INSERT_ID();
LAST_INSERT_ID()
2
INSERT INTO t2 VALUES ();
SELECT LAST_INSERT_ID();
LAST_INSERT_ID()
1
INSERT INTO t1 VALUES ();
SELECT LAST_INSERT_ID();
LAST_INSERT_ID()
5
INSERT INTO t1 VALUES (10, 'a'), (1, 'b'), (11, 'c');
ERROR 23000: Duplicate entry '{ "a": 1 }' for key 'PRIMARY'
SELECT LAST_INSERT_ID();
LAST_INSERT_ID()
5
DROP TABLE t1;
DROP TABLE t2;
CREATE TABLE t1(a INT NOT NULL);
INSERT INTO t1 VALUES (0),(1),(2),(4),(6),(8),(12);
SELECT * FROM t1;
a
0
1
2
4
6
8
12
UPDATE t1 SET a = LAST_INSERT_ID(a + 1);
SELECT LAST_INSERT_ID();
LAST_INSERT_ID()
13
SELECT * FROM t1;
a
1
2
3
5
7
9
13
DELETE FROM t1 WHERE 1 = LAST_INSERT_ID(a - 6);
select LAST_INSERT_ID();
LAST_INSERT_ID()
7
SELECT * FROM t1;
a
1
2
3
5
9
13
DROP TABLE t1;
SET sql_mode = default;
CREATE TABLE t1(a SMALLINT NOT NULL AUTO_INCREMENT, b INT, PRIMARY KEY(b,a));
INSERT INTO t1 VALUES (NULL,1),(NULL,1),(NULL,1),(NULL,2),(NULL,1);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
11
SELECT * FROM t1;
a	b
1	1
2	1
3	1
4	2
5	1
UPDATE t1 SET a = 6 WHERE a = 5;
INSERT INTO t1 VALUES (20,3);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
31
SELECT * FROM t1;
a	b
1	1
2	1
20	3
3	1
4	2
6	1
UPDATE t1 SET a = 10 WHERE a = 20;
INSERT INTO t1 VALUES (NULL,3);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
31
SELECT * FROM t1;
a	b
1	1
10	3
2	1
21	3
3	1
4	2
6	1
DELETE FROM t1 WHERE a > 5;
SELECT * FROM t1;
a	b
1	1
2	1
3	1
4	2
DROP TABLE t1;
CREATE TABLE t1(a TINYINT NOT NULL AUTO_INCREMENT, b CHAR(8), c INT, KEY(b,a));
INSERT INTO t1 VALUES (NULL,'aaa',1),(NULL,'bbb',3),(NULL,'aaa',2),(NULL,'ccc',1);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
5
SELECT * FROM t1;
a	b	c
1	aaa	1
2	bbb	3
3	aaa	2
4	ccc	1
UPDATE t1 SET a = 1 WHERE a = 3;
INSERT INTO t1 VALUES (NULL,'aaa',3);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
6
SELECT * FROM t1;
a	b	c
1	aaa	1
1	aaa	2
2	bbb	3
4	ccc	1
5	aaa	3
REPLACE INTO t1 VALUES (1,'aaa',11),(2,'bbb',14),(10,'ddd',11);
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
12
SELECT * FROM t1;
a	b	c
1	aaa	1
1	aaa	11
1	aaa	2
10	ddd	11
2	bbb	14
2	bbb	3
4	ccc	1
5	aaa	3
INSERT INTO t1 VALUES (1,'aaa',11) ON DUPLICATE KEY UPDATE a = 3;
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
12
SELECT * FROM t1;
a	b	c
1	aaa	1
1	aaa	11
1	aaa	11
1	aaa	2
10	ddd	11
2	bbb	14
2	bbb	3
4	ccc	1
5	aaa	3
DELETE FROM t1 WHERE a = 1;
SELECT * FROM t1;
a	b	c
10	ddd	11
2	bbb	14
2	bbb	3
4	ccc	1
5	aaa	3
DROP TABLE t1;
CREATE TABLE t1 ( a BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY );
INSERT INTO t1 VALUES (9223372036854775807);
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`a`)
) ENGINE=SequoiaDB AUTO_INCREMENT=9223372036854775808 DEFAULT CHARSET=latin1
SELECT * FROM t1;
a
9223372036854775807
INSERT INTO t1 VALUES (9223372036854775808);
ERROR HY000: Failed to read auto-increment value from storage engine
INSERT INTO t1 VALUES (NULL);
ERROR HY000: Failed to read auto-increment value from storage engine
SELECT * FROM t1;
a
9223372036854775807
DROP TABLE t1;
create table t1 (a smallint primary key auto_increment);
insert ignore into t1 values(32766),(NULL),(NULL),(1);
ERROR HY000: Failed to read auto-increment value from storage engine
select * from t1;
a
truncate table t1;
set @org_mode=@@sql_mode;
set @@sql_mode='ansi,traditional';
insert ignore into t1 values(32766),(NULL),(NULL);
ERROR HY000: Failed to read auto-increment value from storage engine
truncate table t1;
insert into t1 values(32766),(NULL),(NULL);
ERROR HY000: Failed to read auto-increment value from storage engine
set @@sql_mode=@org_mode;
drop table t1;
CREATE TABLE t1(id INT NOT NULL AUTO_INCREMENT, UNIQUE KEY(id));
INSERT INTO t1 VALUES (),(),();
UPDATE t1 SET id = 4 where id = 3;
INSERT INTO t1 VALUES ();
SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'test_auto_increment' AND TABLE_NAME = 't1';
AUTO_INCREMENT
2001
SELECT * FROM t1 ORDER BY id;
id
1
2
4
1001
DROP TABLE t1;
CREATE TABLE t1 (
c1 INT NOT NULL AUTO_INCREMENT,
PRIMARY KEY (c1))
ENGINE=sequoiadb;
INSERT INTO t1 VALUES (2);
INSERT INTO t1 VALUES (4);
SET INSERT_ID = 30;
INSERT INTO t1 VALUES (NULL);
SELECT * FROM t1 ORDER BY c1;
c1
2
4
30
SET INSERT_ID = -1;
Warnings:
Warning	1292	Truncated incorrect insert_id value: '-1'
INSERT INTO t1 VALUES (NULL);
SELECT * FROM t1 ORDER BY c1;
c1
2
4
30
31
SET INSERT_ID = 0;
INSERT INTO t1 VALUES (NULL);
SELECT * FROM t1 ORDER BY c1;
c1
2
4
30
31
32
SET INSERT_ID = 2147483647;
INSERT INTO t1 VALUES (NULL);
SELECT * FROM t1 ORDER BY c1;
c1
2
4
30
31
32
2147483647
SET INSERT_ID = 2147483648;
INSERT INTO t1 VALUES (NULL);
ERROR 22003: Out of range value for column 'c1' at row 1
SELECT * FROM t1 ORDER BY c1;
c1
2
4
30
31
32
2147483647
DROP TABLE t1;
CREATE TABLE t1(a INT AUTO_INCREMENT KEY)COMMENT='sequoiadb:{auto_partition:false}';
INSERT INTO t1 VALUES(),(),();
SELECT * FROM t1;
a
1
2
3
ALTER TABLE t1 AUTO_INCREMENT = 2002;
INSERT INTO t1 VALUES(),(),();
SELECT * FROM t1;
a
1
2
3
2002
2003
2004
ALTER TABLE t1 CHANGE a col1 INT AUTO_INCREMENT;
INSERT INTO t1 VALUES(),(),();
SELECT * FROM t1;
col1
1
2
3
2002
2003
2004
3002
3003
3004
DROP TABLE t1;
DROP DATABASE test_auto_increment;
