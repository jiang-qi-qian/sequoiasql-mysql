#Case 18020#Case 18021#Case 18022#Case 18023#Case 18024#Case 18025#Case 18026#Case 18027#Case 18028
#Case 18038#Case 18039#Case 18040#Case 18041#Case 18042#Case 18657#Case 18658#Case 18660#Case 19442
#Case 19420#Case 19421#Case 19422#Case 19423#Case 19424#Case 19425#Case 19428#Case 19429#Case 19430
#Case 19431#Case 19432#Case 19433#Case 22788

--source include/have_sequoiadb.inc
create database test_alter_overhead_threshlod;
use test_alter_overhead_threshlod;
--disable_query_log
create table reserved(a int primary key)ENGINE=sequoiadb COMMENT='sequoiadb:{ auto_partition: true }';
--enable_query_log

#Case 19411#Case 19412
create table t1(id int auto_increment key, a int, b int, c int);
insert into t1(a, b, c) values(1,1,1),(2,2,2),(3,3,3),(4,4,4),(5,5,5),(6,6,6),(7,7,7),(8,8,8),(9,9,9),(10,10,10);
ALTER TABLE t1 ADD d int FIRST,algorithm = inplace;
ALTER TABLE t1 ADD e int after a, algorithm = inplace;
show create table t1;
insert into t1(a, b, c, d, e) values(11,11,11,11,11);
select * from t1 order by id;
ALTER TABLE t1 ADD (f int, g int), algorithm = inplace;
insert into t1(a, b, c, d, e, f, g) values(12,12,12,12,12,12,12);
select * from t1 order by id;

#Case 19426
--error 131
alter table t1 drop column g, algorithm = inplace;
show create table t1;
insert into t1(a, b, c, d, e, f, g) values(13,13,13,13,13,13, 13);
select * from t1 order by id;
drop table t1;

#Case 19413
set sql_mode = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION';
create table t1(id int auto_increment key);
insert into t1 values(),(),(),(),(),(),(),(),(),();
--error 131
ALTER TABLE t1 ADD (col1 int NOT NULL, col2 float NOT NULL, col3 decimal(10,2) NOT NULL, col4 bit(2) NOT NULL, col8 time NOT NULL, col9 year NOT NULL, col10 char NOT NULL, col11 varchar(255) NOT NULL, col12 binary NOT NULL, col13 varbinary(255) NOT NULL, col14 text NOT NULL, col15 blob NOT NULL, col16 enum('one', 'two', 'three') NOT NULL, col17 set('one', 'two', 'three') NOT NULL, col18 json NOT NULL), algorithm = inplace;
--error 131
alter table t1 ADD(col5 date NOT NULL),algorithm = inplace;
--error 131
alter table t1 ADD(col6 datetime NOT NULL),algorithm = inplace;
-- error 1846
alter table t1 ADD(col7 timestamp NOT NULL),algorithm = inplace;
show create table t1;
set sql_mode = default;
drop table t1;

#BUG #SEQUOIASQLMAINSTREAM-595
#Case 19414
create table t1(id int auto_increment key);
insert into t1 values(),(),(),(),(),(),(),(),(),();
--error 131
ALTER TABLE t1 ADD (col1 int NOT NULL default 100, col2 float NOT NULL default 100.2, col3 decimal(10,2) NOT NULL default 30.23, col4 bit(2) NOT NULL default 2, col5 date NOT NULL default '2019-09-21', col6 datetime NOT NULL default '2019-09-21 11:06:31', col7 timestamp NOT NULL default '2019-09-21 11:06:31', col8 time NOT NULL default '11:04:31', col9 year NOT NULL default 2019, col10 char(255) NOT NULL default 'char', col11 varchar(255) NOT NULL default 'varchar', col12 binary(255) NOT NULL default 'binary', col13 varbinary(255) NOT NULL default 'varbinary', col16 enum('one', 'two', 'three') NOT NULL default 'three', col17 set('one', 'two', 'three') NOT NULL default 'two'), algorithm = inplace;
--error 131
ALTER TABLE t1 ADD (col1 int default 100, col2 float default 100.2, col3 decimal(10,2) default 30.23, col4 bit(2) default 2, col5 date default '2019-09-21', col6 datetime default '2019-09-21 11:06:31', col7 timestamp default '2019-09-21 11:06:31', col8 time default '11:04:31', col9 year default 2019, col10 char(255) default 'char', col11 varchar(255) default 'varchar', col12 binary(255) default 'binary', col13 varbinary(255) default 'varbinary', col16 enum('one', 'two', 'three') default 'three', col17 set('one', 'two', 'three') default 'two'), algorithm = inplace;
show create table t1;
select * from t1 order by id;
drop table t1;

#Case 19415#Case 19416#Case 19417
create table t1(id int);
insert into t1 values(1), (2), (3), (4), (5), (6), (7), (8), (9), (10);
--error 1845
ALTER TABLE t1 ADD (col1 int AUTO_INCREMENT KEY), algorithm = inplace;
--error 1845
ALTER TABLE t1 ADD (col1 int AUTO_INCREMENT, primary key(id, col1)), algorithm = inplace;
--error 1845
ALTER TABLE t1 ADD (col1 int AUTO_INCREMENT UNIQUE KEY), algorithm = inplace;
--error 1845
ALTER TABLE t1 ADD (col1 int AUTO_INCREMENT, unique key(id, col1)), algorithm = inplace;
--error 1845
ALTER TABLE t1 ADD (col1 int AUTO_INCREMENT, index(col1)), algorithm = inplace;
--error 1845
ALTER TABLE t1 ADD (col1 int AUTO_INCREMENT, index(id, col1)), algorithm = inplace;
show create table t1;
drop table t1;

#Case #19418
create table t2(id int AUTO_INCREMENT KEY);
create table t1(id int AUTO_INCREMENT KEY);
insert into t1() values(), (), (), (), (), (), (), (), (), ();
# MariaDB not support COLUMN_FORMAT and STORAGE
#ALTER TABLE t1 ADD (col1 varchar(255) COMMENT 'string' COLLATE utf8_bin COLUMN_FORMAT FIXED STORAGE MEMORY,col2 int, foreign key (col2) references t2(id)), algorithm = inplace;
ALTER TABLE t1 ADD (col1 varchar(255) COMMENT 'string' COLLATE utf8_bin, col2 int, foreign key (col2) references t2(id)), algorithm = inplace;
show create table t1;
insert into t1(col1, col2) values('string1', 100);
select * from t1 order by id;
--error 131
ALTER TABLE t1 DROP col1, algorithm = inplace;
--error 131
ALTER TABLE t1 DROP col2, algorithm = inplace;
show create table t1;
drop table t1,t2;

# InnoDB not support add check constraint with algorithm = inplace
##Case 19419
#create table t1(id int AUTO_INCREMENT KEY);
#insert into t1() values(), (), (), (), (), (), (), (), (), ();
#ALTER TABLE t1 ADD (col1 int),ADD CHECK (col1 <50), algorithm = inplace;
#ALTER TABLE t1 ADD CHECK (id <100), algorithm = inplace;
#show create table t1;
#insert into t1 values();
#select * from t1 order by id;
#drop table t1;

#Case 19394
create table t1(id int, col1 int AUTO_INCREMENT unique key);
insert into t1(id) values(1), (2), (3), (4), (5), (6), (7), (8), (9), (10);
show create table t1;
select * from t1 order by id;
#SEQUOIASQLMAINSTREAM-410
--error 131
ALTER TABLE t1 DROP col1, algorithm = inplace;
show create table t1;
drop table t1;

#Case 19420 
create table t1 ( id int auto_increment primary key, a tinyint default 1, b smallint default 1, c int default 1, d bigint default 1 );
insert into t1 values (),(),(),(),(),(),(),(),(),();
insert into t1(a,b,c,d) values (2,3,4,5), (6,7,8,9), (10,11,12,13);
insert into t1 values (),(),(),(),();
select * from t1 order by id;
alter table t1 change a a tinyint default -10, algorithm=inplace;
alter table t1 change b b smallint default -10, algorithm=inplace;
alter table t1 change c c int default -10, algorithm=inplace;
alter table t1 change d d bigint default -10, algorithm=inplace;
show create table t1;
insert into t1 values (),(),(),(),();
insert into t1(a,b,c,d) values (-10,-10,-10,-10), (1,1,1,1);
insert into t1 values ();
select * from t1 order by id;
alter table t1 modify a tinyint, algorithm=inplace;
alter table t1 modify b smallint, algorithm=inplace;
alter table t1 modify c int, algorithm=inplace;
alter table t1 modify d bigint, algorithm=inplace;
show create table t1;
insert into t1(a,b,c,d) values (-10,-10,-10,-10), (1,1,1,1);
insert into t1 values ();
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, a char(10) default 'a', b varchar(10) default 'a', c binary(8) default 'a', d varbinary(8) );
insert into t1 values (),(),(),(),(),(),(),(),(),();
insert into t1(a,b,c,d) values ('bcdef','bcdef','bcdef','bcdef'), ('opqrst','opqrst','opqrst','opqrst');
insert into t1 values (),(),(),(),();
select * from t1 order by id;
alter table t1 change a a char(10) default '#!*()', algorithm=inplace;
alter table t1 change b b varchar(10) default -1, algorithm=inplace;
alter table t1 change c c binary(8) default '#!*()', algorithm=inplace;
alter table t1 change d d varbinary(8) default -1, algorithm=inplace;
show create table t1;
insert into t1 values (),(),(),(),();
insert into t1(a,b,c,d) values ('#!*()', -1, '#!*()', -1), ('a', 'a', 'a', 'a');
insert into t1 values ();
select * from t1 order by id;
alter table t1 modify a char(10), algorithm=inplace;
alter table t1 modify b varchar(10), algorithm=inplace;
alter table t1 modify c binary(8), algorithm=inplace;
alter table t1 modify d varbinary(8), algorithm=inplace;
show create table t1;
insert into t1(a,b,c,d) values ('#!*()', -1, '#!*()', -1), ('a', 'a', 'a', 'a');
insert into t1 values ();
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, a float default 1.0001, b double default 1.0001, c decimal default 1.0001 );
insert into t1 values (),(),(),(),(),(),(),(),(),();
insert into t1(a,b,c) values (1e1, 1e1, 1e1), (123.23E+02, 123.23E+02, 123.23E+02);
insert into t1 values (),(),(),();
select * from t1 order by id;
alter table t1 change a a float default 6e-16, algorithm=inplace;
alter table t1 change b b double default 6e-16, algorithm=inplace;
alter table t1 change c c decimal default 6e-16, algorithm=inplace;
show create table t1;
insert into t1 values (),(),(),();
insert into t1(a,b,c) values (6e-16, 6e-16, 6e-16), (1.0001, 1.0001, 1.0001);
insert into t1 values ();
select * from t1 order by id;
alter table t1 modify a float, algorithm=inplace;
alter table t1 modify b double, algorithm=inplace;
alter table t1 modify c decimal, algorithm=inplace;
show create table t1;
insert into t1 values (),(),(),();
insert into t1(a,b,c) values (6e-16, 6e-16, 6e-16), (1.0001, 1.0001, 1.0001);
insert into t1 values ();
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, a year default 1999, b date default '2030-12-14', c time default '01:01:01', d datetime default CURRENT_TIMESTAMP, e timestamp default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP);
insert into t1 values (),(),(),(),(),(),(),(),(),();
insert into t1(a,b,c,d,e) values(2000, "2002-03-04",'09:00:00','2003-03-01 00:00:00', "19990102030405"), (2001, "2002-03-05",'10:11:00','2004-04-01 00:00:00', "2004-12-31 23:59:59");
insert into t1 values (),(),(),();
--replace_column 5 x 6 x
select * from t1 order by id;
alter table t1 change a a year default 2056, algorithm=inplace;
alter table t1 change b b date default "2019-01-01", algorithm=inplace;
alter table t1 change c c time default '00:00:00', algorithm=inplace;
alter table t1 change d d datetime default '9999-12-31 00:00:00', algorithm=inplace;
alter table t1 change e e timestamp default "19990102030405", algorithm=inplace;
show create table t1;
insert into t1 values (),(),(),();
insert into t1(a,b,c,d,e) values(2000, "2002-03-04",'09:00:00','2003-03-01 00:00:00', "19990102030405"), (2001, "2002-03-05",'10:11:00','2004-04-01 00:00:00', "2004-12-31 23:59:59");
insert into t1 values ();
--replace_column 5 x 6 x
select * from t1 order by id;
alter table t1 modify a year default 1999, algorithm=inplace;
alter table t1 modify d datetime default CURRENT_TIMESTAMP, algorithm=inplace;
alter table t1 modify e timestamp default CURRENT_TIMESTAMP, algorithm=inplace;
show create table t1;
insert into t1 values ();
--replace_column 5 x 6 x
select * from t1 order by id;
alter table t1 modify a year, algorithm=inplace;
alter table t1 modify b date, algorithm=inplace;
alter table t1 modify c time, algorithm=inplace;
alter table t1 modify d datetime, algorithm=inplace;
alter table t1 modify e timestamp, algorithm=inplace;
show create table t1;
insert into t1 values ();
insert into t1(a,b,c,d,e) values(2020, "2020-02-02",'10:00:00','2020-02-10 00:00:00', "19990102030405"), (2021, "2021-1-02",'10:11:00','2020-03-01 00:00:00', "2021-12-31 23:59:59");
--replace_column 5 x 6 x
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, a bit(8) default 1, b bool default false, c enum('a','c','d') default 'd', d set('a','b','c','d','e') default 'a,b,e');
insert into t1 values (),(),(),(),(),(),(),(),(),();
insert into t1(a,b,c,d) values (1, true, 'a', 'a,b'), (2, true, 'c', 'b,c'), (3, false, 'd', 'a,b,e');
insert into t1 values (),(),(),();
select * from t1 order by id;
alter table t1 change a a bit(8) default 7, algorithm=inplace;
alter table t1 change b b bool default false, algorithm=inplace;
alter table t1 change c c enum('a','c','d') default 'a', algorithm=inplace;
alter table t1 change d d set('a','b','c','d','e') default 'b,a,e', algorithm=inplace;
show create table t1;
insert into t1 values ();
insert into t1(a,b,c,d) values (1, false, 'a', 'b,c'), (7, true, 'c', 'b,a,e');
select * from t1 order by id;
alter table t1 modify a bit(8), algorithm=inplace;
alter table t1 modify b bool, algorithm=inplace;
alter table t1 modify c enum('a','c','d'), algorithm=inplace;
alter table t1 modify d set('a','b','c','d','e'), algorithm=inplace;
show create table t1;
insert into t1 values ();
insert into t1(a,b,c,d) values (1, false, 'a', 'b,c'), (7, true, 'c', 'b,a,e');
select * from t1 order by id;
drop table t1;

#Case 19421
create table t1 ( id int auto_increment primary key, a tinyint, b smallint, c int, d bigint );
insert into t1(a,b,c,d) values (2,2,2,2),(3,3,3,3), (5,5,5,5), (9,9,9,9), (4,4,4,4), (7,7,7,7), (10,10,10,10), (17,17,17,17),(21,21,21,21);
select * from t1 order by id;
#Bug #SEQUOIASQLMAINSTREAM-749
alter table t1 change a a tinyint not null, algorithm=inplace;
alter table t1 change b b smallint not null, algorithm=inplace;
alter table t1 change c c int not null, algorithm=inplace;
alter table t1 change d d bigint not null, algorithm=inplace;
show create table t1;
insert into t1(a,b,c,d) values (-10,-10,-10,-10), (1,1,1,1);
select * from t1 order by id;
alter table t1 modify a tinyint, algorithm=inplace;
alter table t1 modify b smallint, algorithm=inplace;
alter table t1 modify c int, algorithm=inplace;
alter table t1 modify d bigint, algorithm=inplace;
show create table t1;
insert into t1(a,b,c,d) values (-10,-10,-10,-10), (1,1,1,1), (-101,-101,-101,-101);
insert into t1 values (),();
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, a char(10), b varchar(10), c binary(8), d varbinary(8) );
insert into t1(a,b,c,d) values ('bcdef','bcdef','bcdef','bcdef'),('opqrst','opqrst','opqrst','opqrst'), ('xyo', 'xyo', 'xyo', 'xyo'), ('bibubibu', 'bibubibu','bibubibu', 'bibubibu'), ('aaa', 'aaa', 'aaa', 'aaa'), ('ccc', 'ccc', 'ccc', 'ccc');
select * from t1 order by id;
#Bug #SEQUOIASQLMAINSTREAM-749
alter table t1 change a a char(10) not null, algorithm=inplace;
alter table t1 change b b varchar(10) not null, algorithm=inplace;
alter table t1 change c c binary(8) not null, algorithm=inplace;
alter table t1 change d d varbinary(8) not null, algorithm=inplace;
show create table t1;
insert into t1(a,b,c,d) values ('a', 'a', 'a', 'a'),('b', 'b', 'b', 'b'),('c', 'c', 'c', 'c'), ('#!*()', -1, '#!*()', -1);
select * from t1 order by id;
alter table t1 modify a char(10), algorithm=inplace;
alter table t1 modify b varchar(10), algorithm=inplace;
alter table t1 modify c binary(8), algorithm=inplace;
alter table t1 modify d varbinary(8), algorithm=inplace;
show create table t1;
insert into t1(a,b,c,d) values ('#!*()', -1, '#!*()', -1), (NULL,NULL,NULL,NULL), ('a', 'a', 'a', 'a');
insert into t1 values ();
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, a tinytext, b mediumtext, c text, d longtext );
insert into t1(a,b,c,d) values ('bcdef','bcdef','bcdef','bcdef'), ('opqrst','opqrst','opqrst','opqrst'), ('xyo', 'xyo', 'xyo', 'xyo'), ('bibubibu', 'bibubibu','bibubibu', 'bibubibu'), ('aaa', 'aaa', 'aaa', 'aaa'), ('ccc', 'ccc', 'ccc', 'ccc');
select * from t1 order by id;
#Bug #SEQUOIASQLMAINSTREAM-749
alter table t1 change a a tinytext not null, algorithm=inplace;
alter table t1 change b b mediumtext not null, algorithm=inplace;
alter table t1 change c c text not null, algorithm=inplace;
alter table t1 change d d longtext not null, algorithm=inplace;
show create table t1;
insert into t1(a,b,c,d) values ('a', 'a', 'a', 'a'),('b', 'b', 'b', 'b'),('c', 'c', 'c', 'c'), ('#!*()', -1, '#!*()', -1);
select * from t1 order by id;
alter table t1 modify a tinytext, algorithm=inplace;
alter table t1 modify b mediumtext, algorithm=inplace;
alter table t1 modify c text, algorithm=inplace;
alter table t1 modify d longtext, algorithm=inplace;
show create table t1;
insert into t1(a,b,c,d) values ('#!*()', -1, '#!*()', -1), (NULL,NULL,NULL,NULL), ('a', 'a', 'a', 'a');
insert into t1 values ();
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, a tinyblob, b mediumblob, c blob, d longblob );
insert into t1(a,b,c,d) values ('bcdef','bcdef','bcdef','bcdef'), ('opqrst','opqrst','opqrst','opqrst'), ('xyo', 'xyo', 'xyo', 'xyo'), ('bibubibu', 'bibubibu','bibubibu', 'bibubibu'), ('aaa', 'aaa', 'aaa', 'aaa'), ('ccc', 'ccc', 'ccc', 'ccc');
select * from t1 order by id;
#Bug #SEQUOIASQLMAINSTREAM-749
alter table t1 change a a tinyblob not null, algorithm=inplace;
alter table t1 change b b mediumblob not null, algorithm=inplace;
alter table t1 change c c blob not null, algorithm=inplace;
alter table t1 change d d longblob not null, algorithm=inplace;
show create table t1;
insert into t1(a,b,c,d) values ('a', 'a', 'a', 'a'),('b', 'b', 'b', 'b'),('c', 'c', 'c', 'c'), ('#!*()', -1, '#!*()', -1);
select * from t1 order by id;
alter table t1 modify a tinyblob, algorithm=inplace;
alter table t1 modify b mediumblob, algorithm=inplace;
alter table t1 modify c blob, algorithm=inplace;
alter table t1 modify d longblob, algorithm=inplace;
show create table t1;
insert into t1(a,b,c,d) values ('#!*()', -1, '#!*()', -1), (NULL,NULL,NULL,NULL), ('a', 'a', 'a', 'a');
insert into t1 values ();
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, a float, b double, c decimal );
insert into t1(a,b,c) values (1e1, 1e1, 1e1),(123.23E+02, 123.23E+02, 123.23E+02),(2e2, 2e2, 2e2),(123.333,123.333,123.333),(8E+01,8E+01,8E+01),(5e-5,5e-5,5e-5);
select * from t1 order by id;
#Bug #SEQUOIASQLMAINSTREAM-749
alter table t1 change a a float not null, algorithm=inplace;
alter table t1 change b b double not null, algorithm=inplace;
alter table t1 change c c decimal not null, algorithm=inplace;
show create table t1;
insert into t1(a,b,c) values (6e-16, 6e-16, 6e-16), (1.0001, 1.0001, 1.0001);
select * from t1 order by id;
alter table t1 modify a float, algorithm=inplace;
alter table t1 modify b double, algorithm=inplace;
alter table t1 modify c decimal, algorithm=inplace;
show create table t1;
insert into t1(a,b,c) values (6e-16, 6e-16, 6e-16), (NULL,NULL,NULL), (1.0001, 1.0001, 1.0001);
insert into t1 values ();
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, a year, b date, c time, d datetime, e timestamp);
insert into t1(a,b,c,d,e) values (2000, "2002-03-04",'09:00:00','2003-03-01 00:00:00', "19990102030405"), (2001, "2002-03-05",'10:11:00','2004-04-01 00:00:00', "2004-12-31 23:59:59"), (2002, current_date, current_time, current_timestamp, current_timestamp) ,(1999, "2019-01-10",'10:10:10','2019-01-11 00:00:00', "19990102030407"),(1998, "2012-05-10",'11:11:11','2012-04-01 00:00:00',"2012-04-01 00:00:00"), (2020, "2020-12-10",'11:11:11','2030-11-01 00:00:00',"2020-04-01 23:59:59");
# when sql_mode=NO_ZERO_DATE,NO_ZERO_IN_DATE, date and datetime errno is 1845; timestamp will never return error, because timestamp never null
set sql_mode='NO_ZERO_DATE,NO_ZERO_IN_DATE';
#Bug #SEQUOIASQLMAINSTREAM-749
--error 131
alter table t1 change a a year not null, algorithm=inplace;
--error 1845
alter table t1 change b b date not null, algorithm=inplace;
#Bug #SEQUOIASQLMAINSTREAM-749
--error 131
alter table t1 change c c time not null, algorithm=inplace;
--error 1845
alter table t1 change d d datetime not null, algorithm=inplace;
alter table t1 change e e timestamp not null, algorithm=inplace;
show create table t1;
insert into t1(a,b,c,d,e) values(2000, "2002-03-04",'09:00:00','2003-03-01 00:00:00', "19990102030405"), (2001, "2002-03-05",'10:11:00','2004-04-01 00:00:00', "2004-12-31 23:59:59");
alter table t1 modify a year, algorithm=inplace;
alter table t1 modify b date, algorithm=inplace;
alter table t1 modify c time, algorithm=inplace;
alter table t1 modify d datetime default CURRENT_TIMESTAMP, algorithm=inplace;
alter table t1 modify e timestamp default CURRENT_TIMESTAMP, algorithm=inplace;
insert into t1 values ();
alter table t1 modify a year, algorithm=inplace;
alter table t1 modify b date, algorithm=inplace;
alter table t1 modify c time, algorithm=inplace;
alter table t1 modify d datetime, algorithm=inplace;
alter table t1 modify e timestamp, algorithm=inplace;
show create table t1;
insert into t1(a,b,c,d,e) values(2020, "2020-02-02",'10:00:00','2020-02-10 00:00:00', "19990102030405"), (NULL,NULL,NULL,NULL,NULL), (2021, "2021-1-02",'10:11:00','2020-03-01 00:00:00', "2021-12-31 23:59:59");
drop table t1;
set sql_mode=default;

create table t1 ( id int auto_increment primary key, a bit(8), b bool, c enum('a','c','d'), d set('a','b','c','d','e'));
insert into t1(a,b,c,d) values (1, true, 'a', 'a,b'), (2, true, 'c', 'b,c'), (3, false, 'd', 'a,b,e'), (6, false, 'c', 'a,e'), (5, false, 'a', 'b,c'), (4, true, 'c', 'd' );
select * from t1 order by id;
#Bug #SEQUOIASQLMAINSTREAM-749
alter table t1 change a a bit(8) not null, algorithm=inplace;
alter table t1 change b b bool not null, algorithm=inplace;
alter table t1 change c c enum('a','c','d') not null, algorithm=inplace;
alter table t1 change d d set('a','b','c','d','e') not null, algorithm=inplace;
show create table t1;
insert into t1(a,b,c,d) values (1, false, 'a', 'b,c'), (7, true, 'c', 'b,a,e');
select * from t1 order by id;
alter table t1 modify a bit(8), algorithm=inplace;
alter table t1 modify b bool, algorithm=inplace;
alter table t1 modify c enum('a','c','d'), algorithm=inplace;
alter table t1 modify d set('a','b','c','d','e'), algorithm=inplace;
show create table t1;
insert into t1(a,b,c,d) values (1, false, 'a', 'b,c'), (7, true, 'c', 'b,a,e');
insert into t1 values (),();
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, a json );
insert into t1(a) values ('{"a": 2}'), ('[1,2]'), ('{"a":"b", "c":"d","ab":"abc", "bc": ["x", "y"]}'), ('["here", ["I", "am"], "!!!"]'),('"scalar string"'),('123456');
select * from t1 order by id;
#Bug #SEQUOIASQLMAINSTREAM-749
alter table t1 change a a json not null, algorithm=inplace;
show create table t1;
insert into t1(a) values ('-32768'),('2147483647'),('18446744073709551616');
select * from t1 order by id;
alter table t1 change a a json, algorithm=inplace;
show create table t1;
insert into t1(a) values (NULL), ('"scalar string"');
insert into t1 values ();
select * from t1 order by id;
drop table t1;

#Case 19422 #Case 19423 
#BUG #SEQUOIASQLMAINSTREAM-434
#create table t1 ( a tinyint, b smallint, c int, d bigint, primary key(a), unique key (b), key(c,d) );
#insert into t1 values (1,1,1,1),(3,3,3,3),(7,7,7,7),(10,10,10,10),(2,2,2,2),(8,8,8,8),(13,13,13,13),(20,20,20,20),(16,16,16,16),(17,17,17,17);
#alter table t1 change a a tinyint auto_increment, algorithm=inplace;
#show create table t1; 
#insert into t1(b,c,d) values (9,9,9), (21,21,21), (5,5,5);
#select * from t1 order by a;
#alter table t1 change a a tinyint, algorithm=inplace;
#insert into t1 values (25,25,25,25);
#alter table t1 change b b smallint auto_increment, algorithm=inplace;
#show create table t1; 
#insert into t1(a,c,d) values (30,30,30), (35,35,35);
#select * from t1 order by a;
#alter table t1 change b b smallint, algorithm=inplace;
#show create table t1; 
#insert into t1 values (32,32,32,32);
#select * from t1 order by a;
#alter table t1 change c c int auto_increment, algorithm=inplace;
#show create table t1; 
#insert into t1(a,b,d) values (40,40,40), (45,45,45);
#select * from t1 order by a;
#drop table t1; 

#Case 19424 
#create table t1 ( a bigint primary key, b float unique key storage disk, c char(16) column_format dynamic, d text charset gbk, e binary comment "I am binary")COMMENT='sequoiadb:{ auto_partition: false }';
create table t1 ( a bigint primary key, b float unique key, c char(16), d text charset gbk, e binary comment "I am binary") COMMENT='sequoiadb:{ auto_partition: false }';
create table t2 ( id int primary key, a bigint, b float, foreign key(a) references t1(a) match full on delete RESTRICT );
show create table t1; 
show create table t2; 
insert into t1 values (1,123.456,'abc','abc','a'), (10,12495.495,'aaa','aaa','1'),(55,539.32,'123','123','c'),(21,10.34,'Boe','Boe','A'),(0,348.39,'bbb','bbb','t'), (16,439.543, '43ls', '43ls', 'r');
insert into t2 values (1, 1, 123.456), (10, 10, 12495.495), (55, 55, 539.32), (21, 21, 10.34),(0, 0, 348.39), (16, 16, 439.543);
select * from t1 order by a;
select * from t2 order by id; 
alter table t2 drop foreign key t2_ibfk_1, algorithm = inplace;
alter table t2 add foreign key (b) references t1(b) match PARTIAL on UPDATE CASCADE, algorithm = inplace;
##BUG #SEQUOIASQLMAINSTREAM-408
#alter table t1 change b b float, algorithm = inplace;
#alter table t1 change c c char(16) character set gbk column_format fixed comment "I am char", algorithm = inplace;
#alter table t1 change d d text character set utf8 collate utf8_bin, algorithm = inplace;
#alter table t1 modify e binary, algorithm = inplace;
##BUG #SEQUOIASQLMAINSTREAM-408
#alter table t2 modify id int storage memory, algorithm = inplace;
show create table t1;
show create table t2;
insert into t1 values (-12,23.3,'43kd','43kd','0'), (-3,543.543,'gfd8','gfd8','1'),(-1,30.32,'kgf9','kgf9','2');
insert into t2 values (5, 5, 23.3), (2, 2, 543.543), (-19, -19, 30.32);
select * from t1 order by a;
select * from t2 order by id; 
drop table t2,t1;

#Case 19425 
create table t1 ( a int primary key, b bigint, c char(16) );
show create table t1; 
insert into t1 values (1, 1, 'a'), (10, 10, '1'), (-1, -1, '2d'), (8, 8, '4c'), (101, 101, 'BaC'), (2, 2, 'gkdel');
select * from t1 order by a; 
alter table t1 change a a int after b, algorithm = inplace;
alter table t1 modify c char(16) first, algorithm = inplace;
show create table t1; 
insert into t1 values ('o', 3, 3), ('p', -8, -8), ('A', 5, 5); 
select * from t1 order by a;
drop table t1;

#Case 19428 
create table t1 ( id int primary key, name char(8) );
show create table t1; 
insert into t1 values (1,'a'), (-1,'b'), (10, '12'), (0, 'Ab'), (1001, 'Test'), (103, 'hello');
#BUG #SEQUOIASQLMAINSTREAM-412
alter table t1 force, algorithm = inplace;
show create table t1; 
insert into t1 values (4,'1'), (2,'0');
select * from t1 order by id; 
drop table t1;

#Case 19430 #Case 19431 
create table t1 ( id int auto_increment primary key, a enum('b','a','z'), b set('1', 'a', 'c', '2', 'k', 'y', 'x') );
insert into t1(a,b) values ('a','k,y'), ('b', '1,2,x'), ('z', 'k,c'), ('b', 'k,y,2,a'), ('a', 'x,y'), ('z', 'a,x,k,1');
#BUG #SEQUOIASQLMAINSTREAM-413
--error 1846
alter table t1 change a a enum('1','a'), algorithm=inplace;
--error 1846
alter table t1 change a a enum('b'), algorithm=inplace;
show create table t1;
--error 1846
alter table t1 change a a enum('b','c','z'), algorithm = inplace;
show create table t1; 
--error 1846
alter table t1 change a a enum('1','b','c','z'), algorithm = inplace;
show create table t1; 
#BUG #SEQUOIASQLMAINSTREAM-413
--error 1846
alter table t1 change b b set('1','a','c','k'), algorithm = inplace;
show create table t1; 
--error 1846
alter table t1 change b b set('0', '1', 'a', 'c', '2', 'k', 'y', 'x'), algorithm = inplace;
show create table t1; 
alter table t1 change a a enum('b','a','z','x','1','c'), algorithm = inplace;
alter table t1 change b b set('1', 'a', 'c', '2', 'k', 'y', 'x','m','n','0'), algorithm = inplace;
show create table t1; 
insert into t1(a,b) values ('a', 'x,y'), ('x', '1,a'), ('1', 'c,k'), ('c', 'y,2'), ('1', '1,a,x,m,0'), ('c', 'k,y,x,m,n,0');
select * from t1 order by id;
drop table t1; 

#Case 19432 
create table t1 ( id tinyint primary key );
insert into t1 values (1), (-1), (0), (8), (18), (101), (22), (127), (-128);
alter table t1 change id id smallint, algorithm=inplace;
show create table t1;
insert into t1 values (-32768), (32767);
select * from t1 order by id;
alter table t1 change id id mediumint, algorithm=inplace;
show create table t1;
insert into t1 values (8388607), (-8388608);
select * from t1 order by id;
alter table t1 change id id int, algorithm=inplace;
show create table t1; 
insert into t1 values (-2147483648), (2147483647);
select * from t1 order by id;
alter table t1 change id id bigint, algorithm=inplace;
show create table t1;
insert into t1 values (9223372036854775807), (-9223372036854775808);
select * from t1 order by id;
drop table t1;

create table t1 ( id tinyint primary key, i1 tinyint, i2 tinyint, s1 smallint, s2 smallint, s3 smallint );
insert into t1 values (1,1,1,1,1,1), (-1,-1,-1,-1,-1,-1), (0,0,0,0,0,0), (8,8,8,8,8,8), (18,18,18,18,18,18), (101,101,101,101,101,101), (22,22,22,22,22,22), (127,127,127,32767,32767,32767), (-128,-128,-128,-32768,-32768,-32768);
alter table t1 change id id float(4,1), algorithm=inplace; 
alter table t1 modify i1 double, algorithm=inplace;
alter table t1 modify i2 decimal(6,3), algorithm=inplace;
alter table t1 change s1 s1 float(7,2), algorithm=inplace;
alter table t1 modify s2 double, algorithm=inplace; 
alter table t1 modify s3 decimal(5,0), algorithm=inplace;
show create table t1;
insert into t1 values (1.1000000000000001,1.1000000000000001,1.1000000000000001,1.1000000000000001,1.1000000000000001,1.1000000000000001),(10.48,10.48E+03,10.48,10.48,10.48E+03,10.48E+03); 
select * from t1 order by id;
drop table t1;

create table t1 ( id mediumint primary key, m1 mediumint, m2 mediumint, b1 bigint, b2 bigint, b3 bigint );
insert into t1 values (1,1,1,1,1,1), (-1,-1,-1,-1,-1,-1), (0,0,0,0,0,0), (8,8,8,8,8,8), (18,18,18,18,18,18), (101,101,101,101,101,101), (22,22,22,22,22,22),(8388607,8388607,8388607,9223372036854775807,9223372036854775807,9223372036854775807), (-8388608,-8388608,-8388608,-9223372036854775808,-9223372036854775808,-9223372036854775808);
#BUG #SEQUOIASQLMAINSTREAM-417
--error 1846 
alter table t1 change id id float(9,1), algorithm=inplace;
alter table t1 modify m1 double, algorithm=inplace;
alter table t1 modify m2 decimal, algorithm=inplace;
#BUG #SEQUOIASQLMAINSTREAM-417
--error 1846
alter table t1 change b1 b1 float(53,20), algorithm=inplace;
--error 1846
alter table t1 modify b2 double(21,2), algorithm=inplace;
alter table t1 modify b3 decimal(52,30), algorithm=inplace;
show create table t1;
insert into t1 values (5830,5830,5830,85039430942,85039430942,85039430942), (-683904,-683904,-683904,-5792293719,-5792293719,-5792293719);
select * from t1 order by id; 
drop table t1;

create table t1 ( id int primary key, i1 int, i2 int );
insert into t1 values (1,1,1),(-1,-1,-1),(0,0,0),(8,8,8),(18,18,18),(101,101,101),(22,22,22),(-2147483648,-2147483648,-2147483648),(2147483647,2147483647,2147483647);
#BUG #SEQUOIASQLMAINSTREAM-417
--error 1846
alter table t1 change id id float(12,1), algorithm=inplace;
alter table t1 modify i1 double, algorithm=inplace;
alter table t1 modify i2 decimal(11,1), algorithm=inplace;
show create table t1;
insert into t1 values (5830,5830,5830),(85039430,85039430,85039430),(-683904,-683904,-683904),(-57922937,-57922937,-57922937);
select * from t1 order by id;
drop table t1;

create table t1 ( id float primary key, f1 float(24,2), f2 float(11,2), f3 float(2,0), f4 float(3,0), f5 float(4,0), f6 float(5,0), f7 float(6,0), f8 float(7,0), f9 float(9,0), f10 float(10,0), f11 float(18,0), f12 float(19,0) );
insert into t1 values (-3.402823466E+38,-3402823466.0,-34028235.01,9,9,9,9,9,9,9,9,9,9);
insert into t1 values (0.1111111,0.1111111,0.1111111,10,101,101,101,101,101,101,101,101,101);
insert into t1 values (1234.56789,1234.56789,1234.56789,11,111,111,111,111,111,111,111,111,111);
insert into t1 values (-1.175494351E-38,-117549435.0,-117549435.01,99,99,99,99,99,99,99,99,99,99);
insert into t1 values (3.402823466351E+38, 3402823466.0, 34028267.35,1,1,1,1,1,1,1,1,1,1);
insert into t1 values (68940E+30, 4823348320.2, 3180553.12,0,0,0,0,0,0,0,0,0,0);
#BUG #SEQUOIASQLMAINSTREAM-419
--error 1846
alter table t1 modify f1 float(24,3), algorithm=inplace;
alter table t1 modify f1 float(26,3), algorithm=inplace;
#BUG #SEQUOIASQLMAINSTREAM-420
alter table t1 modify f2 decimal(20,2), algorithm=inplace;
#BUG #SEQUOIASQLMAINSTREAM-424
--error 1846
alter table t1 change f3 f3 bit(8), algorithm=inplace;
--error 1846
alter table t1 change f4 f4 tinyint, algorithm=inplace;
--error 1846
alter table t1 change f6 f6 smallint, algorithm=inplace;
--error 1846
alter table t1 change f8 f8 mediumint, algorithm=inplace;
--error 1846
alter table t1 change f10 f10 int, algorithm=inplace;
--error 1846
alter table t1 change f12 f12 bigint, algorithm=inplace;
alter table t1 change f3 f3 tinyint, algorithm=inplace;
alter table t1 change f5 f5 smallint, algorithm=inplace;
alter table t1 change f7 f7 mediumint, algorithm=inplace;
alter table t1 change f9 f9 int, algorithm=inplace;
alter table t1 change f11 f11 bigint, algorithm=inplace;
alter table t1 change id id double, algorithm=inplace;
show create table t1;
insert into t1 values (5793842.23, 84209402834.45, 4820840.10,6,6,6,6,6,6,6,6,6,6);
select * from t1 order by id;
drop table t1;

create table t1 ( id double primary key, d1 double(24,2), d2 double(11,2), d3 double(2,0), d4 double(3,0), d5 double(4,0), d6 double(5,0), d7 double(6,0), d8 double(7,0), d9 double(9,0), d10 double(10,0), d11 double(18,0), d12 double(19,0) );
insert into t1 values (-1.7976931348623157E+308,-340288493249223466.21,-34028235.01,9,9,9,9,9,9,9,9,9,9);
insert into t1 values (0.1111111111111,0.111111111111111,0.1111111,10,101,101,101,101,101,101,101,101,101);
insert into t1 values (12344321.56789,12344321.56789,1234.56789,11,111,111,111,111,111,111,111,111,111);
insert into t1 values (-2.2250738585072014E-308,-117549749202435.30, -117549435.01,99,99,99,99,99,99,99,99,99,99);
insert into t1 values (1.7976931348623157E+308, 34028234684593436.99, 34028267.35,1,1,1,1,1,1,1,1,1,1);
insert into t1 values (3849238024892.123, 15493749234289.1, 42934729.9,0,0,0,0,0,0,0,0,0,0);
#BUG #SEQUOIASQLMAINSTREAM-419
--error 1846
alter table t1 modify d1 double(24,3), algorithm=inplace;
alter table t1 modify d1 double(26,3), algorithm=inplace;
#BUG #SEQUOIASQLMAINSTREAM-420
alter table t1 modify d2 decimal(20,2), algorithm=inplace;
#BUG #SEQUOIASQLMAINSTREAM-424
--error 1846
alter table t1 change d3 d3 bit(8), algorithm=inplace;
--error 1846
alter table t1 change d4 d4 tinyint, algorithm=inplace;
--error 1846
alter table t1 change d6 d6 smallint, algorithm=inplace;
--error 1846
alter table t1 change d8 d8 mediumint, algorithm=inplace;
--error 1846
alter table t1 change d10 d10 int, algorithm=inplace;
--error 1846
alter table t1 change d12 d12 bigint, algorithm=inplace;
alter table t1 change d3 d3 tinyint, algorithm=inplace;
alter table t1 change d5 d5 smallint, algorithm=inplace;
alter table t1 change d7 d7 mediumint, algorithm=inplace;
alter table t1 change d9 d9 int, algorithm=inplace;
alter table t1 change d11 d11 bigint, algorithm=inplace;
show create table t1;
insert into t1 values (5793842.23, 84209402834.45, 4820840.10,6,6,6,6,6,6,6,6,6,6);
select * from t1 order by id;
drop table t1;

create table t1 ( id decimal primary key, d1 decimal(24,2), d3 decimal(2,0), d4 decimal(3,0), d5 decimal(4,0), d6 decimal(5,0), d7 decimal(6,0), d8 decimal(7,0), d9 decimal(9,0), d10 decimal, d11 decimal(18,0), d12 decimal(19,0) );
insert into t1 values (-34028235,-340288493249223466.21,9,9,9,9,9,9,9,9,9,9);
insert into t1 values (111111111,1111111111.11,10,101,101,101,101,101,101,101,101,101);
insert into t1 values (12344321, 2250738585734.22,11,111,111,111,111,111,111,111,111,111);
insert into t1 values (-117549435, 7976931348623157.12,99,99,99,99,99,99,99,99,99,99);
insert into t1 values (56789, 56789.4321,1,1,1,1,1,1,1,1,1,1);
insert into t1 values (4293749, 8549374927933329.2,0,0,0,0,0,0,0,0,0,0);
#BUG #SEQUOIASQLMAINSTREAM-419
--error 1846
alter table t1 modify d1 decimal(24,3), algorithm=inplace;
alter table t1 change d1 d1 decimal(27,3), algorithm=inplace;
#BUG #SEQUOIASQLMAINSTREAM-424
--error 1846
alter table t1 change d3 d3 bit(8), algorithm=inplace;
--error 1846
alter table t1 change d4 d4 tinyint, algorithm=inplace;
--error 1846
alter table t1 change d6 d6 smallint, algorithm=inplace;
--error 1846
alter table t1 change d8 d8 mediumint, algorithm=inplace;
--error 1846
alter table t1 change d10 d10 int, algorithm=inplace;
--error 1846
alter table t1 change d12 d12 bigint, algorithm=inplace;
alter table t1 change d3 d3 tinyint, algorithm=inplace;
alter table t1 change d5 d5 smallint, algorithm=inplace;
alter table t1 change d7 d7 mediumint, algorithm=inplace;
alter table t1 change d9 d9 int, algorithm=inplace;
alter table t1 change d11 d11 bigint, algorithm=inplace;
show create table t1;
insert into t1 values (5793842, 584308008420940283456734.45,6,6,6,6,6,6,6,6,6,6);
select * from t1 order by id;
drop table t1;

create table t1 ( id bit(8) primary key );
insert into t1 values (b'11111111'), (b'10000001'), (b'100001'),(b'10101010'),(b'0000000'),(b'1');
alter table t1 change id id bit(16), algorithm=inplace;
show create table t1;
insert into t1 values (b'1111111111111111'), (b'10101010101010');
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, a enum('b','a','z'), b set('1', 'a', 'c', '2', 'k', 'y', 'x') );
insert into t1(a,b) values ('a','k,y'), ('b', '1,2,x'), ('z', 'k,c'), ('b', 'k,y,2,a'), ('a', 'x,y'), ('z', 'a,x,k,1');
alter table t1 change a a enum('b','a','z','x','1','c'), algorithm = inplace;
alter table t1 change b b set('1', 'a', 'c', '2', 'k', 'y', 'x','m','n','0'), algorithm = inplace;
show create table t1; 
insert into t1(a,b) values ('a', 'x,y'), ('x', '1,a'), ('1', 'c,k'), ('c', 'y,2'), ('1', '1,a,x,m,0'), ('c', 'k,y,x,m,n,0');
select * from t1 order by id; 
drop table t1;

create table t1 ( id tinyint unsigned primary key, i1 tinyint unsigned, i2 tinyint unsigned, i3 tinyint unsigned, i4 tinyint unsigned, i5 tinyint unsigned);
insert into t1 values (109,109,109,109,109,109),(1,1,1,1,1,1),(20,20,20,20,20,20),(127,127,127,127,127,127),(0,0,0,0,0,0),(255,255,255,255,255,255);
alter table t1 change id id bit(8), algorithm=inplace;
alter table t1 change i1 i1 tinyint unsigned, algorithm=inplace;
alter table t1 change i2 i2 smallint unsigned, algorithm=inplace;
alter table t1 change i3 i3 mediumint unsigned, algorithm=inplace;
alter table t1 change i4 i4 int unsigned, algorithm=inplace;
alter table t1 change i5 i5 bigint unsigned, algorithm=inplace;
show create table t1;
insert into t1 values (b'10101010',254,65535,16777215,4294967295,4294967295), (b'1001',253,65534,16777214,4294967294,4294967294);
select * from t1 order by id;
drop table t1;

create table t1 ( id tinyint unsigned primary key, i1 tinyint unsigned );
insert into t1 values (109,109),(1,1),(20,20),(127,127),(0,0),(255,255);
alter table t1 modify id enum('a1','a2','a3','a4','a5','a6','a7','a8','a9','a10','a11','a12','a13','a14','a15','a16','a17','a18','a19','a20','a21','a22','a23','a24','a25','a26','a27','a28','a29','a30','a31','a32','a33','a34','a35','a36','a37','a38','a39','a40','a41','a42','a43','a44','a45','a46','a47','a48','a49','a50','a51','a52','a53','a54','a55','a56','a57','a58','a59','a60','a61','a62','a63','a64','a65','a66','a67','a68','a69','a70','a71','a72','a73','a74','a75','a76','a77','a78','a79','a80','a81','a82','a83','a84','a85','a86','a87','a88','a89','a90','a91','a92','a93','a94','a95','a96','a97','a98','a99','a100','a101','a102','a103','a104','a105','a106','a107','a108','a109','a110','a111','a112','a113','a114','a115','a116','a117','a118','a119','a120','a121','a122','a123','a124','a125','a126','a127','a128','b1','b2','b3','b4','b5','b6','b7','b8','b9','b10','b11','b12','b13','b14','b15','b16','b17','b18','b19','b20','b21','b22','b23','b24','b25','b26','b27','b28','b29','b30','b31','b32','b33','b34','b35','b36','b37','b38','b39','b40','b41','b42','b43','b44','b45','b46','b47','b48','b49','b50','b51','b52','b53','b54','b55','b56','b57','b58','b59','b60','b61','b62','b63','b64','b65','b66','b67','b68','b69','b70','b71','b72','b73','b74','b75','b76','b77','b78','b79','b80','b81','b82','b83','b84','b85','b86','b87','b88','b89','b90','b91','b92','b93','b94','b95','b96','b97','b98','b99','b100','b101','b102','b103','b104','b105','b106','b107','b108','b109','b110','b111','b112','b113','b114','b115','b116','b117','b118','b119','b120','b121','b122','b123','b124','b125','b126','b127','b128'), algorithm=inplace;
alter table t1 modify i1 set('a1','a2','a3','a4','a5','a6','a7','a8'), algorithm=inplace;
show create table t1;
insert into t1 values ('b23', 'a1,a2');
select * from t1 order by id;
drop table t1;

create table t1 ( id tinyint unsigned primary key, i1 tinyint unsigned, i2 tinyint unsigned );
insert into t1 values (109,109,109),(1,1,1),(20,20,20),(127,127,127),(0,0,0),(255,255,255);
alter table t1 change id id float(4,1) unsigned, algorithm=inplace;
alter table t1 modify i1 double unsigned, algorithm=inplace;
alter table t1 modify i2 decimal(6,3) unsigned, algorithm=inplace;
show create table t1;
insert into t1 values (1.1000000000000001,1.1000000000000001,1.1000000000000001),(10.48,10.48E+03,10.48);
select * from t1 order by id;
alter table t1 change id id float(4,1), algorithm=inplace;
alter table t1 modify i1 double, algorithm=inplace;
alter table t1 modify i2 decimal(6,3), algorithm=inplace;
show create table t1;
insert into t1 values (-1.1000000000000001,-1.1000000000000001,-1.1000000000000001),(-10.48,-10.48E+03,-10.48);
select * from t1 order by id;
drop table t1;

create table t1 ( id smallint unsigned primary key, i1 smallint unsigned, i2 smallint unsigned, i3 smallint unsigned, i4 smallint unsigned);
insert into t1 values (109,109,109,109,109),(1,1,1,1,1),(20,20,20,20,20),(32768,32768,32768,32768,32768),(0,0,0,0,0),(65535,65535,65535,65535,65535);
alter table t1 change id id bit(16), algorithm=inplace;
alter table t1 change i1 i1 smallint unsigned, algorithm=inplace;
alter table t1 change i2 i2 mediumint unsigned, algorithm=inplace;
alter table t1 change i3 i3 int unsigned, algorithm=inplace;
alter table t1 change i4 i4 bigint unsigned, algorithm=inplace;
show create table t1;
insert into t1 values (b'1010101010101010',65534,16777215,4294967295,18446744073709551615), (b'100110011',65533,16777214,4294967294,18446744073709551614);
select * from t1 order by id;
drop table t1;

create table t1 ( id smallint unsigned primary key, i1 smallint unsigned );
insert into t1 values (109,109),(1,1),(20,20),(32768,32768),(0,0),(65535,65535);
alter table t1 modify i1 set('a1','a2','a3','a4','a5','a6','a7','a8','a9','a10','a11', 'a12', 'a13', 'a14', 'a15', 'a16'), algorithm=inplace;
show create table t1;
insert into t1 values (110, 'a1,a2');
select * from t1 order by id;
drop table t1;

create table t1 ( id smallint unsigned primary key, i1 smallint unsigned, i2 smallint unsigned );
insert into t1 values (109,109,109),(1,1,1),(20,20,20),(32768,32768,32768),(0,0,0),(65535,65535,65535);
alter table t1 change id id float(6,1) unsigned, algorithm=inplace;
alter table t1 modify i1 double unsigned, algorithm=inplace;
alter table t1 modify i2 decimal(10,3) unsigned, algorithm=inplace;
show create table t1;
insert into t1 values (1.1000000000000001,1.1000000000000001,1.1000000000000001),(10.48,10.48E+03,10.48);
select * from t1 order by id;
alter table t1 change id id float(7,1), algorithm=inplace;
alter table t1 modify i1 double, algorithm=inplace;
alter table t1 modify i2 decimal(12,3), algorithm=inplace;
show create table t1;
insert into t1 values (-1.1000000000000001,-1.1000000000000001,-1.1000000000000001),(-10.48,-10.48E+03,-10.48);
select * from t1 order by id;
drop table t1;

create table t1 ( id mediumint unsigned primary key, i1 mediumint unsigned, i2 mediumint unsigned, i3 mediumint unsigned );
insert into t1 values (109,109,109,109),(1,1,1,1),(20,20,20,20),(8388608,8388608,8388608,8388608),(0,0,0,0),(16777215,16777215,16777215,16777215);
alter table t1 change id id bit(32), algorithm=inplace;
alter table t1 change i1 i1 mediumint unsigned, algorithm=inplace;
alter table t1 change i2 i2 int unsigned, algorithm=inplace;
alter table t1 change i3 i3 bigint unsigned, algorithm=inplace;
show create table t1;
insert into t1 values (b'10101010101010101010101010101010',16777214,4294967295,18446744073709551615), (b'100110011100110011',16777213,4294967294,18446744073709551614);
select * from t1 order by id;
drop table t1;

create table t1 ( id mediumint unsigned primary key );
insert into t1 values (109),(1),(20),(8388608),(0),(16777215);
alter table t1 modify id set('a1','a2','a3','a4','a5','a6','a7','a8','a9','a10','a11', 'a12', 'a13', 'a14', 'a15', 'a16', 'b1','b2','b3','b4','b5','b6','b7','b8','b9','b10','b11', 'b12', 'b13', 'b14', 'b15', 'b16'), algorithm=inplace;
show create table t1;
insert into t1 values ('a1,b2');
select * from t1 order by id;
drop table t1;

create table t1 ( id mediumint unsigned primary key, i1 mediumint unsigned, i2 mediumint unsigned );
insert into t1 values (109,109,109),(1,1,1),(20,20,20),(8388608,8388608,8388608),(0,0,0),(16777215,16777215,16777215);
#BUG #SEQUOIASQLMAINSTREAM-417
--error 1846
alter table t1 change id id float(12,1) unsigned, algorithm=inplace;
alter table t1 modify i1 double unsigned, algorithm=inplace;
alter table t1 modify i2 decimal(16,3) unsigned, algorithm=inplace;
show create table t1;
insert into t1 values (2.1000000000000001,1.1000000000000001,1.1000000000000001),(10.48,10.48E+03,10.48);
select * from t1 order by id;
#BUG #SEQUOIASQLMAINSTREAM-417
--error 1846
alter table t1 change id id float(12,1), algorithm=inplace;
alter table t1 modify i1 double, algorithm=inplace;
alter table t1 modify i2 decimal(16,3), algorithm=inplace;
show create table t1;
insert into t1 values (3.1000000000000001,-1.1000000000000001,-1.1000000000000001),(30.48,-10.48E+03,-10.48);
select * from t1 order by id;
drop table t1;

create table t1 ( id int unsigned primary key, i1 int unsigned, i2 int unsigned );
insert into t1 values (109,109,109),(1,1,1),(20,20,20),(2147483648,2147483648,2147483648),(0,0,0),(4294967295,4294967295,4294967295);
alter table t1 change id id bit(32), algorithm=inplace;
alter table t1 change i1 i1 int unsigned, algorithm=inplace;
alter table t1 change i2 i2 bigint unsigned, algorithm=inplace;
show create table t1;
insert into t1 values (b'10101010101010101010101010101010',4294967294,18446744073709551615), (b'100110011100110011',4294967293,18446744073709551613);
select * from t1 order by id;
drop table t1;

create table t1 ( id int unsigned primary key );
insert into t1 values (109),(1),(20),(2147483648),(0),(4294967295);
alter table t1 modify id set('a1','a2','a3','a4','a5','a6','a7','a8','a9','a10','a11', 'a12', 'a13', 'a14', 'a15', 'a16', 'b1','b2','b3','b4','b5','b6','b7','b8','b9','b10','b11', 'b12', 'b13', 'b14', 'b15', 'b16'), algorithm=inplace;
show create table t1;
insert into t1 values ('a1,b2,a15,b16');
select * from t1 order by id;
drop table t1;

create table t1 ( id int unsigned primary key, i1 int unsigned, i2 int unsigned );
insert into t1 values (109,109,109),(1,1,1),(20,20,20),(2147483648,2147483648,2147483648),(0,0,0),(4294967295,4294967295,4294967295);
#BUG #SEQUOIASQLMAINSTREAM-417
--error 1846
alter table t1 change id id float(12,1) unsigned, algorithm=inplace;
alter table t1 modify i1 double unsigned, algorithm=inplace;
alter table t1 modify i2 decimal(16,3) unsigned, algorithm=inplace;
show create table t1;
insert into t1 values (2.1000000000000001,1.1000000000000001,1.1000000000000001),(10.48,10.48E+03,10.48);
select * from t1 order by id;
#BUG #SEQUOIASQLMAINSTREAM-417
--error 1846
alter table t1 change id id float(12,1), algorithm=inplace;
alter table t1 modify i1 double, algorithm=inplace;
alter table t1 modify i2 decimal(16,3), algorithm=inplace;
show create table t1;
insert into t1 values (3.1000000000000001,-1.1000000000000001,-1.1000000000000001),(30.48,-10.48E+03,-10.48);
select * from t1 order by id;
drop table t1;

create table t1 ( id bigint unsigned primary key, i1 bigint unsigned, i2 bigint unsigned, i3 bigint unsigned );
insert into t1 values (109,109,109,109),(1,1,1,1),(20,20,20,20),(9223372036854775808,9223372036854775808,9223372036854775808,9223372036854775808),(0,0,0,0),(18446744073709551613,18446744073709551613,18446744073709551613,18446744073709551613);
alter table t1 change id id bit(64), algorithm=inplace;
#BUG #SEQUOIASQLMAINSTREAM-417
--error 1846
alter table t1 change i1 i1 float(22,2), algorithm=inplace;
--error 1846
alter table t1 change i2 i2 double(22,2), algorithm=inplace;
alter table t1 change i3 i3 decimal(30,5), algorithm=inplace;
show create table t1;
insert into t1 values (b'1010101010101010101010101010101010101010101010101010101010101010',429496729448320.22,429496729448320.22,1844674407370955161584320.8342), (b'100110011100110011100110011100110011',429496729348293342.99,429496729348293342.99,48302446744073709551613.7239);
select hex(id),i1,i2,i3 from t1 order by id,i1;
drop table t1;

create table t1 ( id float unsigned primary key, f1 float(20,0) unsigned, f2 float(25,2) unsigned, f3 float(31,2) unsigned, f4 float(2,0) unsigned, f5 float(3,0) unsigned, f6 float(4,0) unsigned, f7 float(5,0) unsigned, f8 float(6,0) unsigned, f9 float(7,0) unsigned, f10 float(9,0) unsigned, f11 float(10,0) unsigned, f12 float(19,0) unsigned, f13 float(20,0) unsigned );
insert into t1 values (1.1000000000000001,1,1.1000000000000001,1.1000000000000001,9,9,9,9,9,9,9,9,9,9);
insert into t1 values (10.48,10,10.48,10.48E+03,10,101,101,101,101,101,101,101,101,101);
insert into t1 values (432908.32082,432908,432908.32,432908.32,11,111,111,111,111,111,111,111,111,111);
insert into t1 values (43829.32,43829,43829.32,43829.32,99,99,99,99,99,99,99,99,99,99);
insert into t1 values (4793.23,4793,4793.23,4793.23,1,1,1,1,1,1,1,1,1,1);
insert into t1 values (3240.12,3240,3240.12,3240.12,0,0,0,0,0,0,0,0,0,0);
alter table t1 change id id double unsigned, algorithm=inplace;
alter table t1 change f2 f2 float(28,2) unsigned, algorithm=inplace;
#BUG #SEQUOIASQLMAINSTREAM-420  
alter table t1 change f3 f3 decimal(40,2) unsigned, algorithm=inplace;
#BUG #SEQUOIASQLMAINSTREAM-424
--error 1846
alter table t1 change f4 f4 bit(8), algorithm=inplace;
--error 1846
alter table t1 change f5 f5 tinyint unsigned, algorithm=inplace;
--error 1846
alter table t1 change f7 f7 smallint unsigned, algorithm=inplace;
--error 1846
alter table t1 change f10 f10 mediumint unsigned, algorithm=inplace;
--error 1846
alter table t1 change f11 f11 int unsigned, algorithm=inplace;
--error 1846
alter table t1 change f13 f13 bigint unsigned, algorithm=inplace;
alter table t1 change f4 f4 tinyint , algorithm=inplace;
alter table t1 change f6 f6 smallint unsigned, algorithm=inplace;
alter table t1 change f8 f8 mediumint , algorithm=inplace;
alter table t1 change f10 f10 int unsigned, algorithm=inplace;
alter table t1 change f12 f12 bigint unsigned, algorithm=inplace;
show create table t1;
insert into t1 values (48329.3429,b'11111111111111111111111111111111111111111',4832948230840.11,480249208340274203842.23,6,6,6,6,6,6,6,6,6,6);
select * from t1 order by id;
alter table t1 change id id double, algorithm=inplace;
alter table t1 change f2 f2 float(28,2), algorithm=inplace;
#BUG #SEQUOIASQLMAINSTREAM-420
alter table t1 change f3 f3 decimal(40,2), algorithm=inplace;
show create table t1;
insert into t1 values (-48329.3429,b'11111111111111111111111111111111111111111',-4832948230840.11,-480249208340274203842.23,7,7,7,7,7,7,7,7,7,7);
select * from t1 order by id;
drop table t1;

create table t1 ( id double unsigned primary key, f1 double(20,0) unsigned, f2 double(25,2) unsigned, f4 double(2,0) unsigned, f5 double(3,0) unsigned, f6 double(4,0) unsigned, f7 double(5,0) unsigned, f8 double(6,0) unsigned, f9 double(7,0) unsigned, f10 double(9,0) unsigned, f11 double(10,0) unsigned, f12 double(19,0) unsigned, f13 double(20,0) unsigned );
insert into t1 values (1.1000000000000001,1,1.1000000000000001,9,9,9,9,9,9,9,9,9,9);
insert into t1 values (10.48,10,10.48,10,101,101,101,101,101,101,101,101,101);
insert into t1 values (432908.32082,432908,432908.32,11,111,111,111,111,111,111,111,111,111);
insert into t1 values (43829.32,43829,43829.32,99,99,99,99,99,99,99,99,99,99);
insert into t1 values (4793.23,4793,4793.23,1,1,1,1,1,1,1,1,1,1);
insert into t1 values (3240.12,3240,3240.12,0,0,0,0,0,0,0,0,0,0);
#BUG #SEQUOIASQLMAINSTREAM-420
alter table t1 change f2 f2 decimal(40,2) unsigned, algorithm=inplace;
show create table t1;
insert into t1 values (48329.3429,b'11111111111111111111111111111111111111111',4832948230840.11,6,6,6,6,6,6,6,6,6,6);
select * from t1 order by id;
#BUG #SEQUOIASQLMAINSTREAM-420
alter table t1 change f2 f2 decimal(40,2), algorithm=inplace;
#BUG #SEQUOIASQLMAINSTREAM-424
--error 1846
alter table t1 change f4 f4 bit(8), algorithm=inplace;
--error 1846
alter table t1 change f5 f5 tinyint unsigned, algorithm=inplace;
--error 1846
alter table t1 change f7 f7 smallint unsigned, algorithm=inplace;
--error 1846
alter table t1 change f10 f10 mediumint unsigned, algorithm=inplace;
--error 1846
alter table t1 change f11 f11 int unsigned, algorithm=inplace;
--error 1846
alter table t1 change f13 f13 bigint unsigned, algorithm=inplace;
alter table t1 change f4 f4 tinyint , algorithm=inplace;
alter table t1 change f6 f6 smallint unsigned, algorithm=inplace;
alter table t1 change f8 f8 mediumint , algorithm=inplace;
alter table t1 change f10 f10 int unsigned, algorithm=inplace;
alter table t1 change f12 f12 bigint unsigned, algorithm=inplace;
show create table t1;
insert into t1 values (74293.32,b'11111111111111111111111111111111111111111',480249208340274203842.23,7,7,7,7,7,7,7,7,7,7);
select * from t1 order by id;
drop table t1;

create table t1 ( id decimal unsigned primary key, f1 decimal(20,0) unsigned, f2 decimal(25,2) unsigned, f4 decimal(2,0) unsigned, f5 decimal(3,0) unsigned, f6 decimal(4,0) unsigned, f7 decimal(5,0) unsigned, f8 decimal(6,0) unsigned, f9 decimal(7,0) unsigned, f10 decimal(9,0) unsigned, f11 decimal unsigned, f12 decimal(19,0) unsigned, f13 decimal(20,0) unsigned  );
insert into t1 values (1.1000000000000001,1,1.1000000000000001,9,9,9,9,9,9,9,9,9,9);
insert into t1 values (10.48,10,10.48,10,101,101,101,101,101,101,101,101,101);
insert into t1 values (432908.32082,432908,432908.32,11,111,111,111,111,111,111,111,111,111);
insert into t1 values (43829.32,43829,43829.32,99,99,99,99,99,99,99,99,99,99);
insert into t1 values (4793.23,4793,4793.23,1,1,1,1,1,1,1,1,1,1);
insert into t1 values (3240.12,3240,3240.12,0,0,0,0,0,0,0,0,0,0);
alter table t1 change id id decimal(40,2) unsigned, algorithm=inplace;
show create table t1;
insert into t1 values (48329.3429,b'11111111111111111111111111111111111111111',4832948230840.11,6,6,6,6,6,6,6,6,6,6);
select * from t1 order by id;
alter table t1 change id id decimal(40,2), algorithm=inplace;
#BUG #SEQUOIASQLMAINSTREAM-424
--error 1846
alter table t1 change f4 f4 bit(8), algorithm=inplace;
--error 1846
alter table t1 change f5 f5 tinyint unsigned, algorithm=inplace;
--error 1846
alter table t1 change f7 f7 smallint unsigned, algorithm=inplace;
--error 1846
alter table t1 change f10 f10 mediumint unsigned, algorithm=inplace;
--error 1846
alter table t1 change f11 f11 int unsigned, algorithm=inplace;
--error 1846
alter table t1 change f13 f13 bigint unsigned, algorithm=inplace;
alter table t1 change f4 f4 tinyint , algorithm=inplace;
alter table t1 change f6 f6 smallint unsigned, algorithm=inplace;
alter table t1 change f8 f8 mediumint , algorithm=inplace;
alter table t1 change f10 f10 int unsigned, algorithm=inplace;
alter table t1 change f12 f12 bigint unsigned, algorithm=inplace;
show create table t1;
insert into t1 values (-48329.3429,b'11111111111111111111111111111111111111111',480249208340274203842.23,7,7,7,7,7,7,7,7,7,7);
select * from t1 order by id;
drop table t1;

create table t1 ( id char(8) primary key, c1 char(16), c2 char(32), c3 char(64), c4 char(128), c5 char(255) );
insert into t1 values ("ufsdo2","ufsdo2","ufsdo2","ufsdo2","ufsdo2","ufsdo2"),("24ijrfsw","24ijrfsw","24ijrfsw","24ijrfsw","24ijrfsw","24ijrfsw"),("e29wdf","e29wdf","e29wdf","e29wdf","e29wdf","e29wdf"),("aaa","aaa","aaa","aaa","aaa","aaa"),("47293jr","47293jr","47293jr","47293jr","47293jr","47293jr"),("he",'he','he','he','he','he');
alter table t1 modify id char(9), algorithm=inplace;
alter table t1 modify c1 varchar(16), algorithm=inplace;
alter table t1 modify c2 tinytext, algorithm=inplace;
alter table t1 modify c3 text, algorithm=inplace;
alter table t1 modify c4 mediumtext, algorithm=inplace;
alter table t1 modify c5 longtext, algorithm=inplace;
show create table t1;
insert into t1 values ("123456789","123456789abcdefg","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj");
select * from t1 order by id;
drop table t1;

create table t1 ( id varchar(32) primary key, c1 varchar(128), c2 varchar(256), c3 varchar(512), c4 varchar(4096) );
insert into t1 values ("ufsdo2","ufsdo2","ufsdo2","ufsdo2","ufsdo2"),("24ijrfsw","24ijrfsw","24ijrfsw","24ijrfsw","24ijrfsw"),("e29wdf","e29wdf","e29wdf","e29wdf","e29wdf"),("aaa","aaa","aaa","aaa","aaa"),("47293jr","47293jr","47293jr","47293jr","47293jr"),("he",'he','he','he','he');
#BUG #SEQUOIASQLMAINSTREAM-396
--error 1846
alter table t1 modify c1 char(255), algorithm=inplace;
alter table t1 modify c1 varchar(129), algorithm=inplace;
alter table t1 modify c2 text, algorithm=inplace;
alter table t1 modify c3 mediumtext, algorithm=inplace;
alter table t1 modify c4 longtext, algorithm=inplace;
show create table t1;
insert into t1 values ("123456789","123456789abcdefg","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj");
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, c1 tinytext, c2 tinytext, c3 tinytext, c4 tinytext );
insert into t1(c1,c2,c3,c4) values ("ufsdo2","ufsdo2","ufsdo2","ufsdo2"),("24ijrfsw","24ijrfsw","24ijrfsw","24ijrfsw"),("e29wdf","e29wdf","e29wdf","e29wdf"),("aaa","aaa","aaa","aaa"),("47293jr","47293jr","47293jr","47293jr"),("he",'he','he','he');
#BUG #SEQUOIASQLMAINSTREAM-396
--error 1846
alter table t1 modify c1 char(255), algorithm=inplace;
alter table t1 modify c1 varchar(255), algorithm=inplace;
alter table t1 modify c2 text, algorithm=inplace;
alter table t1 modify c3 mediumtext, algorithm=inplace;
alter table t1 modify c4 longtext, algorithm=inplace;
show create table t1;
insert into t1(c1,c2,c3,c4) values ("123456789abcdefg","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj");
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, c1 text, c2 text, c3 text );
insert into t1(c1,c2,c3) values ("ufsdo2","ufsdo2","ufsdo2"),("24ijrfsw","24ijrfsw","24ijrfsw"),("e29wdf","e29wdf","e29wdf"),("aaa","aaa","aaa"),("47293jr","47293jr","47293jr"),("he",'he','he');
#BUG #SEQUOIASQLMAINSTREAM-396
--error 1846
alter table t1 modify c1 char(255), algorithm=inplace;
alter table t1 change c1 c1 text, algorithm=inplace;
alter table t1 change c2 c2 mediumtext, algorithm=inplace;
alter table t1 change c3 c3 longtext, algorithm=inplace;
show create table t1;
insert into t1(c1,c2,c3) values ("gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj");
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, c1 mediumtext, c2 mediumtext );
insert into t1(c1,c2) values ("ufsdo2","ufsdo2"),("24ijrfsw","24ijrfsw"),("e29wdf","e29wdf"),("aaa","aaa"),("47293jr","47293jr"),("he",'he');
#BUG #SEQUOIASQLMAINSTREAM-396
--error 1846
alter table t1 modify c1 char(255), algorithm=inplace;
alter table t1 change c1 c1 mediumtext, algorithm=inplace;
alter table t1 change c2 c2 longtext, algorithm=inplace;
show create table t1;
insert into t1(c1,c2) values ("gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj");
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, c1 longtext );
insert into t1(c1) values ("ufsdo2"),("24ijrfsw"),("e29wdf"),("aaa"),("47293jr"),("he");
#BUG #SEQUOIASQLMAINSTREAM-396
--error 1846
alter table t1 modify c1 char(255), algorithm=inplace;
alter table t1 change c1 c1 longtext, algorithm=inplace;
show create table t1;
insert into t1(c1) values ("gjoewjrlw342982jlfsfjslfjslr942lj");
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, b1 binary(8), b2 binary(16), b3 binary(32), b4 binary(64), b5 binary(128), b6 binary(255) );
insert into t1(b1,b2,b3,b4,b5,b6) values ("ufsdo2","ufsdo2","ufsdo2","ufsdo2","ufsdo2","ufsdo2"),("24ijrfsw","24ijrfsw","24ijrfsw","24ijrfsw","24ijrfsw","24ijrfsw"),("e29wdf","e29wdf","e29wdf","e29wdf","e29wdf","e29wdf"),("aaa","aaa","aaa","aaa","aaa","aaa"),("47293jr","47293jr","47293jr","47293jr","47293jr","47293jr"),("he",'he','he',"he",'he','he');
alter table t1 modify b1 binary(17), algorithm=inplace;
alter table t1 modify b2 varbinary(32), algorithm=inplace;
alter table t1 modify b3 tinyblob, algorithm=inplace;
alter table t1 modify b4 blob, algorithm=inplace;
alter table t1 modify b5 mediumblob, algorithm=inplace;
alter table t1 modify b6 longblob, algorithm=inplace;
show create table t1;
insert into t1(b1,b2,b3,b4,b5,b6) values ("123456789","123456789abcdefg","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj");
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, b1 varbinary(128), b2 varbinary(256), b3 varbinary(512), b4 varbinary(4096), b5 varbinary(8192) );
insert into t1(b1,b2,b3,b4,b5) values ("ufsdo2","ufsdo2","ufsdo2","ufsdo2","ufsdo2"),("24ijrfsw","24ijrfsw","24ijrfsw","24ijrfsw","24ijrfsw"),("e29wdf","e29wdf","e29wdf","e29wdf","e29wdf"),("aaa","aaa","aaa","aaa","aaa"),("47293jr","47293jr","47293jr","47293jr","47293jr"),("he",'he','he',"he",'he');
#BUG #SEQUOIASQLMAINSTREAM-396
--error 1846
alter table t1 modify b1 binary(255), algorithm=inplace;  
alter table t1 modify b1 varbinary(129), algorithm=inplace;
alter table t1 modify b2 blob, algorithm=inplace;
alter table t1 modify b3 mediumblob, algorithm=inplace;
alter table t1 modify b4 longblob, algorithm=inplace;
show create table t1;
insert into t1(b1,b2,b3,b4,b5) values ("123456789","123456789abcdefg","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj");
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, c1 tinyblob, c2 tinyblob, c3 tinyblob, c4 tinyblob );
insert into t1(c1,c2,c3,c4) values ("ufsdo2","ufsdo2","ufsdo2","ufsdo2"),("24ijrfsw","24ijrfsw","24ijrfsw","24ijrfsw"),("e29wdf","e29wdf","e29wdf","e29wdf"),("aaa","aaa","aaa","aaa"),("47293jr","47293jr","47293jr","47293jr"),("he",'he','he',"he");
#BUG #SEQUOIASQLMAINSTREAM-396
--error 1846
alter table t1 modify c1 binary(255), algorithm=inplace;
alter table t1 modify c1 varbinary(255), algorithm=inplace;
alter table t1 modify c2 blob, algorithm=inplace;
alter table t1 modify c3 mediumblob, algorithm=inplace;
alter table t1 modify c4 longblob, algorithm=inplace;
show create table t1;
insert into t1(c1,c2,c3,c4) values ("123456789abcdefg","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj");
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, c1 blob, c2 blob, c3 blob );
insert into t1(c1,c2,c3) values ("ufsdo2","ufsdo2","ufsdo2"),("24ijrfsw","24ijrfsw","24ijrfsw"),("e29wdf","e29wdf","e29wdf"),("aaa","aaa","aaa"),("47293jr","47293jr","47293jr"),("he",'he','he');
#BUG #SEQUOIASQLMAINSTREAM-396
--error 1846
alter table t1 modify c1 binary(255), algorithm=inplace;
alter table t1 change c1 c1 blob, algorithm=inplace;
alter table t1 change c2 c2 mediumblob, algorithm=inplace;
alter table t1 change c3 c3 longblob, algorithm=inplace;
show create table t1;
insert into t1(c1,c2,c3) values ("gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj");
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, c1 mediumblob, c2 mediumblob );
insert into t1(c1,c2) values ("ufsdo2","ufsdo2"),("24ijrfsw","24ijrfsw"),("e29wdf","e29wdf"),("aaa","aaa"),("47293jr","47293jr"),("he",'he');
#BUG #SEQUOIASQLMAINSTREAM-396
--error 1846
alter table t1 modify c1 binary(255), algorithm=inplace;
alter table t1 change c1 c1 mediumblob, algorithm=inplace;
alter table t1 change c2 c2 longblob, algorithm=inplace;
show create table t1;
insert into t1(c1,c2) values ("gjoewjrlw342982jlfsfjslfjslr942lj","gjoewjrlw342982jlfsfjslfjslr942lj");
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, c1 longblob );
insert into t1(c1) values ("ufsdo2"),("24ijrfsw"),("e29wdf"),("aaa"),("47293jr"),("he");
#BUG #SEQUOIASQLMAINSTREAM-396
--error 1846
alter table t1 modify c1 binary(255), algorithm=inplace;
alter table t1 change c1 c1 longblob, algorithm=inplace;
show create table t1;
insert into t1(c1) values ("gjoewjrlw342982jlfsfjslfjslr942lj");
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, y1 year );
insert into t1(y1) values (1901),(2019),(2001),(2020),(2155),(2154);
alter table t1 change y1 y1 year, algorithm=inplace;
show create table t1;
insert into t1(y1) values (1999),(2008),(2111);
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, y1 time(4) );
insert into t1(y1) values ("23:59:59.000"),("837:59:59.9999"),("09:50:50.998"),("00:00:00.111"),("12:12:12.12"),("838:59:00.9999");
alter table t1 modify y1 time(6), algorithm=inplace;
show create table t1;
insert into t1(y1) values ("02:02:02.009900"),("-837:59:59.999");
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, d1 date );                                   
insert into t1(d1) values ("2010-10-10"),("2005-05-05"),("2000-1-19"),("1999-09-09"),("2013-07-01"),("2019-12-25");
alter table t1 modify d1 date, algorithm=inplace;
show create table t1;   
insert into t1(d1) values ("2037-12-31"),("2021-01-01");
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, d1 datetime(4) );                                      
insert into t1(d1) values ("2010-10-10 23:59:59.000"),("2005-05-05 09:50:50.998"),("2000-1-19 00:00:00.111"),("1999-09-09 12:12:12.12 "),("2013-07-01 19:19:19.992"),("2019-12-25 01:01:01.9999"),('2021-01-15 15:30:34');
--error 1846
alter table t1 modify d1 datetime(6), algorithm=inplace;
#Bug #SEQUOIASQLMAINSTREAM-916
#seqDB-23430
alter table t1 modify d1 datetime(6), algorithm=copy;
select * from t1 where d1 = '2021-01-15 15:30:34';
#BUG #SEQUOIASQLMAINSTREAM-425
--error 1846
alter table t1 modify d1 datetime(5), algorithm=inplace;
show create table t1;                             
insert into t1(d1) values ("2037-12-31 02:02:02.009900"),("2021-01-01 10:11:12.131415");
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, d1 timestamp(4) );                                      
insert into t1(d1) values ("2010-10-10 23:59:59.000"),("2005-05-05 09:50:50.998"),("2000-1-19 00:00:00.111"),("1999-09-09 12:12:12.12 "),("2013-07-01 19:19:19.992"),("2019-12-25 01:01:01.9999");                                                     
alter table t1 modify d1 timestamp(6), algorithm=inplace;                   
#BUG #SEQUOIASQLMAINSTREAM-425
--error 1846
alter table t1 modify d1 timestamp(5), algorithm=inplace;
show create table t1;                                                      
insert into t1(d1) values ("2037-12-31 02:02:02.009900"),("2021-01-01 10:11:12.131415");
select * from t1 order by id;
drop table t1;

create table t1 ( id int auto_increment primary key, j json );
insert into t1(j) values (NULL),('{"a": 2}'),('[1,2]'),('{"a":"b", "c":"d","ab":"abc", "bc": ["x", "y"]}'),('["here", ["I", "am"], "!!!"]'),('"scalar string"');
alter table t1 change j j json, algorithm=inplace;
show create table t1;
insert into t1(j) values ('true'),('false');
select * from t1 order by id;
drop table t1;

#SeqDB-20207
create table t1(id int auto_increment primary key, a bigint);
insert into t1(a) values(1),(2),(3),(4),(5),(6);
#Bug #SEQUOIASQLMAINSTREAM-749
alter table t1 modify a mediumint not null,algorithm=inplace;
select * from t1 order by id;
drop table t1;

#seqDB-22487
create table t1 (id int auto_increment primary key, a char(10));
insert into t1(a) values('aaaaaaaa'),('aaaaaaaa'),('aaaaaaaa'),('aaaaaaaa'),('aaaaaaa '),('aaaaaa ');
alter table t1 modify a char(8),algorithm=inplace;
select * from t1 order by id;
drop table t1;

#seqDB-22488
create table t1 (id int auto_increment primary key, a varchar(10));
insert into t1(a) values('aaaaaaaa'),('aaaaaaaa'),('aaaaaaaa'),('aaaaaaaa'),('aaaaaaa '),('aaaaaa ');
alter table t1 modify a varchar(8),algorithm=inplace;
select * from t1 order by id;
drop table t1;

#seqDB-22490
create table t1 (id int auto_increment primary key, a longtext);
insert into t1(a) values('aaaaaaaa'),('aaaaaaaa'),('aaaaaaaa'),('aaaaaaaa'),('aaaaaaa ');
insert into t1(a) values(repeat('a', 256));
alter table t1 modify a text,algorithm=inplace;
select * from t1 order by id;
drop table t1;

#seqDB-22492
create table t1 (id int auto_increment primary key, a bigint, b bigint unsigned);
insert into t1(a, b) values(-32769,0),(-32768,1),(0,2),(1,3),(32767,65535),(32768,65536);
alter table t1 modify a mediumint, modify b mediumint unsigned,algorithm=inplace;
select * from t1 order by id;
drop table t1;

# seqDB-22788: alter geometry over sequoiadb_alter_table_overhead_threshold
CREATE TABLE `t1` (
  id int not null auto_increment primary key,
  `geom` geometry DEFAULT NULL,
  `poin` point DEFAULT NULL,
  `line` linestring DEFAULT NULL,
  `poly` polygon DEFAULT NULL,
  `mpoin` multipoint DEFAULT NULL,
  `mline` multilinestring DEFAULT NULL,
  `mploy` multipolygon DEFAULT NULL,
  `geocol` geometrycollection DEFAULT NULL,
  `geom1` geometry not null,
  `poin1` point not null,
  `line1` linestring not null,
  `poly1` polygon not null,
  `mpoin1` multipoint not null,
  `mline1` multilinestring not null,
  `mploy1` multipolygon not null,
  `geocol1` geometrycollection not null
);

show create table t1; 

set @a1 = ST_PointFromText('POINT(1 1)');
set @a2 = ST_LineFromText('LINESTRING(0 0,10 10,20 25,50 60)');
set @a3 = ST_PolygonFromText('POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7,5 5))');
set @a4 = ST_MultiPointFromText('MULTIPOINT(10 10,20 20)');
set @a5 = ST_MLineFromText('MULTILINESTRING((10 10,20 20),(15 15,30 15))');
set @a6 = ST_MPolyFromText('MULTIPOLYGON(((0 0,10 0,10 10,0 10,0 0)),((5 5,7 5,7 7,5 7,5 5)))');
set @a7 = ST_GeomFromText('GEOMETRYCOLLECTION(POINT(10 10),LINESTRING(1 1,2 2,3 3,4 4))');
set @a8 = ST_GeomFromText('GEOMETRYCOLLECTION(POINT(10 10),POINT(30 30),LINESTRING(15 15,20 20))');

insert into t1 value(111,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);
insert into t1 value(112,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);
insert into t1 value(113,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);
insert into t1 value(114,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);
insert into t1 value(115,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);
insert into t1 value(1,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);
insert into t1 value(2,null,null,null,null,null,null,null,null,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);

--sorted_result
select id,ST_AsText(geom),ST_AsText(poin),ST_AsText(line),ST_AsText(poly),ST_AsText(mpoin),ST_AsText(mline),ST_AsText(mploy),ST_AsText(geocol) from t1;
--sorted_result
select id,ST_AsText(geom1),ST_AsText(line1),ST_AsText(poly1),ST_AsText(mpoin1),ST_AsText(mline1),ST_AsText(mploy1),ST_AsText(geocol1) from t1;

# failed to change the field name   
--error 1845
alter table t1 change geom newgeom geometry null,algorithm=inplace;
--error 1845
alter table t1 change poin newpoin  point null,algorithm=inplace;
--error 1845
alter table t1 change line newline linestring null,algorithm=inplace;
--error 1845
alter table t1 change poly newpoly polygon null,algorithm=inplace;
--error 1845
alter table t1 change mpoin newmpoin multipoint null,algorithm=inplace;
--error 1845
alter table t1 change mline newmline multilinestring null,algorithm=inplace;
--error 1845
alter table t1 change mploy newmploy multipolygon null,algorithm=inplace;
--error 1845
alter table t1 change geocol newgeocol geometrycollection null,algorithm=inplace;

show create table t1;

# exit null value 
--error 1138
alter table t1 modify geom geometry not null,algorithm=inplace;
--error 1138
alter table t1 modify poin point not null,algorithm=inplace;
--error 1138
alter table t1 modify line linestring not null,algorithm=inplace;
--error 1138
alter table t1 modify poly polygon not null,algorithm=inplace;
--error 1138
alter table t1 modify mpoin multipoint not null,algorithm=inplace;
--error 1138
alter table t1 modify mline multilinestring not null,algorithm=inplace;
--error 1138
alter table t1 modify mploy multipolygon not null,algorithm=inplace;
--error 1138
alter table t1 modify geocol geometrycollection not null,algorithm=inplace;

delete from t1 where id = 2 ;
--sorted_result
select id,ST_AsText(geom),ST_AsText(poin),ST_AsText(line),ST_AsText(poly),ST_AsText(mpoin),ST_AsText(mline),ST_AsText(mploy),ST_AsText(geocol) from t1;
--sorted_result
select id,ST_AsText(geom1),ST_AsText(line1),ST_AsText(poly1),ST_AsText(mpoin1),ST_AsText(mline1),ST_AsText(mploy1),ST_AsText(geocol1) from t1;

alter table t1 modify geom geometry not null,algorithm=inplace;
alter table t1 modify poin point not null,algorithm=inplace;
alter table t1 modify line linestring not null,algorithm=inplace;
alter table t1 modify poly polygon not null,algorithm=inplace;
alter table t1 modify mpoin multipoint not null,algorithm=inplace;
alter table t1 modify mline multilinestring not null,algorithm=inplace;
alter table t1 modify mploy multipolygon not null,algorithm=inplace;
alter table t1 modify geocol geometrycollection not null,algorithm=inplace;

alter table t1 modify geom1 geometry null,algorithm=inplace;
alter table t1 modify poin1 point null,algorithm=inplace;
alter table t1 modify line1 linestring null,algorithm=inplace;
alter table t1 modify poly1 polygon null,algorithm=inplace;
alter table t1 modify mpoin1 multipoint null,algorithm=inplace;
alter table t1 modify mline1 multilinestring null,algorithm=inplace;
alter table t1 modify mploy1 multipolygon null,algorithm=inplace;
alter table t1 modify geocol1 geometrycollection null,algorithm=inplace;

# check field type result
show create table t1;
--error 1048
insert into t1 value(2,null,@a1,@a2,@a3,@a4,@a5,@a6,@a7,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);
--error 1048
insert into t1 value(3,@a1,null,@a2,@a3,@a4,@a5,@a6,@a7,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);
--error 1048
insert into t1 value(4,@a1,@a1,null,@a3,@a4,@a5,@a6,@a7,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);
--error 1048
insert into t1 value(5,@a1,@a1,@a2,null,@a4,@a5,@a6,@a7,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);
--error 1048
insert into t1 value(6,@a1,@a1,@a2,@a3,null,@a5,@a6,@a7,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);
--error 1048
insert into t1 value(7,@a1,@a1,@a2,@a3,@a4,null,@a6,@a7,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);
--error 1048
insert into t1 value(8,@a1,@a1,@a2,@a3,@a4,@a5,null,@a7,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);
--error 1048
insert into t1 value(9,@a1,@a1,@a2,@a3,@a4,@a5,@a6,null,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);

insert into t1 value(10,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7,null,null,null,null,null,null,null,null);
insert into t1 value(11,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7,@a1,@a1,@a2,@a3,@a4,@a5,@a6,@a7);

--sorted_result
select id,ST_AsText(geom),ST_AsText(poin),ST_AsText(line),ST_AsText(poly),ST_AsText(mpoin),ST_AsText(mline),ST_AsText(mploy),ST_AsText(geocol) from t1;
--sorted_result
select id,ST_AsText(geom1),ST_AsText(line1),ST_AsText(poly1),ST_AsText(mpoin1),ST_AsText(mline1),ST_AsText(mploy1),ST_AsText(geocol1) from t1;

# geometry  change geometry 
--error 1846
alter table t1 modify poin geometry not null,algorithm=inplace;
--error 1846
alter table t1 modify line int not null,algorithm=inplace;
--error 1846
alter table t1 modify poly char not null,algorithm=inplace;
--error 1846
alter table t1 modify mpoin date not null,algorithm=inplace;
--error 1846
alter table t1 modify mline tinyblob not null,algorithm=inplace;
--error 1846
alter table t1 modify mploy mediumblob not null,algorithm=inplace;
#BUG #SEQUOIASQLMAINSTREAM-823	
--error 1846
alter table t1 modify geocol longblob not null,algorithm=inplace;

--error 131
alter table t1 drop column geom1;
--error 131
alter table t1 drop column poin1;
--error 131
alter table t1 drop column line1;
--error 131
alter table t1 drop column poly1;
--error 131
alter table t1 drop column mpoin1;
--error 131
alter table t1 drop column mline1;
--error 131
alter table t1 drop column mploy1;
--error 131
alter table t1 drop column geocol1;
show create table t1;

drop table t1;


drop database test_alter_overhead_threshlod;
--source include/uninstall_sequoiadb.inc
