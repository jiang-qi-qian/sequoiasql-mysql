#Case 31182
--source include/have_sequoiadb.inc

--disable_warnings
drop database if exists group_min_max_sequoiadb_31182;
--enable_warnings

create database group_min_max_sequoiadb_31182;
drop database group_min_max_sequoiadb_31182;
create database group_min_max_sequoiadb_31182;
use group_min_max_sequoiadb_31182;


CREATE TABLE `normal_table` (
  `col_int_key` int(11) DEFAULT NULL,
  `col_varchar_16` varchar(16) COLLATE utf8mb4_bin DEFAULT NULL,
  `col_varchar_16_key` varchar(16) COLLATE utf8mb4_bin DEFAULT NULL,
  `col_double_key` double DEFAULT NULL,
  `pk` int(11) NOT NULL,
  `col_datetime_key` datetime DEFAULT NULL,
  `col_int` int(11) DEFAULT NULL,
  `col_datetime` datetime DEFAULT NULL,
  `col_double` double DEFAULT NULL,
  PRIMARY KEY (`pk`),
  KEY `col_int_key` (`col_int_key`),
  KEY `col_varchar_16_key` (`col_varchar_16_key`),
  KEY `col_double_key` (`col_double_key`),
  KEY `col_datetime_key` (`col_datetime_key`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;

--disable_warnings
set session SQL_MODE='NO_AUTO_VALUE_ON_ZERO';
INSERT INTO `normal_table` VALUES (NULL,'go','t',0,1,'2008-01-01 00:00:00',1,'2006-01-26 00:00:00',0),(4,NULL,NULL,NULL,2,'0000-00-00 00:00:00',-1324089344,NULL,NULL),(7,'for','y',0,3,NULL,-1116012544,'2008-08-25 00:00:00',0),(-1221525504,NULL,NULL,1453064192,4,'2002-02-06 00:11:30',6,'2002-05-03 00:00:00',1),(8,'out','t',1,5,'2005-07-26 03:36:57',1,'0000-00-00 00:00:00',0),(684851200,'a','j',0,6,'2008-03-24 00:00:00',-1474887680,'0000-00-00 00:00:00',-1196556288),(6,'ok','why',4,7,'2002-08-17 00:00:00',3,NULL,NULL),(NULL,'h','could',-1129709568,8,'2005-05-23 12:45:40',0,'0000-00-00 00:00:00',NULL),(-410517504,NULL,'c',5,9,NULL,-557973504,'0000-00-00 00:00:00',0),(NULL,'o',NULL,NULL,10,'0000-00-00 00:00:00',9,'0000-00-00 00:00:00',347275264),(NULL,'f','had',0,11,'0000-00-00 00:00:00',-120324096,'2004-01-03 00:00:00',0),(1,'r',NULL,8,12,'2003-09-15 00:00:00',1398210560,NULL,NULL),(9,'f','h',1,13,'2007-02-28 00:00:00',3,'2006-06-08 00:00:00',0),(4,'g','p',NULL,14,NULL,5,NULL,4),(NULL,'z','r',0,15,'2009-02-27 00:00:00',NULL,'2007-03-10 00:00:00',-98893824),(NULL,'at','z',0,16,'2007-09-14 00:00:00',672071680,'2000-03-26 06:16:22',0),(1019740160,'d',NULL,NULL,17,'2004-07-02 14:51:34',-1328873472,'0000-00-00 00:00:00',1478164480),(7,'now','z',NULL,18,'2002-06-08 07:56:41',-265093120,'2009-10-08 00:00:00',7),(2,'you\'re','r',NULL,19,'2006-05-16 23:27:57',NULL,'2001-10-02 00:00:00',0),(18677760,'e','i',0,20,'2005-10-28 00:00:00',1,'2003-07-28 01:52:48',2),(8,'to',NULL,2068709376,21,'0000-00-00 00:00:00',2006122496,'0000-00-00 00:00:00',0),(6,NULL,'e',0,22,'2005-01-17 20:03:46',7,'2008-04-02 00:00:00',0),(2126381056,'k','say',NULL,23,'0000-00-00 00:00:00',8,NULL,7),(1952841728,'w','u',8,24,'2004-05-02 19:41:21',78905344,NULL,NULL),(-1355743232,'z','tell',0,25,NULL,-604635136,NULL,5),(NULL,'r',NULL,NULL,26,'0000-00-00 00:00:00',5,'2000-06-28 00:00:00',0),(156631040,'what','o',9,27,'2003-10-15 00:00:00',0,'2001-03-12 03:13:03',-1461911552),(6,'because','c',NULL,28,'2002-04-15 20:43:20',-1808662528,'2004-01-23 00:00:00',-1814560768),(6,'oh','I',0,29,'2006-03-27 17:35:37',765132800,NULL,0),(9,'n','t',2,30,'2006-12-08 12:30:42',NULL,NULL,1233584128),(0,'h','f',6,31,'2003-12-04 00:00:00',NULL,'2004-12-19 00:00:00',5),(1237843968,'r','or',0,32,NULL,2,NULL,0),(NULL,'t',NULL,NULL,33,NULL,-373751808,'2009-03-05 00:00:00',0),(-144572416,NULL,'n',0,34,'2007-03-23 00:11:37',NULL,'2000-03-10 14:13:50',0),(9,'o','k',0,35,'0000-00-00 00:00:00',513736704,'2005-08-05 22:05:18',4),(3,'y','q',0,36,'2000-09-18 00:00:00',3,'2008-05-25 04:28:57',1034092544),(3,'h','q',6,37,'0000-00-00 00:00:00',4,'2002-02-15 23:26:18',0),(3,'n',NULL,0,38,'0000-00-00 00:00:00',632356864,'0000-00-00 00:00:00',147193856),(9,'time','v',2,39,NULL,2037317632,'2008-02-06 02:57:55',6),(716374016,'when','for',7,40,NULL,-1560477696,'2008-11-02 04:21:45',0),(635568128,NULL,'w',0,41,'0000-00-00 00:00:00',NULL,NULL,0),(-1398603776,'q','q',1820852224,42,NULL,9,'2009-03-14 16:19:07',3),(1850933248,'y',NULL,0,43,NULL,2,'0000-00-00 00:00:00',3),(2,'w','v',-1286799360,44,'2000-04-21 00:00:00',777650176,'0000-00-00 00:00:00',2),(NULL,NULL,'o',NULL,45,'2008-02-24 03:46:45',5,'0000-00-00 00:00:00',0),(-1579614208,'o','y',NULL,46,'2008-07-05 00:00:00',3,NULL,NULL),(6,'b',NULL,0,47,'2007-01-15 04:36:57',9,'0000-00-00 00:00:00',2),(1178402816,NULL,'he',800129024,48,'2005-01-01 00:00:00',NULL,NULL,NULL),(55246848,'of','c',4,49,'2006-05-18 00:00:00',9,'2005-08-23 02:57:42',0),(1747255296,'v','k',1,50,NULL,0,'2009-03-25 14:46:02',0),(4,'k',NULL,1,51,'0000-00-00 00:00:00',123666432,'2005-10-16 00:00:00',0),(NULL,'a','c',NULL,52,NULL,-1397882880,'0000-00-00 00:00:00',0),(NULL,'s','u',0,53,'2003-01-26 02:00:49',252575744,'0000-00-00 00:00:00',NULL),(1655832576,'m','n',9,54,'2009-06-16 00:00:00',7,'0000-00-00 00:00:00',2),(-1894121472,'of','a',963313664,55,'2008-08-10 17:22:40',8,NULL,1),(0,'e',NULL,1,56,'0000-00-00 00:00:00',1739653120,'0000-00-00 00:00:00',1697972224),(5,NULL,NULL,NULL,57,'2005-10-02 05:25:57',8,'0000-00-00 00:00:00',9),(0,'p','d',1933312000,58,'0000-00-00 00:00:00',-1407713280,'0000-00-00 00:00:00',7),(NULL,'go','really',2,59,'2006-03-22 00:00:00',NULL,'2001-01-12 09:45:42',0),(1531379712,'they','n',0,60,'2003-08-08 05:42:24',-198901760,'2006-12-25 00:00:00',0),(NULL,NULL,'p',NULL,61,'0000-00-00 00:00:00',NULL,'0000-00-00 00:00:00',9),(7,NULL,'h',9,62,'2000-05-02 20:06:03',1359216640,NULL,0),(NULL,'she','ok',1789853696,63,'2009-05-21 01:48:14',1,NULL,NULL),(-1181876224,NULL,NULL,6,64,'0000-00-00 00:00:00',NULL,'2005-10-10 06:17:42',0),(NULL,NULL,'k',-1404239872,65,'0000-00-00 00:00:00',NULL,'2000-06-21 00:00:00',0),(NULL,'f','z',NULL,66,'2000-05-06 00:00:00',NULL,NULL,0),(-1276575744,'i','no',NULL,67,'2002-07-24 01:19:39',NULL,'2007-03-04 01:47:43',-1992294400),(NULL,'be',NULL,1,68,NULL,3,'2006-08-12 00:00:00',0),(1,NULL,NULL,3,69,'2000-09-12 00:00:00',5,NULL,8),(-225312768,NULL,NULL,NULL,70,'2002-02-02 00:00:00',-1379532800,'2004-04-01 23:05:02',0),(6,'c','s',1,71,'2000-06-23 00:00:00',3,'0000-00-00 00:00:00',-1113391104),(785514496,'will','m',NULL,72,'2004-06-14 00:00:25',8,'0000-00-00 00:00:00',2),(1,'s',NULL,6,73,NULL,825950208,'2007-09-18 00:00:00',0),(660602880,'l',NULL,0,74,'2004-01-21 20:11:14',-1210384384,'2008-09-10 06:31:53',156827648),(3,'k','w',0,75,'0000-00-00 00:00:00',5,'2007-01-27 00:00:00',4),(-1748172800,'some','m',9,76,'2002-02-15 14:18:21',-442826752,'2003-09-10 00:00:00',2),(NULL,'x','q',8,77,'2004-10-24 18:48:13',-901513216,'2005-07-06 11:47:57',4),(-957284352,NULL,'b',7,78,'2009-02-21 00:00:00',966590464,'2009-06-20 00:00:00',4),(NULL,'how','m',4,79,'2004-10-23 00:00:00',NULL,'0000-00-00 00:00:00',NULL),(923795456,'z','r',NULL,80,'0000-00-00 00:00:00',NULL,'0000-00-00 00:00:00',4),(4,'w',NULL,0,81,NULL,473300992,'0000-00-00 00:00:00',7),(4,'i','r',1,82,'2004-11-18 00:00:00',NULL,'0000-00-00 00:00:00',0),(NULL,NULL,'a',499908608,83,'2000-04-27 16:52:58',4,'2002-04-26 06:40:59',NULL),(5,'can','u',7,84,NULL,NULL,'2004-08-16 00:00:00',0),(8,'m','m',-1518338048,85,'2006-10-19 22:09:09',1808072704,'2004-09-19 09:55:59',NULL),(-1820655616,'m','a',3,86,'2002-04-27 17:22:21',5,NULL,NULL),(2097414144,NULL,'l',0,87,'2005-01-22 00:00:00',951975936,'0000-00-00 00:00:00',1),(-1023213568,'y','w',NULL,88,'0000-00-00 00:00:00',NULL,'2009-02-23 12:05:38',0),(NULL,NULL,'x',3,89,'0000-00-00 00:00:00',4,'2001-10-13 00:00:00',5),(1840644096,'q','oh',NULL,90,'2005-11-15 13:52:43',4,'0000-00-00 00:00:00',9),(-1640693760,'m',NULL,NULL,91,NULL,9,'2003-08-21 16:40:19',3),(NULL,'a','b',4,92,'2000-10-18 04:09:38',-1318322176,'2005-07-08 00:00:00',5),(2,'f','e',NULL,93,'2007-03-14 00:00:00',1621229568,'2003-11-18 13:35:28',0),(3,'w','can\'t',-818413568,94,NULL,5,'2007-06-11 00:00:00',7),(7,'will',NULL,0,95,'0000-00-00 00:00:00',NULL,'2005-01-08 06:24:15',NULL),(-136314880,'z','m',4,96,'2004-01-05 00:10:54',NULL,'2009-03-18 00:00:00',6),(-1458569216,'can\'t','some',1324810240,97,NULL,3,'2008-07-22 13:45:34',1784938496),(2,NULL,'k',NULL,98,'2004-05-21 00:35:43',-177799168,'0000-00-00 00:00:00',NULL),(5,NULL,'t',NULL,99,NULL,2140733440,'2006-11-07 17:21:52',0),(2100101120,'h','r',NULL,100,'2003-09-22 15:42:34',4,'2007-04-13 06:47:10',3),(-870711296,'going','or',2131951616,101,'2006-04-26 02:58:54',NULL,'2000-12-07 00:00:00',8),(0,'h','from',7,102,NULL,1,'2001-07-10 00:00:00',0),(-739115008,NULL,'i',0,103,'0000-00-00 00:00:00',NULL,NULL,0),(6,'e','w',9,104,NULL,934936576,'0000-00-00 00:00:00',8),(-634585088,NULL,'y',4,105,NULL,1701380096,NULL,0),(136904704,'s','a',-869138432,106,'2008-12-20 17:21:54',-1053687808,NULL,8),(1389690880,NULL,'just',NULL,107,NULL,-1906704384,'2002-03-10 00:00:00',0),(-733020160,'d','one',6,108,NULL,3,'0000-00-00 00:00:00',NULL),(0,'v','j',NULL,109,'2004-08-18 00:00:00',NULL,'2001-06-11 03:59:14',0),(NULL,'b','i',8,110,NULL,9,'2009-09-26 00:00:00',NULL),(1,'m',NULL,868155392,111,'2002-06-25 00:00:00',5,NULL,0),(NULL,'x',NULL,-885063680,112,'2001-09-14 00:00:00',1,'2007-11-15 00:00:00',NULL),(NULL,'know','him',NULL,113,'0000-00-00 00:00:00',4,'2005-06-24 01:35:46',2),(269352960,'x',NULL,6,114,'2006-12-13 00:00:00',0,'2007-09-17 00:00:00',0),(NULL,'o','u',NULL,115,'2000-07-25 10:39:14',2,'2009-08-16 00:00:00',0),(9,'x','e',2,116,'2000-07-22 00:00:00',-526778368,'0000-00-00 00:00:00',7),(4,NULL,NULL,NULL,117,'0000-00-00 00:00:00',-1309802496,'0000-00-00 00:00:00',1),(NULL,'n','p',0,118,NULL,-443875328,NULL,8),(510656512,NULL,'got',1,119,NULL,-1417871360,'0000-00-00 00:00:00',2),(2,'tell','j',9,120,'2009-02-11 01:56:24',9,'2009-02-24 15:03:27',1356398592),(7,NULL,'i',8,121,'2009-10-06 20:32:59',-1967915008,'0000-00-00 00:00:00',410779648),(7,'a','h',NULL,122,'2002-06-13 00:00:00',1,'0000-00-00 00:00:00',0),(NULL,'got',NULL,7,123,'2000-04-18 23:30:22',0,'2007-03-27 00:00:00',0),(0,'been',NULL,0,124,NULL,1456209920,'2007-10-08 18:29:45',-562364416),(-1048182784,'k','did',-645726208,125,'0000-00-00 00:00:00',NULL,NULL,NULL),(9,'it','d',0,126,'0000-00-00 00:00:00',729481216,'2005-12-15 00:00:00',2),(985792512,'i',NULL,8,127,'0000-00-00 00:00:00',5,NULL,5),(-913047552,'q','h',NULL,128,NULL,-1539964928,'0000-00-00 00:00:00',1972305920),(NULL,'o',NULL,1308950528,129,'2001-03-24 19:46:20',638386176,'2001-02-11 03:31:18',-1896677376),(8,'y','i',2124283904,130,'2006-05-15 00:00:00',NULL,NULL,-907083776),(1680211968,'c',NULL,0,131,'2006-11-21 00:00:00',3,'2009-01-13 00:00:00',NULL),(1017708544,'i','a',0,132,'0000-00-00 00:00:00',6,'2002-08-05 00:00:00',0),(3,'y',NULL,NULL,133,NULL,7,'2001-10-11 14:30:06',NULL),(3,'m','yeah',9,134,'2007-10-10 00:00:00',1829634048,'2007-11-17 00:00:00',1),(-391970816,'v',NULL,NULL,135,'2008-01-16 13:20:01',-304218112,'0000-00-00 00:00:00',0),(9,'h','do',5,136,'2005-06-15 00:00:00',741212160,'0000-00-00 00:00:00',1695875072),(5,'I\'ll',NULL,1,137,NULL,6,'2008-03-04 23:24:07',-545521664),(-105840640,'r','y',1,138,'0000-00-00 00:00:00',1084489728,'2005-12-09 00:00:00',-657850368),(NULL,'didn\'t','j',0,139,'2004-04-24 07:32:53',NULL,'2003-05-28 17:20:05',-1278738432),(1,'u',NULL,1290272768,140,NULL,1278869504,'2004-05-27 22:45:54',0),(1882652672,'e','j',0,141,'2007-04-06 17:28:58',6,'0000-00-00 00:00:00',0),(7,NULL,NULL,NULL,142,'2002-11-25 07:27:30',5,'0000-00-00 00:00:00',0),(NULL,NULL,'f',2,143,NULL,NULL,'0000-00-00 00:00:00',NULL),(3,'m','m',-591134720,144,'0000-00-00 00:00:00',2043346944,'2007-01-02 00:00:00',5),(8,'don\'t','n',-1318453248,145,'2001-08-23 10:36:46',1612251136,'2003-06-01 00:00:00',0),(5,'b','v',0,146,'2003-10-07 00:00:00',4,'2002-11-12 00:00:00',NULL),(256901120,'s',NULL,8,147,'2005-07-02 00:00:00',4,'2004-02-11 00:00:00',3),(1011482624,'a','p',NULL,148,'2003-03-14 00:00:00',NULL,'2006-12-27 05:52:57',8),(1008992256,NULL,NULL,6,149,'0000-00-00 00:00:00',5,'2001-09-22 07:42:56',2),(-1216872448,'m','were',0,150,NULL,682885120,NULL,4),(1966145536,'a',NULL,-308805632,151,'2007-09-05 19:33:20',1,NULL,0),(7,'f','u',1,152,NULL,7,NULL,0),(6,'in','right',3,153,'2007-04-16 00:00:00',0,NULL,NULL),(0,NULL,'okay',182190080,154,NULL,NULL,'0000-00-00 00:00:00',NULL),(8,NULL,'a',-1779892224,155,'2002-06-09 00:22:47',NULL,NULL,NULL),(NULL,'d','yes',NULL,156,'2009-02-25 23:13:51',NULL,'2008-05-18 00:00:00',NULL),(NULL,'d','s',1035272192,157,'0000-00-00 00:00:00',-1385365504,'2000-09-12 13:06:39',NULL),(5,NULL,NULL,2,158,'0000-00-00 00:00:00',8,NULL,0),(8,'z','oh',6,159,NULL,NULL,'2006-08-10 20:21:39',1),(3,'d','u',8,160,NULL,NULL,'2009-12-26 15:35:44',1),(-70516736,'want','l',7,161,'2002-08-15 19:17:33',-11337728,'0000-00-00 00:00:00',1523843072),(7,'I\'m','f',7,162,'2007-05-02 00:00:00',NULL,'2006-12-05 23:48:18',0),(0,NULL,'about',NULL,163,'2000-03-06 00:00:00',-625803264,'2004-01-08 00:00:00',7),(7,'with',NULL,NULL,164,NULL,NULL,'2003-09-04 21:42:38',0),(9,'e',NULL,6,165,'2007-08-14 00:00:00',-2014642176,'0000-00-00 00:00:00',NULL),(-1360723968,'n',NULL,NULL,166,NULL,5,'2006-11-12 23:12:53',0),(775225344,'v','y',8,167,'0000-00-00 00:00:00',-998768640,NULL,4),(589430784,'x','have',5,168,'0000-00-00 00:00:00',926023680,'2002-03-16 00:00:00',0),(NULL,'x','g',8,169,'2001-09-09 00:00:00',9,'2000-04-27 02:43:44',1),(1803878400,'y','w',NULL,170,NULL,1079115776,'2007-09-13 01:26:13',NULL),(NULL,NULL,'why',2,171,'2003-12-25 17:01:57',NULL,'2002-07-18 23:41:48',-1024917504),(4,'q','h',0,172,NULL,1,'2002-02-02 13:49:05',-1866596352),(-1170145280,'r','v',9,173,'2008-09-09 11:11:45',NULL,NULL,322764800),(3,'k','d',8,174,'0000-00-00 00:00:00',5,'2008-02-10 00:00:00',NULL),(7,NULL,'o',8,175,'0000-00-00 00:00:00',0,NULL,6),(2,'d','o',NULL,176,'0000-00-00 00:00:00',7,'0000-00-00 00:00:00',9),(8,'it\'s',NULL,-1977942016,177,NULL,NULL,'0000-00-00 00:00:00',2048131072),(NULL,'t','of',0,178,'2004-10-28 15:29:39',579796992,'0000-00-00 00:00:00',NULL),(NULL,NULL,'f',9,179,NULL,NULL,NULL,2066350080),(-1412759552,'x','not',2,180,'2008-10-16 00:00:00',0,'2002-06-19 12:56:08',NULL),(NULL,'w','all',1,181,'0000-00-00 00:00:00',1926234112,'2007-08-04 21:13:37',NULL),(2,'s','o',0,182,'2000-05-27 16:21:25',1445396480,'2002-12-22 00:21:35',NULL),(8,'u','y',-1545863168,183,'0000-00-00 00:00:00',2,'2003-11-22 00:00:00',6),(NULL,'of','be',0,184,NULL,NULL,'2000-03-25 15:24:10',4),(-203816960,'v','e',0,185,NULL,2,'0000-00-00 00:00:00',2),(4,'m',NULL,0,186,'2001-05-10 04:16:56',8,'0000-00-00 00:00:00',5),(NULL,'f',NULL,4,187,NULL,NULL,NULL,1518862336),(9,'v',NULL,0,188,'2000-07-15 00:00:00',6,'0000-00-00 00:00:00',0),(NULL,'I\'ll','l',0,189,'2009-11-26 11:48:11',4,'0000-00-00 00:00:00',0),(-762576896,'s','o',NULL,190,NULL,3,'0000-00-00 00:00:00',4),(-603193344,'I\'m','really',0,191,NULL,4,'2005-09-04 09:11:07',NULL),(6,'v','you\'re',NULL,192,'0000-00-00 00:00:00',-91684864,'2006-03-25 14:54:28',NULL),(805634048,'a','z',9,193,'2001-07-19 00:00:00',4,NULL,5),(NULL,'g','z',6,194,'2008-09-04 00:00:00',3,'0000-00-00 00:00:00',4),(-1146486784,'m',NULL,8,195,'0000-00-00 00:00:00',NULL,'0000-00-00 00:00:00',591200256),(5,'at',NULL,0,196,'0000-00-00 00:00:00',2,'0000-00-00 00:00:00',3),(7,NULL,'q',7,197,'0000-00-00 00:00:00',-1261043712,NULL,6),(NULL,'q','a',6,198,NULL,3,NULL,3),(0,'when',NULL,6,199,'0000-00-00 00:00:00',1362100224,'0000-00-00 00:00:00',1),(2091122688,'a','about',NULL,200,'0000-00-00 00:00:00',2,'2003-05-25 00:00:00',5);

analyze table normal_table;
let $i = 2;
while($i){
  if( $i == 1 ) { alter table normal_table engine sequoiadb; }
  set session reject_nested_func_for_group_min_max = on;
  explain SELECT MIN( pk ) AS field1, `col_datetime_key` AS field2 FROM normal_table WHERE not pk <=> 2 GROUP BY field2 HAVING field1 = 10;
  --sorted_result
  SELECT MIN( pk ) AS field1, `col_datetime_key` AS field2 FROM normal_table WHERE not pk <=> 2 GROUP BY field2 HAVING field1 = 10;
  set session reject_nested_func_for_group_min_max = off;
  explain SELECT MIN( pk ) AS field1, `col_datetime_key` AS field2 FROM normal_table WHERE not pk <=> 2 GROUP BY field2 HAVING field1 = 10;
  --sorted_result
  SELECT MIN( pk ) AS field1, `col_datetime_key` AS field2 FROM normal_table WHERE not pk <=> 2 GROUP BY field2 HAVING field1 = 10;
  dec $i;
}
--enable_warnings

drop database group_min_max_sequoiadb_31182;
--source include/uninstall_sequoiadb.inc 
